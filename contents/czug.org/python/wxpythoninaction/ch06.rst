---
created: 
creator: Benky
description: ''
title: 第六章 使用wxPython基本构件
---
<div lang="en" id="content" dir="ltr"><span id="top" class="anchor"/>
<span id="line-1" class="anchor"/><p class="line867"/><div class="table-of-contents"><p class="table-of-contents-heading">目录</p><ol><li><a href="#head-307610e87b04b271fcb74cd59d83c4a495c1f657">使用基本的建造部件</a><ol><li><a href="#head-9074aa06c2f3751a53b9fa223d8736742e36bd0e">在屏幕上绘画</a><ol><li><a href="#head-97db4e13539ffa3b9455496f2574fff512d3a483">如何在屏幕上绘画</a></li></ol></li><li><a href="#head-e9041aecf0546b14acad3a649b41e08b3a422553">添加窗口装饰</a><ol><li><a href="#head-925ab8656124ddf5757a8e70821b6d0947495243">如何添加和更新一个状态栏</a></li><li><a href="#head-4cb95b0f0378583e52292ed6ffc854beb6a83b70">如何添加菜单？</a></li><li><a href="#head-e60093b2627e5c41a74d9b42440a3a8c727e4d7b">如何添加一个工具栏</a></li></ol></li><li><a
href="#head-2fd6e8713057e909471ca9a3ab7abde364b35647">得到标准信息</a><ol><li><a href="#head-f3ef70168fc08d5c7cb60a727ee6ba59d5447a33">如何使用标准文件对话框？</a></li><li><a href="#head-ff4ca0e787be7581f9bda3547d63e62f30a525fd">如何使用标准的颜色选择器？</a></li></ol></li><li><a href="#head-b61bae071dfa0a00f0b89a92ba2c31220f128e0a">给应用程序一个好看的外观</a><ol><li><a href="#head-270ac61b4f28930e55c2bc47e5461d8fc043f7bf">如何布局窗口部件？</a></li><li><a href="#head-39a0e8508136cd64b5d4b3229bfcb4084dba4916">如何建造一个关于(about)框？</a></li><li><a href="#head-21ede5b328cae69a3c5586248fb660c43ed400ac">如何建造一个启动画面？</a></li></ol></li><li><a href="#head-7128fdbb7115084ca4c31c13a4b6b2d31f26f09e">本章小结</a></li></ol></li></ol></div> <span id="line-2"
class="anchor"/><span id="line-3" class="anchor"/><p class="line867">
</p><h1 id="head-307610e87b04b271fcb74cd59d83c4a495c1f657">1. 使用基本的建造部件</h1>
<span id="line-4" class="anchor"/><span id="line-5" class="anchor"/><p class="line862">即使是一个简单的<tt>wxPython</tt>程序也需要使用标准的元素，诸如菜单和对话框。这儿有对于任一<tt>GUI</tt>应用程序的基本的建造部件。使用这些建造部件，还有像启动画面、状态栏或关于框等这些窗口部件，它们给你提供了一个更友好的用户环境，并且给了你的应用程序一个专业的感观。为了要结束本书的第一部分，我们将指导你通过一个程序的创建来使用所有所学的部分。我们将建造一个简单的绘画程序，然后添加这些建造部件元素并说明使用它们时的一些问题。我们将巩固前面章节的基本原理和概念，并且最后我们将产生这个简单但专业的应用程序。本章位于先前基本概念章节和后面对<tt>wxPython</tt>功能更详细讨论的2、3部分之间。 <span id="line-6" class="anchor"/><span id="line-7" class="anchor"/></p><p
class="line862">我们在本章将建造的这个应用程序基本上基于<tt>wxPython</tt>/<tt>samples</tt>目录中的涂鸦例子。这个应用程序是一个非常简单的绘画程序，当鼠标左键按下时它跟踪鼠标指针，并画线。图6.1显示了一个简单的初始绘画窗口。 <span id="line-8" class="anchor"/><span id="line-9" class="anchor"/></p><p class="line874">图6.1 <span id="line-10" class="anchor"/><span id="line-11" class="anchor"/></p><p class="line867"><img title="attachment:w6.1.gif" src="/moin/WxPythonInAction/ChapterSix?action=AttachFile&amp;do=get&amp;target=w6.1.gif" class="attachment"/> <span id="line-12" class="anchor"/><span id="line-13" class="anchor"/><span id="line-14" class="anchor"/></p><p
class="line862">我们之所以要选择这样一个绘画例子，是因为它是十分简单的程序，它演示了在创建更复杂的应用程序时所引出的许多问题。在本章，我们将给你展示如何在屏幕上画线、添加状态栏、工具样以及菜单栏。你将会看到如何使用通用对话框，如文件选择器和颜色选择器。我们将使用<tt>sizer</tt>来布置窗口部件，并且我们也将增加一个关于框和一个启动画面。本章的最后，你将有一个很好看的绘画程序。 <span id="line-15" class="anchor"/><span id="line-16" class="anchor"/><span id="line-17" class="anchor"/></p><p class="line867">
</p><h2 id="head-9074aa06c2f3751a53b9fa223d8736742e36bd0e">1.1. 在屏幕上绘画</h2>
<span id="line-18" class="anchor"/><span id="line-19" class="anchor"/><span id="line-20" class="anchor"/><p class="line862">你的绘画程序的首先的工作是勾画线条并显示出来。像其它的<tt>GUI</tt>工具一样， <tt>wxPython</tt>提供了一套独立于设备的工具用于绘画。下面，我们将讨论如何在屏幕上绘画。 <span id="line-21" class="anchor"/><span id="line-22" class="anchor"/><span id="line-23" class="anchor"/></p><p class="line867">
</p><h3 id="head-97db4e13539ffa3b9455496f2574fff512d3a483">1.1.1. 如何在屏幕上绘画</h3>
<span id="line-24" class="anchor"/><span id="line-25" class="anchor"/><span id="line-26" class="anchor"/><p class="line862">要在屏幕上绘画，我们要用到一个名为<tt>device</tt> <tt>context</tt>（设备上下文）的<tt>wxPython</tt>对象。设备上下文代表抽象的设备，它对于所有的设备有一套公用的绘画方法，所以对于不同的设备，你的代码是相同的，而不用考虑你所在的具体设备。设备上下文使用抽象的<tt>wxPython</tt>的类<tt>wx.DC</tt>和其子类来代表。由于<tt>wx.DC</tt>是抽象的，所以对于你的应用程序，你需要使用它的子类。 <span id="line-27" class="anchor"/><span id="line-28" class="anchor"/><span id="line-29" class="anchor"/></p><p class="line867"><strong>使用设备上下文</strong> <span id="line-30" class="anchor"/><span id="line-31" class="anchor"/></p><p
class="line862">表6.1显示了<tt>wx.DC</tt>的子类及其用法。设备上下文用来在<tt>wxPython</tt>窗口部件上绘画，它应该是局部的，临时性的，不应该以实例变量、全局变量或其它形式在方法调用之间保留。在某些平台上，设备上下文是有限的资源，长期持有<tt>wx.DC</tt>可能导致你的程序不稳定。由于<tt>wxPython</tt>内部使用设备上下文的方式，对于在窗口部件中绘画，就存在几个有着细微差别的<tt>wx.DC</tt>的子类。第十二章将更详细地说明这些差别。 <span id="line-32" class="anchor"/><span id="line-33" class="anchor"/><span id="line-34" class="anchor"/></p><p class="line867"><strong>表6.1</strong> <span id="line-35" class="anchor"/><span id="line-36" class="anchor"/></p><p class="line867"><tt>wx.BufferedDC</tt>：用于缓存一套绘画命令，直到命令完整并准备在屏幕上绘画。这防止了显示中不必要的闪烁。 <span
id="line-37" class="anchor"/><span id="line-38" class="anchor"/></p><p class="line867"><tt>wx.BufferedPaintDC</tt>：和<tt>wx.BufferedDC</tt>一样，但是只能用在一个<tt>wx.PaintEvent</tt>的处理中。仅临时创建该类的实例。 <span id="line-39" class="anchor"/><span id="line-40" class="anchor"/></p><p class="line867"><tt>wx.ClientDC</tt>：用于在一个窗口对象上绘画。当你想在窗口部件的主区域上（不包括边框或别的装饰）绘画时使用它。主区域有时也称为客户区。<tt>wx.ClientDC</tt>类也应临时创建。该类仅适用于<tt>wx.PaintEvent</tt>的处理之外。 <span id="line-41" class="anchor"/><span id="line-42" class="anchor"/></p><p class="line867"><tt>wx.MemoryDC</tt>：用于绘制图形到内存中的一个位图中，此时不被显示。然后你可以选择该位图，并使用<tt>wx.DC.Blit()</tt>方法来把这个位图绘画到一个窗口中。 <span
id="line-43" class="anchor"/><span id="line-44" class="anchor"/></p><p class="line867"><tt>wx.MetafileDC</tt>：在<tt>Windows</tt>操作系统上，<tt>wx.MetafileDC</tt>使你能够去创建标准窗口图元文件数据。 <span id="line-45" class="anchor"/><span id="line-46" class="anchor"/></p><p class="line867"><tt>wx.PaintDC</tt>：等同于<tt>wx.ClientDC</tt>，除了它仅用于一个<tt>wx.PaintEvent</tt>的处理中。仅临时创建该类的实例。 <span id="line-47" class="anchor"/><span id="line-48" class="anchor"/></p><p class="line867"><tt>wx.PostScriptDC</tt>：用于写压缩的<tt>PostScript</tt>文件。 <span id="line-49" class="anchor"/><span id="line-50" class="anchor"/></p><p class="line867"><tt>wx.PrinterDC</tt>：用于<tt>Windows</tt>操作系统上，写到打印机。 <span id="line-51" class="anchor"/><span id="line-52"
class="anchor"/></p><p class="line867"><tt>wx.ScreenDC</tt>：用于直接在屏幕上绘画，在任何被显示的窗口的顶部或外部。该类只应该被临时创建。 <span id="line-53" class="anchor"/><span id="line-54" class="anchor"/></p><p class="line867"><tt>wx.WindowDC</tt>：用于在一个窗口对象的整个区域上绘画，包括边框以及那些没有被包括在客户区域中的装饰。非<tt>Windows</tt>系统可能不支持该类。 <span id="line-55" class="anchor"/><span id="line-56" class="anchor"/></p><p class="line874">下例6.1包含了显示图6.1的代码。因为该代码展示了基于设备上下文绘画的技巧，所以我们将对其详细注释。 <span id="line-57" class="anchor"/><span id="line-58" class="anchor"/></p><p class="line862">例6.1 初始的<tt>SketchWindow</tt>代码 <span id="line-59" class="anchor"/><span id="line-60" class="anchor"/><span id="line-61"
class="anchor"/><span id="line-62" class="anchor"/><span id="line-63" class="anchor"/><span id="line-64" class="anchor"/><span id="line-65" class="anchor"/><span id="line-66" class="anchor"/><span id="line-67" class="anchor"/><span id="line-68" class="anchor"/><span id="line-69" class="anchor"/><span id="line-70" class="anchor"/><span id="line-71" class="anchor"/><span id="line-72" class="anchor"/><span id="line-73" class="anchor"/><span id="line-74" class="anchor"/><span id="line-75" class="anchor"/><span id="line-76" class="anchor"/><span id="line-77" class="anchor"/><span id="line-78" class="anchor"/><span id="line-79" class="anchor"/><span id="line-80" class="anchor"/><span id="line-81" class="anchor"/><span id="line-82" class="anchor"/><span id="line-83"
class="anchor"/><span id="line-84" class="anchor"/><span id="line-85" class="anchor"/><span id="line-86" class="anchor"/><span id="line-87" class="anchor"/><span id="line-88" class="anchor"/><span id="line-89" class="anchor"/><span id="line-90" class="anchor"/><span id="line-91" class="anchor"/><span id="line-92" class="anchor"/><span id="line-93" class="anchor"/><span id="line-94" class="anchor"/><span id="line-95" class="anchor"/><span id="line-96" class="anchor"/><span id="line-97" class="anchor"/><span id="line-98" class="anchor"/><span id="line-99" class="anchor"/><span id="line-100" class="anchor"/><span id="line-101" class="anchor"/><span id="line-102" class="anchor"/><span id="line-103" class="anchor"/><span id="line-104" class="anchor"/><span id="line-105"
class="anchor"/><span id="line-106" class="anchor"/><span id="line-107" class="anchor"/><span id="line-108" class="anchor"/><span id="line-109" class="anchor"/><span id="line-110" class="anchor"/><span id="line-111" class="anchor"/><span id="line-112" class="anchor"/><span id="line-113" class="anchor"/><span id="line-114" class="anchor"/><span id="line-115" class="anchor"/><span id="line-116" class="anchor"/><span id="line-117" class="anchor"/><span id="line-118" class="anchor"/><span id="line-119" class="anchor"/><span id="line-120" class="anchor"/><span id="line-121" class="anchor"/><span id="line-122" class="anchor"/><span id="line-123" class="anchor"/><span id="line-124" class="anchor"/><span id="line-125" class="anchor"/><span id="line-126" class="anchor"/><span
id="line-127" class="anchor"/><span id="line-128" class="anchor"/><span id="line-129" class="anchor"/><span id="line-130" class="anchor"/><span id="line-131" class="anchor"/><span id="line-132" class="anchor"/><span id="line-133" class="anchor"/><span id="line-134" class="anchor"/><span id="line-135" class="anchor"/><span id="line-136" class="anchor"/><span id="line-137" class="anchor"/><span id="line-138" class="anchor"/><span id="line-139" class="anchor"/><span id="line-140" class="anchor"/><span id="line-141" class="anchor"/><span id="line-142" class="anchor"/><span id="line-143" class="anchor"/><span id="line-144" class="anchor"/><span id="line-145" class="anchor"/><span id="line-146" class="anchor"/><span id="line-147" class="anchor"/><span id="line-148"
class="anchor"/><span id="line-149" class="anchor"/><span id="line-150" class="anchor"/><span id="line-151" class="anchor"/><span id="line-152" class="anchor"/><span id="line-153" class="anchor"/><span id="line-154" class="anchor"/><span id="line-155" class="anchor"/><span id="line-156" class="anchor"/><span id="line-157" class="anchor"/><span id="line-158" class="anchor"/><span id="line-159" class="anchor"/><span id="line-160" class="anchor"/><span id="line-161" class="anchor"/><span id="line-162" class="anchor"/><span id="line-163" class="anchor"/><span id="line-164" class="anchor"/><span id="line-165" class="anchor"/><span id="line-166" class="anchor"/><span id="line-167" class="anchor"/><span id="line-168" class="anchor"/><span id="line-169" class="anchor"/><span
id="line-170" class="anchor"/><span id="line-171" class="anchor"/><span id="line-172" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
function isnumbered(obj) {
return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
var nlen = Math.max(0,chrs-(''+num).length), res = '';
while (nlen>0) { res += ' '; nlen-- }
return res+num+add;
}
function addnumber(did, nstart, nstep) {
var c = document.getElementById(did), l = c.firstChild, n = 1;
if (!isnumbered(c))
if (typeof nstart == 'undefined') nstart = 1;
if (typeof nstep  == 'undefined') nstep = 1;
n = nstart;
while (l != null) {
if (l.tagName == 'SPAN') {
var s = document.createElement('SPAN');
s.className = 'LineNumber'
s.appendChild(document.createTextNode(nformat(n,4,' ')));
n += nstep;
if (l.childNodes.length)
l.insertBefore(s, l.firstChild)
else
l.appendChild(s)
}
l = l.nextSibling;
}
return false;
}
function remnumber(did) {
var c = document.getElementById(did), l = c.firstChild;
if (isnumbered(c))
while (l != null) {
if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
l = l.nextSibling;
}
return false;
}
function togglenumber(did, nstart, nstep) {
var c = document.getElementById(did);
if (isnumbered(c)) {
remnumber(did);
} else {
addnumber(did,nstart,nstep);
}
return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-68d64ea4b2ad25b53dd07c5706b2bd967ef0df89_000\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-68d64ea4b2ad25b53dd07c5706b2bd967ef0df89_000', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-68d64ea4b2ad25b53dd07c5706b2bd967ef0df89_000" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">import</span> <span class="ID">wx</span></span>
<span class="line"><span class="LineNumber">   2 </span></span>
<span class="line"><span class="LineNumber">   3 </span></span>
<span class="line"><span class="LineNumber">   4 </span><span class="ResWord">class</span> <span class="ID">SketchWindow</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">Window</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   5 </span>    <span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="ID">ID</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   6 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Window</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="ID">ID</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   7 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">SetBackgroundColour</span><span class="Operator">(</span><span class="String">"White"</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">color</span> <span class="Operator">=</span> <span class="String">"Black"</span></span>
<span class="line"><span class="LineNumber">   9 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">thickness</span> <span class="Operator">=</span> <span class="Number">1</span></span>
<span class="line"><span class="LineNumber">  10 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">pen</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Pen</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">color</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">thickness</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span
class="ID">SOLID</span><span class="Operator">)</span><span class="Comment">#1 创建一个wx.Pen对象</span></span>
<span class="line"><span class="LineNumber">  11 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">lines</span> <span class="Operator">=</span> <span class="Operator">[</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  12 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curLine</span> <span class="Operator">=</span> <span class="Operator">[</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  13 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">pos</span> <span class="Operator">=</span> <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  14 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">InitBuffer</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  15 </span></span>
<span class="line"><span class="LineNumber">  16 </span><span class="Comment">#2 连接事件</span></span>
<span class="line"><span class="LineNumber">  17 </span><span class="Comment"/>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_LEFT_DOWN</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnLeftDown</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  18 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_LEFT_UP</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnLeftUp</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  19 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_MOTION</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnMotion</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  20 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_SIZE</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSize</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  21 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_IDLE</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnIdle</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  22 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_PAINT</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnPaint</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  23 </span></span>
<span class="line"><span class="LineNumber">  24 </span>    <span class="ResWord">def</span> <span class="ID">InitBuffer</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  25 </span>        <span class="ID">size</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">GetClientSize</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  26 </span></span>
<span class="line"><span class="LineNumber">  27 </span><span class="Comment">#3 创建一个缓存的设备上下文</span></span>
<span class="line"><span class="LineNumber">  28 </span><span class="Comment"/>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">buffer</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">EmptyBitmap</span><span class="Operator">(</span><span class="ID">size</span><span class="Operator">.</span><span class="ID">width</span><span class="Operator">,</span> <span class="ID">size</span><span class="Operator">.</span><span class="ID">height</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  29 </span>        <span class="ID">dc</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">BufferedDC</span><span class="Operator">(</span><span class="ID">None</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">buffer</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  30 </span></span>
<span class="line"><span class="LineNumber">  31 </span><span class="Comment">#4 使用设备上下文</span></span>
<span class="line"><span class="LineNumber">  32 </span><span class="Comment"/>        <span class="ID">dc</span><span class="Operator">.</span><span class="ID">SetBackground</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">Brush</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">GetBackgroundColour</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  33 </span>        <span class="ID">dc</span><span class="Operator">.</span><span class="ID">Clear</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  34 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">DrawLines</span><span class="Operator">(</span><span class="ID">dc</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  35 </span></span>
<span class="line"><span class="LineNumber">  36 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">reInitBuffer</span> <span class="Operator">=</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber">  37 </span></span>
<span class="line"><span class="LineNumber">  38 </span>    <span class="ResWord">def</span> <span class="ID">GetLinesData</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  39 </span>        <span class="ResWord">return</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">lines</span><span class="Operator">[</span><span class="Operator">:</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  40 </span></span>
<span class="line"><span class="LineNumber">  41 </span>    <span class="ResWord">def</span> <span class="ID">SetLinesData</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">lines</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  42 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">lines</span> <span class="Operator">=</span> <span class="ID">lines</span><span class="Operator">[</span><span class="Operator">:</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  43 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">InitBuffer</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  44 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Refresh</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  45 </span></span>
<span class="line"><span class="LineNumber">  46 </span>    <span class="ResWord">def</span> <span class="ID">OnLeftDown</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  47 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curLine</span> <span class="Operator">=</span> <span class="Operator">[</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  48 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">pos</span> <span class="Operator">=</span> <span class="ID">event</span><span class="Operator">.</span><span class="ID">GetPositionTuple</span><span class="Operator">(</span><span class="Operator">)</span><span class="Comment">#5 得到鼠标的位置</span></span>
<span class="line"><span class="LineNumber">  49 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">CaptureMouse</span><span class="Operator">(</span><span class="Operator">)</span><span class="Comment">#6 捕获鼠标</span></span>
<span class="line"><span class="LineNumber">  50 </span></span>
<span class="line"><span class="LineNumber">  51 </span>    <span class="ResWord">def</span> <span class="ID">OnLeftUp</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  52 </span>        <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">HasCapture</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  53 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">lines</span><span class="Operator">.</span><span class="ID">append</span><span class="Operator">(</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">color</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  54 </span>                               <span class="ID">self</span><span class="Operator">.</span><span class="ID">thickness</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  55 </span>                               <span class="ID">self</span><span class="Operator">.</span><span class="ID">curLine</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  56 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">curLine</span> <span class="Operator">=</span> <span class="Operator">[</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  57 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">ReleaseMouse</span><span class="Operator">(</span><span class="Operator">)</span><span class="Comment">#7 释放鼠标</span></span>
<span class="line"><span class="LineNumber">  58 </span></span>
<span class="line"><span class="LineNumber">  59 </span>    <span class="ResWord">def</span> <span class="ID">OnMotion</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  60 </span>        <span class="ResWord">if</span> <span class="ID">event</span><span class="Operator">.</span><span class="ID">Dragging</span><span class="Operator">(</span><span class="Operator">)</span> <span class="ResWord">and</span> <span class="ID">event</span><span class="Operator">.</span><span class="ID">LeftIsDown</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#8 确定是否在拖动</span></span>
<span class="line"><span class="LineNumber">  61 </span>            <span class="ID">dc</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">BufferedDC</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">ClientDC</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">buffer</span><span class="Operator">)</span><span class="Comment">#9
创建另一个缓存的上下文</span></span>
<span class="line"><span class="LineNumber">  62 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">drawMotion</span><span class="Operator">(</span><span class="ID">dc</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  63 </span>        <span class="ID">event</span><span class="Operator">.</span><span class="ID">Skip</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  64 </span>    <span class="Comment">#10 绘画到设备上下文</span></span>
<span class="line"><span class="LineNumber">  65 </span><span class="Comment"/>    <span class="ResWord">def</span> <span class="ID">drawMotion</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">dc</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  66 </span>        <span class="ID">dc</span><span class="Operator">.</span><span class="ID">SetPen</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">pen</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  67 </span>        <span class="ID">newPos</span> <span class="Operator">=</span> <span class="ID">event</span><span class="Operator">.</span><span class="ID">GetPositionTuple</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  68 </span>        <span class="ID">coords</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">pos</span> <span class="Operator">+</span> <span class="ID">newPos</span></span>
<span class="line"><span class="LineNumber">  69 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curLine</span><span class="Operator">.</span><span class="ID">append</span><span class="Operator">(</span><span class="ID">coords</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  70 </span>        <span class="ID">dc</span><span class="Operator">.</span><span class="ID">DrawLine</span><span class="Operator">(</span><span class="Operator">*</span><span class="ID">coords</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  71 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">pos</span> <span class="Operator">=</span> <span class="ID">newPos</span></span>
<span class="line"><span class="LineNumber">  72 </span></span>
<span class="line"><span class="LineNumber">  73 </span>    <span class="ResWord">def</span> <span class="ID">OnSize</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  74 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">reInitBuffer</span> <span class="Operator">=</span> <span class="ID">True</span> <span class="Comment">#11 处理一个resize事件</span></span>
<span class="line"><span class="LineNumber">  75 </span></span>
<span class="line"><span class="LineNumber">  76 </span>    <span class="ResWord">def</span> <span class="ID">OnIdle</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#12 空闲时的处理</span></span>
<span class="line"><span class="LineNumber">  77 </span>        <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">reInitBuffer</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  78 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">InitBuffer</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  79 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">Refresh</span><span class="Operator">(</span><span class="ID">False</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  80 </span></span>
<span class="line"><span class="LineNumber">  81 </span>    <span class="ResWord">def</span> <span class="ID">OnPaint</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  82 </span>        <span class="ID">dc</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">BufferedPaintDC</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">buffer</span><span class="Operator">)</span><span class="Comment">#13 处理一个paint（描绘）请求</span></span>
<span class="line"><span class="LineNumber">  83 </span></span>
<span class="line"><span class="LineNumber">  84 </span>    <span class="Comment">#14 绘制所有的线条</span></span>
<span class="line"><span class="LineNumber">  85 </span><span class="Comment"/>    <span class="ResWord">def</span> <span class="ID">DrawLines</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">dc</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  86 </span>        <span class="ResWord">for</span> <span class="ID">colour</span><span class="Operator">,</span> <span class="ID">thickness</span><span class="Operator">,</span> <span class="ID">line</span> <span class="ResWord">in</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">lines</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  87 </span>            <span class="ID">pen</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Pen</span><span class="Operator">(</span><span class="ID">colour</span><span class="Operator">,</span> <span class="ID">thickness</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">SOLID</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  88 </span>            <span class="ID">dc</span><span class="Operator">.</span><span class="ID">SetPen</span><span class="Operator">(</span><span class="ID">pen</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  89 </span>            <span class="ResWord">for</span> <span class="ID">coords</span> <span class="ResWord">in</span> <span class="ID">line</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  90 </span>                <span class="ID">dc</span><span class="Operator">.</span><span class="ID">DrawLine</span><span class="Operator">(</span><span class="Operator">*</span><span class="ID">coords</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  91 </span></span>
<span class="line"><span class="LineNumber">  92 </span>    <span class="ResWord">def</span> <span class="ID">SetColor</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">color</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  93 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">color</span> <span class="Operator">=</span> <span class="ID">color</span></span>
<span class="line"><span class="LineNumber">  94 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">pen</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Pen</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">color</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">thickness</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span
class="ID">SOLID</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  95 </span></span>
<span class="line"><span class="LineNumber">  96 </span>    <span class="ResWord">def</span> <span class="ID">SetThickness</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">num</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  97 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">thickness</span> <span class="Operator">=</span> <span class="ID">num</span></span>
<span class="line"><span class="LineNumber">  98 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">pen</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Pen</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">color</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">thickness</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span
class="ID">SOLID</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  99 </span></span>
<span class="line"><span class="LineNumber"> 100 </span></span>
<span class="line"><span class="LineNumber"> 101 </span><span class="ResWord">class</span> <span class="ID">SketchFrame</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">Frame</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 102 </span>    <span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 103 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Frame</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="String">"Sketch Frame"</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 104 </span>                <span class="ID">size</span><span class="Operator">=</span><span class="Operator">(</span><span class="Number">800</span><span class="Operator">,</span><span class="Number">600</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 105 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span> <span class="Operator">=</span> <span class="ID">SketchWindow</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 106 </span></span>
<span class="line"><span class="LineNumber"> 107 </span><span class="ResWord">if</span> <span class="ID">__name__</span> <span class="Operator">==</span> <span class="String">'__main__'</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 108 </span>    <span class="ID">app</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">PySimpleApp</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 109 </span>    <span class="ID">frame</span> <span class="Operator">=</span> <span class="ID">SketchFrame</span><span class="Operator">(</span><span class="ID">None</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 110 </span>    <span class="ID">frame</span><span class="Operator">.</span><span class="ID">Show</span><span class="Operator">(</span><span class="ID">True</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 111 </span>    <span class="ID">app</span><span class="Operator">.</span><span class="ID">MainLoop</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-173" class="anchor"/><p class="line867"><strong>说明</strong>： <span id="line-174" class="anchor"/><span id="line-175" class="anchor"/><span id="line-176" class="anchor"/></p><p class="line867"><strong>#1</strong>：<tt>wx.Pen</tt>实例决定绘画到设备上下文的线条的颜色、粗细和样式。样式除了<tt>wx.SOLID</tt>还有<tt>wx.DOT</tt>, <tt>wx.LONGDASH</tt>, 和<tt>wx.SHORTDASH</tt>。 <span id="line-177" class="anchor"/><span id="line-178" class="anchor"/><span id="line-179" class="anchor"/></p><p
class="line867"><strong>#2</strong>：窗口需要去响应几个不同的鼠标类型事件以便绘制图形。响应的事件有鼠标左键按下和释放、鼠标移动、窗口大小变化和窗口重绘。这里也指定了空闲时的处理。 <span id="line-180" class="anchor"/><span id="line-181" class="anchor"/><span id="line-182" class="anchor"/></p><p class="line867"><strong>#3</strong>：用两步创建了缓存的设备上下文：（1）创建空的位图，它作为画面外(<tt>offscreen)</tt>的缓存（2）使用画面外的缓存创建一个缓存的设备上下文。这个缓存的上下文用于防止我勾画线的重绘所引起的屏幕闪烁。在这节的较后面的部分，我们将更详细地讨论这个缓存的设备上下文。 <span id="line-183"
class="anchor"/><span id="line-184" class="anchor"/><span id="line-185" class="anchor"/></p><p class="line867"><strong>#4</strong>：这几行发出绘制命令到设备上下文；具体就是，设置背景色并清空设备上下文(<tt>dc.Clear())</tt>。必须调用<tt>dc.Clear()</tt>，其作用是产生一个<tt>wx.EVT_PAINT</tt>事件，这样，设置的背景就显示出来了，否则屏幕颜色不会改变。<tt>wx.Brush</tt>对象决定了背景的颜色和样式。 <span id="line-186" class="anchor"/><span id="line-187" class="anchor"/><span id="line-188" class="anchor"/></p><p
class="line867"><strong>#5</strong>：事件方法<tt>GetPositionTuple()</tt>返回一个包含鼠标敲击的精确位置的<tt>Python</tt>元组。 <span id="line-189" class="anchor"/><span id="line-190" class="anchor"/><span id="line-191" class="anchor"/></p><p class="line867"><strong>#6</strong>：<tt>CaptureMouse()</tt>方法控制了鼠标并在窗口的内部捕获鼠标，即使是你拖动鼠标到窗口边框的外面，它仍然只响应窗口内的鼠标动作。在程序的后面必须调用<tt>ReleaseMouse()</tt>来取消其对鼠标的控制。否则该窗口将无法通过鼠标关闭等，试将#7注释掉。 <span id="line-192" class="anchor"/><span id="line-193" class="anchor"/><span id="line-194"
class="anchor"/></p><p class="line867"><strong>#7</strong>：<tt>ReleaseMouse()</tt>方法将系统返回到调用<tt>CaptureMouse()</tt>之前的状态。<tt>wxPython</tt>应用程序使用一个椎栈来对捕获了鼠标的窗口的跟踪，调用<tt>ReleaseMouse()</tt>相当于从椎栈中弹出。这意味着你需要调用相同数据的<tt>CaptureMouse()</tt>和<tt>ReleaseMouse()</tt>。 <span id="line-195" class="anchor"/><span id="line-196" class="anchor"/><span id="line-197" class="anchor"/></p><p
class="line867"><strong>#8</strong>：这行确定移动事件是否是线条绘制的一部分，由移动事件发生时鼠标左键是否处于按下状态来确定。<tt>Dragging()</tt>和<tt>LeftIsDown()</tt>都是<tt>wx.MouseEvent</tt>的方法，如果移动事件发生时所关联的条件成立，方法返回<tt>true</tt>。 <span id="line-198" class="anchor"/><span id="line-199" class="anchor"/><span id="line-200" class="anchor"/></p><p
class="line867"><strong>#9</strong>：由于<tt>wx.BufferedDC</tt>是一个临时创建的设备上下文，所以在我们绘制线条之前需要另外创建一个。这里，我们创建一个新的<tt>wx.ClientDC</tt>作为主要的设备上下文，并再次使用我们的实例变量位图作为缓存。 <span id="line-201" class="anchor"/><span id="line-202" class="anchor"/><span id="line-203" class="anchor"/></p><p
class="line867"><strong>#10</strong>：这几行实际是使用设备上下文去绘画新近的勾画线到屏幕上。首先，我们创建了<tt>coords</tt>元组，它合并了<tt>self.pos</tt>和<tt>newPos</tt>元组。这里，新的位置来自于事件<tt>GetPositionTuple()</tt>，老的位置是最后对<tt>OnMotion()</tt>调用所得到的。我们把该元组保存到<tt>self.curLine</tt>列表中，然后调用<tt>DrawLine()</tt>。*<tt>coords</tt>返回元组<tt>coords</tt>中的元素<tt>x1</tt>,<tt>y1</tt>,<tt>x2</tt>,<tt>y2</tt>。<tt>DrawLine()</tt>方法要求的参数形如<tt>x1</tt>,<tt>y1</tt>,<tt>x2</tt>,<tt>y2</tt>，并从点(<tt>x1</tt>,<tt>y1)</tt>到(<tt>x2</tt>,<tt>y2)</tt>绘制一条线。勾画的速度依赖于底层系统的速度。
<span id="line-204" class="anchor"/><span id="line-205" class="anchor"/><span id="line-206" class="anchor"/></p><p class="line867"><strong>#11</strong>：如果窗口大小改变了，我们存储一个<tt>True</tt>值到<tt>self.reInitBuffer</tt>实例属性中。我们实际上不做任何事直到下一个空闲事件。 <span id="line-207" class="anchor"/><span id="line-208" class="anchor"/><span id="line-209" class="anchor"/></p><p
class="line867"><strong>#12</strong>：当一个空闲产生时，如果已发生了一个或多个尺寸改变事件，这个应用程序抓住时机去响应一个尺寸改变事件。我们存储一个<tt>True</tt>值到<tt>self.reInitBuffer</tt>实例属性中，并在一个空闲产生时响应的动机是避免对于接二连三的尺寸改变事件都进行屏幕刷新。 <span id="line-210" class="anchor"/><span id="line-211" class="anchor"/><span id="line-212" class="anchor"/></p><p
class="line867"><strong>#13</strong>：对于所有的显示要求，都将产生<tt>wx.EVT_PAINT</tt>事件（描绘事件），并调用我们这里的方法<tt>OnPaint</tt>进行屏幕刷新（重绘），你可以看到这是出乎意料的简单：创建一个缓存的画图设备上下文。实际上<tt>wx.PaintDC</tt>被创建（因为我们处在一个<tt>Paint</tt>请求里，所以我们需要<tt>wx.PaintDC</tt>而非一个<tt>wx.ClientDC</tt>实例），然后在<tt>dc</tt>实例被删除后（函数返回时被销毁），位图被一块块地传送(<tt>blit)</tt>给屏幕并最终显示。关于缓存的更详细的信息将在随后的段落中提供。 <span id="line-213" class="anchor"/><span id="line-214" class="anchor"/><span id="line-215"
class="anchor"/></p><p class="line867"><strong>#14</strong>：当由于尺寸改变（和由于从文件载入）而导致应用程序需要根据实际数据重绘线条时，被使用。这里，我们遍历存储在实例变量<tt>self.lines</tt>中行的列表，为每行重新创建画笔，然后根据坐标绘制每一条线。 <span id="line-216" class="anchor"/><span id="line-217" class="anchor"/></p><p
class="line862">这个例子使用了两个特殊的<tt>wx.DC</tt>的子类，以使用绘画缓存。一个绘画缓存是一个不显现的区域，其中存储了所有的绘画命令（这些命令能够一次被执行），并且一步到位地复制到屏幕上。缓存的好处是用户看不到单个绘画命令的发生，因此屏幕不会闪烁。正因如此，缓存被普遍地用于动画或绘制是由一些小的部分组成的场合。 <span id="line-218" class="anchor"/><span id="line-219" class="anchor"/></p><p
class="line862">在<tt>wxPython</tt>中，有两个用于缓存的类：<tt>wx.BufferDC</tt>（通常用于缓存一个<tt>wx.ClientDC</tt>）、<tt>wx.BufferPaintDC</tt>（用于缓存一个<tt>wx.PaintDC</tt>）。它们工作方式基本上一样。缓存设备上下文的创建要使用两个参数。第一个是适当类型的目标设备上下文（例如，在例6.1中的#9，它是一个新的<tt>wx.ClientDC</tt>实例）。第二个是一个<tt>wx.Bitmap</tt>对象。在例6.1中，我们使用函数<tt>wx.EmptyBitmap</tt>创建一个位图。当绘画命令到缓存的设备上下文时，一个内在的<tt>wx.MemoryDC</tt>被用于位图绘制。当缓存对象被销毁时，C++销毁器使用<tt>Blit()</tt>方法去自动复制位图到目标。在<tt>wxPython</tt>中，销毁通常发生在对象退出作用域时。这意味缓存的设备上下文仅在临时创建时有用，所以它们能够被销毁并能用于块传送(<tt>blit)</tt>。
<span id="line-220" class="anchor"/><span id="line-221" class="anchor"/></p><p class="line862">例如例6.1的<tt>OnPaint</tt>（）方法中，<tt>self.buffer</tt>位图在建造勾画（<tt>sketch</tt>）期间已经被写了。只需要创建缓存对象，从而建立关于窗口的已有的位图与临时<tt>wx.PaintDC()</tt>之间的连接。方法结束后，缓存<tt>DC</tt>立即退出作用域，触发它的销毁器，同时将位图复制到屏幕。 <span id="line-222" class="anchor"/><span id="line-223" class="anchor"/><span id="line-224" class="anchor"/><span id="line-225" class="anchor"/></p><p class="line867"><strong>设备上下文的函数</strong> <span id="line-226"
class="anchor"/><span id="line-227" class="anchor"/></p><p class="line862">当你使用设备上下文时，要记住根据你的绘制类型去使用恰当的上下文（特别要记住<tt>wx.PaintDC</tt>和  <span id="line-228" class="anchor"/><tt>wx.ClientDC</tt>的区别）。一旦你有了适当的设备上下文，然后你就可以用它们来做一些事情了。表6.2列出 <span id="line-229" class="anchor"/>了<tt>wx.DC</tt>的一些方法。 <span id="line-230" class="anchor"/><span id="line-231" class="anchor"/><span id="line-232" class="anchor"/></p><p class="line867"><strong>表6.2</strong>  <span id="line-233"
class="anchor"/><strong><tt>wx.DC</tt>的常用方法</strong> <span id="line-234" class="anchor"/><span id="line-235" class="anchor"/></p><p class="line867"><tt>Blit(xdest</tt>, <tt>ydest</tt>, <tt>width</tt>,<tt>height</tt>, <tt>source</tt>, <tt>xsrc</tt>,<tt>ysrc)</tt>：从源设备上下文复制块到调用该方法的设备上下文。参数<tt>xdest</tt>, <tt>ydest</tt>是复制到目标上下文的起始点。接下来的两个参数指定了要复制的区域的宽度和高度。<tt>source</tt>是源设备上下文，<tt>xsrc</tt>,<tt>ysrc</tt>是源设备上下文中开始复制的起点。还有一些可选的参数来指定逻辑叠加功能和掩码。 <span id="line-236" class="anchor"/><span
id="line-237" class="anchor"/></p><p class="line867"><tt>Clear()</tt>：通过使用当前的背景刷来清除设备上下文。 <span id="line-238" class="anchor"/><span id="line-239" class="anchor"/></p><p class="line867"><tt>DrawArc(x1</tt>, <tt>y1</tt>, <tt>x2</tt>, <tt>y2</tt>,<tt>xc</tt>, <tt>yc)</tt>：使用起点(<tt>x1</tt>, <tt>y1)</tt>和终点(<tt>x2</tt>, <tt>y2)</tt>画一个圆弧。(<tt>xc</tt>, <tt>yc)</tt>是圆弧的中心。圆弧使用当前的画刷填充。这个函数按逆时针画。这也有一个相关的方法<tt>DrawEllipticalArc()</tt>。 <span id="line-240" class="anchor"/><span id="line-241" class="anchor"/></p><p
class="line867"><tt>DrawBitmap(bitmap</tt>, x,y, <tt>transparent)</tt>：绘制一个<tt>wx.Bitmap</tt>对象，起点为(x, <tt>y)</tt>。如果<tt>transparent</tt>为真，所复制的位图将是透明的。 <span id="line-242" class="anchor"/><span id="line-243" class="anchor"/></p><p class="line867"><tt>DrawCircle(x</tt>, y, <tt>radius)</tt> <span id="line-244" class="anchor"/><tt>DrawCircle(point</tt>, <tt>radius)</tt>：按给定的中心点和半径画圆。这也有一个相关的方法<tt>DrawEllipse</tt>。 <span id="line-245" class="anchor"/><span id="line-246" class="anchor"/></p><p class="line867"><tt>DrawIcon(icon</tt>, x,
<tt>y)</tt>：绘制一个<tt>wx.Icon</tt>对象到上下文，起点是(x, <tt>y)</tt>。 <span id="line-247" class="anchor"/><span id="line-248" class="anchor"/></p><p class="line867"><tt>DrawLine(x1</tt>, <tt>y1</tt>, <tt>x2</tt>, <tt>y2)</tt>：从点(<tt>x1</tt>, <tt>y1)</tt>到(<tt>x2</tt>, <tt>y2)</tt>画一条线。这有一个相关的方法<tt>DrawLines()</tt>，该方法要<tt>wx.Point</tt>对象的一个<tt>Python</tt>列表为参数，并将其中的点连接起来。 <span id="line-249" class="anchor"/><span id="line-250" class="anchor"/></p><p
class="line867"><tt>DrawPolygon(points)</tt>：按给定的<tt>wx.Point</tt>对象的一个<tt>Python</tt>列表绘制一个多边形。与<tt>DrawLines()</tt>不同的是，它的终点和起点相连。多边形使用当前的画刷来填充。这有一些可选的参数来设置x和y的偏移以及填充样式。 <span id="line-251" class="anchor"/><span id="line-252" class="anchor"/></p><p class="line867"><tt>DrawRectangle(x</tt>, y,<tt>width</tt>, <tt>height)</tt>：绘制一个矩形，它的左上角是(x, <tt>y)</tt>，其宽和高是<tt>width</tt>和<tt>height</tt> <span id="line-253" class="anchor"/><span id="line-254" class="anchor"/></p><p class="line874">。 <span id="line-255"
class="anchor"/><span id="line-256" class="anchor"/></p><p class="line867"><tt>DrawText(text</tt>, x, <tt>y)</tt>：从点(x, <tt>y)</tt>开始绘制给定的字符串，使用当前的字体。相关函数包括<tt>DrawRotatedText()</tt>和<tt>GetTextExtent()</tt>。文本项有前景色和背景色属性。 <span id="line-257" class="anchor"/><span id="line-258" class="anchor"/></p><p class="line867"><tt>FloodFill(x</tt>, y, <tt>color</tt>,<tt>style)</tt>：从点(x,
<tt>y)</tt>执行一个区域填充，使用当前画刷的颜色。参数<tt>style</tt>是可选的。<tt>style</tt>的默认值是<tt>wx.FLOOD_SURFACE</tt>，它表示当填充碰到另一颜色时停止。另一值<tt>wx.FLOOD_BORDER</tt>表示参数<tt>color</tt>是填充的边界，当填充碰到该颜色的代表的边界时停止。 <span id="line-259" class="anchor"/><span id="line-260" class="anchor"/></p><p class="line867"><tt>GetBackground()</tt> <span id="line-261" class="anchor"/><tt>SetBackground(brush)</tt>：背景画刷是一个<tt>wx.Brush</tt>对象，当<tt>Clear()</tt>方法被调用时使用。 <span id="line-262" class="anchor"/><span id="line-263" class="anchor"/></p><p
class="line867"><tt>GetBrush()</tt> <span id="line-264" class="anchor"/><tt>SetBrush(brush)</tt>：画刷是一个<tt>wx.Brush</tt>对象并且用于填充任何绘制在设备上下文上的形状。 <span id="line-265" class="anchor"/><span id="line-266" class="anchor"/></p><p class="line867"><tt>GetFont()</tt> <span id="line-267" class="anchor"/><tt>SetFont(font)</tt>：字体(<tt>font)</tt>是一个<tt>wx.Font</tt>对象，被用于所有的文本绘制操作。 <span id="line-268" class="anchor"/><span id="line-269" class="anchor"/></p><p class="line867"><tt>GetPen()</tt> <span id="line-270"
class="anchor"/><tt>SetPen(pen)</tt>：画笔(<tt>pen)</tt>是一个<tt>wx.Pen</tt>对象，被用于所有绘制线条的操作。 <span id="line-271" class="anchor"/><span id="line-272" class="anchor"/></p><p class="line867"><tt>GetPixel(x</tt>, <tt>y)</tt>：返回一个关于点(x, <tt>y)</tt>的像素的一个<tt>wx.Colour</tt>对象。 <span id="line-273" class="anchor"/><span id="line-274" class="anchor"/></p><p class="line867"><tt>GetSize()</tt> <span id="line-275" class="anchor"/><tt>GetSizeTuple()</tt>：以一个<tt>wx.Size</tt>对象或一个<tt>Python</tt>元组的形式返回设备上下文的像素尺寸。 <span id="line-276" class="anchor"/><span
id="line-277" class="anchor"/></p><p class="line874">上面的列表并没有囊括所有的方法。另外的一些方法将在第十二章中说明。 <span id="line-278" class="anchor"/><span id="line-279" class="anchor"/><span id="line-280" class="anchor"/></p><p class="line867">
</p><h2 id="head-e9041aecf0546b14acad3a649b41e08b3a422553">1.2. 添加窗口装饰</h2>
<span id="line-281" class="anchor"/><span id="line-282" class="anchor"/><span id="line-283" class="anchor"/><p class="line874">尽管绘制到屏幕是一个画图程序不可或缺的部分，但是它距美观的程序还差的远。在这一节，我们将谈及常用的窗口装饰：状态栏、菜单和工具栏。我们将在第10章对这些做更详细的讨论。 <span id="line-284" class="anchor"/><span id="line-285" class="anchor"/><span id="line-286" class="anchor"/></p><p class="line867">
</p><h3 id="head-925ab8656124ddf5757a8e70821b6d0947495243">1.2.1. 如何添加和更新一个状态栏</h3>
<span id="line-287" class="anchor"/><span id="line-288" class="anchor"/><span id="line-289" class="anchor"/><p class="line862">在<tt>wxPython</tt>中，你可以通过调用框架的<tt>CreateStatusBar()</tt>方法添加并放置一个状态栏到一个框架的底部。当父框架调整大小的时候，状态栏自动的自我调整大小。默认情况下，状态栏是类<tt>wx.StatusBar</tt>的一个实例。要创建一个自定义的状态栏，要使用<tt>SetStatusBar()</tt>方法并要求你的新类的实例作为参数来将状态栏附着到你的框架上。 <span id="line-290" class="anchor"/><span id="line-291" class="anchor"/></p><p
class="line862">要在你的状态栏上显示单一的一段文本，你可以使用<tt>wx.StatusBar</tt>的<tt>SetStatusText()</tt>方法。例6.2扩展了在例6.1中所演示的<tt>SketchFrame</tt>类来在状态栏中显示当前鼠标的位置。 <span id="line-292" class="anchor"/><span id="line-293" class="anchor"/></p><p class="line874">例6.2 给框架添加一个简单的状态栏 <span id="line-294" class="anchor"/></p><pre>#python
<span id="line-295" class="anchor"/>import wx
<span id="line-296" class="anchor"/>from example1 import SketchWindow
<span id="line-297" class="anchor"/>
<span id="line-298" class="anchor"/>
<span id="line-299" class="anchor"/>class SketchFrame(wx.Frame):
<span id="line-300" class="anchor"/>    def __init__(self, parent):
<span id="line-301" class="anchor"/>        wx.Frame.__init__(self, parent, -1, "Sketch Frame",
<span id="line-302" class="anchor"/>                size=(800,600))
<span id="line-303" class="anchor"/>        self.sketch = SketchWindow(self, -1)
<span id="line-304" class="anchor"/>        self.sketch.Bind(wx.EVT_MOTION, self.OnSketchMotion)
<span id="line-305" class="anchor"/>        self.statusbar = self.CreateStatusBar()
<span id="line-306" class="anchor"/>
<span id="line-307" class="anchor"/>    def OnSketchMotion(self, event):
<span id="line-308" class="anchor"/>        self.statusbar.SetStatusText(str(event.GetPositionTuple()))
<span id="line-309" class="anchor"/>        event.Skip()
<span id="line-310" class="anchor"/>
<span id="line-311" class="anchor"/>if __name__ == '__main__':
<span id="line-312" class="anchor"/>    app = wx.PySimpleApp()
<span id="line-313" class="anchor"/>    frame = SketchFrame(None)
<span id="line-314" class="anchor"/>    frame.Show(True)
<span id="line-315" class="anchor"/>    app.MainLoop()
<span id="line-316" class="anchor"/></pre><span id="line-317" class="anchor"/><p class="line862">我们通过使框架捕捉勾画窗的<tt>wx.EVT_MOTION</tt>事件来在状态栏中显示鼠标位置。事件处理器使用由该事件提供的数据设置状态栏的文?尽Ｈ缓蟮饔脅{{Skip()}}}方法来保证另外的<tt>OnMotion()</tt>方法被调用，否则线条将不被绘制。 <span id="line-318" class="anchor"/><span id="line-319" class="anchor"/></p><p
class="line862">如果你想在状态栏中显示多个文本元素，你可以在状态栏中创建多个文本域。要使用这个功能，你要调用<tt>SetFieldsCount()</tt>方法，其参数是域的数量；默认情况下只有我们先前所见的那一个域。这之后使用先前的<tt>SetStatusText()</tt>，但是要使用第二个参数来指定此方法所应的域。域的编号从0开始。如果你不指定一个域，那么默认为设置第0号域，这也说明了为什么我们没有指定域而先前的例子能工作。 <span id="line-320" class="anchor"/><span id="line-321" class="anchor"/></p><p
class="line862">默认情况下，每个域的宽度是相同的。要调整文本域的尺寸，<tt>wxPython</tt>提供了<tt>SetStatusWidth()</tt>方法。该方法要求一个整数的<tt>Python</tt>列表作为参数，列表的长度必须和状态栏中哉的数量一致。按列表中整数的顺序来计算对应域的宽度。如果整数是正值，那么宽度是固定的。如果你想域的宽度随框架的变化而变化，那么应该使用负值。负值的绝对值代表域的相对宽度；可以把它认为是所占总宽度的比例。例如调用<tt>statusbar.SetStatusWidth(</tt>[-1, -2,-3])方法所导致的各域从左到右的宽度比例是1:2:3。图6.2显示了这个结果。 <span id="line-322" class="anchor"/><span id="line-323" class="anchor"/></p><p
class="line874">图6.2 <span id="line-324" class="anchor"/><span id="line-325" class="anchor"/></p><p class="line867"><img title="attachment:w6.2.gif" src="/moin/WxPythonInAction/ChapterSix?action=AttachFile&amp;do=get&amp;target=w6.2.gif" class="attachment"/> <span id="line-326" class="anchor"/><span id="line-327" class="anchor"/><span id="line-328" class="anchor"/></p><p class="line874">例子6.3增加了两个状态域，其中一个显示所绘的当前线条的点数，另一个显示当前所画的线条的数量。该例所产生的状态条如图6.2所示。 <span id="line-329" class="anchor"/><span id="line-330" class="anchor"/></p><p
class="line874">例6.3 支持多个状态域 <span id="line-331" class="anchor"/><span id="line-332" class="anchor"/><span id="line-333" class="anchor"/><span id="line-334" class="anchor"/><span id="line-335" class="anchor"/><span id="line-336" class="anchor"/><span id="line-337" class="anchor"/><span id="line-338" class="anchor"/><span id="line-339" class="anchor"/><span id="line-340" class="anchor"/><span id="line-341" class="anchor"/><span id="line-342" class="anchor"/><span id="line-343" class="anchor"/><span id="line-344" class="anchor"/><span id="line-345" class="anchor"/><span id="line-346"
class="anchor"/><span id="line-347" class="anchor"/><span id="line-348" class="anchor"/><span id="line-349" class="anchor"/><span id="line-350" class="anchor"/><span id="line-351" class="anchor"/><span id="line-352" class="anchor"/><span id="line-353" class="anchor"/><span id="line-354" class="anchor"/><span id="line-355" class="anchor"/><span id="line-356" class="anchor"/><span id="line-357" class="anchor"/><span id="line-358" class="anchor"/><span id="line-359" class="anchor"/><span id="line-360" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-bacf981995db9463ec42307426329624fc6ff478_001\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-bacf981995db9463ec42307426329624fc6ff478_001', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-bacf981995db9463ec42307426329624fc6ff478_001" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">import</span> <span class="ID">wx</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="ResWord">from</span> <span class="ID">example1</span> <span class="ResWord">import</span> <span class="ID">SketchWindow</span></span>
<span class="line"><span class="LineNumber">   3 </span></span>
<span class="line"><span class="LineNumber">   4 </span><span class="ResWord">class</span> <span class="ID">SketchFrame</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">Frame</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   5 </span>    <span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   6 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Frame</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="String">"Sketch Frame"</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   7 </span>                <span class="ID">size</span><span class="Operator">=</span><span class="Operator">(</span><span class="Number">800</span><span class="Operator">,</span><span class="Number">600</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span> <span class="Operator">=</span> <span class="ID">SketchWindow</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   9 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_MOTION</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSketchMotion</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  10 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">CreateStatusBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">.</span><span class="ID">SetFieldsCount</span><span class="Operator">(</span><span class="Number">3</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  12 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">.</span><span class="ID">SetStatusWidths</span><span class="Operator">(</span><span class="Operator">[</span><span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">2</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">3</span><span class="Operator">]</span><span
class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  13 </span></span>
<span class="line"><span class="LineNumber">  14 </span>    <span class="ResWord">def</span> <span class="ID">OnSketchMotion</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  15 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">.</span><span class="ID">SetStatusText</span><span class="Operator">(</span><span class="String">"Pos: %s"</span> <span class="Operator">%</span></span>
<span class="line"><span class="LineNumber">  16 </span>                <span class="ID">str</span><span class="Operator">(</span><span class="ID">event</span><span class="Operator">.</span><span class="ID">GetPositionTuple</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  17 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">.</span><span class="ID">SetStatusText</span><span class="Operator">(</span><span class="String">"Current Pts: %s"</span> <span class="Operator">%</span></span>
<span class="line"><span class="LineNumber">  18 </span>                <span class="ID">len</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">curLine</span><span class="Operator">)</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  19 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">.</span><span class="ID">SetStatusText</span><span class="Operator">(</span><span class="String">"Line Count: %s"</span> <span class="Operator">%</span></span>
<span class="line"><span class="LineNumber">  20 </span>                <span class="ID">len</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">lines</span><span class="Operator">)</span><span class="Operator">,</span> <span class="Number">2</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  21 </span>        <span class="ID">event</span><span class="Operator">.</span><span class="ID">Skip</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  22 </span></span>
<span class="line"><span class="LineNumber">  23 </span><span class="ResWord">if</span> <span class="ID">__name__</span> <span class="Operator">==</span> <span class="String">'__main__'</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  24 </span>    <span class="ID">app</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">PySimpleApp</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  25 </span>    <span class="ID">frame</span> <span class="Operator">=</span> <span class="ID">SketchFrame</span><span class="Operator">(</span><span class="ID">None</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  26 </span>    <span class="ID">frame</span><span class="Operator">.</span><span class="ID">Show</span><span class="Operator">(</span><span class="ID">True</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  27 </span>    <span class="ID">app</span><span class="Operator">.</span><span class="ID">MainLoop</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-361" class="anchor"/><p class="line867"><tt>StatusBar</tt>类使你能够把状态域当作一个后进先出的堆栈。尽管本章的演示程序没有这样用，<tt>PushStatus</tt>- <span id="line-362" class="anchor"/><tt>Text()</tt>和<tt>PopStatusText()</tt>使得你能够在临时显示新的文本之后返回先前的状态文本。这两个方法都有一个可选的域号参数，以便在多个状态域的情况下使用。 <span id="line-363" class="anchor"/><span id="line-364" class="anchor"/></p><p class="line862">表6.3归纳了<tt>wx.StatusBar</tt>最常用的方法 <span id="line-365" class="anchor"/><span id="line-366" class="anchor"/><span
id="line-367" class="anchor"/></p><p class="line867"><strong>表6.3</strong>  <span id="line-368" class="anchor"/><strong><tt>wx.StatusBar</tt>的方法</strong> <span id="line-369" class="anchor"/><span id="line-370" class="anchor"/></p><p class="line867"><tt>GetFieldsCount()</tt> <span id="line-371" class="anchor"/><tt>SetFieldsCount(count)</tt>：得到或设置状态栏中域的数量。 <span id="line-372" class="anchor"/><span id="line-373" class="anchor"/></p><p class="line867"><tt>GetStatusText(field</tt>=0) <span id="line-374" class="anchor"/><tt>SetStatusText(text</tt>,
<tt>field</tt>=0)：得到或设置指定域中的文本。0是默认值，代表最左端的域。 <span id="line-375" class="anchor"/><span id="line-376" class="anchor"/></p><p class="line867"><tt>PopStatusText(field</tt>=0)：弹出堆栈中的文本到指定域中，以改变域中的文本为弹出值。 <span id="line-377" class="anchor"/><span id="line-378" class="anchor"/></p><p class="line867"><tt>PushStatusText(text</tt>, <tt>field</tt>=0)：改变指定的域中的文本为给定的文本，并将改变前的文本压入堆栈的顶部。 <span id="line-379" class="anchor"/><span id="line-380" class="anchor"/></p><p
class="line867"><tt>SetStatusWidths(widths)</tt>：指定各状态域的宽度。<tt>widths</tt>是一个整数的<tt>Python</tt>列表。 <span id="line-381" class="anchor"/><span id="line-382" class="anchor"/></p><p class="line874">在第10章中，我们将对状态栏作更详细的说明。下面我们将讨论菜单。 <span id="line-383" class="anchor"/><span id="line-384" class="anchor"/><span id="line-385" class="anchor"/><span id="line-386" class="anchor"/></p><p class="line867">
</p><h3 id="head-4cb95b0f0378583e52292ed6ffc854beb6a83b70">1.2.2. 如何添加菜单？</h3>
<span id="line-387" class="anchor"/><span id="line-388" class="anchor"/><span id="line-389" class="anchor"/><p class="line874">本节，我们将说明如何添加子菜单和复选或单选菜单。子菜单是顶级菜单中的菜单。复制菜单或单选菜单是一组菜单项，它们的行为类似于一组复选框或单选按钮。图6.3显示了一个菜单栏，其中的一个子菜单包含了单选菜单项。 <span id="line-390" class="anchor"/><span id="line-391" class="anchor"/></p><p class="line874">图6.3 <span id="line-392" class="anchor"/><span id="line-393" class="anchor"/></p><p class="line867"><img title="attachment:w6.3.gif"
src="/moin/WxPythonInAction/ChapterSix?action=AttachFile&amp;do=get&amp;target=w6.3.gif" class="attachment"/> <span id="line-394" class="anchor"/><span id="line-395" class="anchor"/><span id="line-396" class="anchor"/></p><p class="line862">要创建一个子菜单，首先和创建别的菜单方法一样创建一个菜单，然后再使用<tt>wx.Menu.AppendMenu()</tt>将它添加给父菜单。 <span id="line-397" class="anchor"/><span id="line-398" class="anchor"/></p><p
class="line862">带有复选或单选菜单的菜单可以通过使用<tt>wx.Menu</tt>的<tt>AppendCheckItem()</tt>和<tt>AppendRadioItem()</tt>方法来创建，或通过在<tt>wx.MenuItem</tt>的创建器中使参数<tt>kind</tt>的属性值为下列之一来创建：<tt>wx.ITEM_NORMAL</tt>, <tt>wx.ITEM_CHECKBOX</tt>, 或 <tt>wx.ITEM_RADIO</tt>。要使用编程的方法来选择一个菜单项，可以使<tt>wx.Menu</tt>的<tt>Check(id</tt>,<tt>bool)</tt>方法，<tt>id</tt>是所要改变项的<tt>wxPython</tt> <tt>ID</tt>，<tt>bool</tt>指定了该项的选择状态。 <span id="line-399" class="anchor"/><span id="line-400" class="anchor"/></p><p
class="line874">例6.4为我们初始的绘画程序添加了菜单支持。我们这里的菜单改进自例5.5中的被重构的公用程序代码。 <span id="line-401" class="anchor"/><span id="line-402" class="anchor"/><span id="line-403" class="anchor"/></p><p class="line867"><strong>例子6.4</strong> <span id="line-404" class="anchor"/><span id="line-405" class="anchor"/><span id="line-406" class="anchor"/><span id="line-407" class="anchor"/><span id="line-408" class="anchor"/><span id="line-409" class="anchor"/><span id="line-410" class="anchor"/><span id="line-411" class="anchor"/><span id="line-412"
class="anchor"/><span id="line-413" class="anchor"/><span id="line-414" class="anchor"/><span id="line-415" class="anchor"/><span id="line-416" class="anchor"/><span id="line-417" class="anchor"/><span id="line-418" class="anchor"/><span id="line-419" class="anchor"/><span id="line-420" class="anchor"/><span id="line-421" class="anchor"/><span id="line-422" class="anchor"/><span id="line-423" class="anchor"/><span id="line-424" class="anchor"/><span id="line-425" class="anchor"/><span id="line-426" class="anchor"/><span id="line-427" class="anchor"/><span id="line-428"
class="anchor"/><span id="line-429" class="anchor"/><span id="line-430" class="anchor"/><span id="line-431" class="anchor"/><span id="line-432" class="anchor"/><span id="line-433" class="anchor"/><span id="line-434" class="anchor"/><span id="line-435" class="anchor"/><span id="line-436" class="anchor"/><span id="line-437" class="anchor"/><span id="line-438" class="anchor"/><span id="line-439" class="anchor"/><span id="line-440" class="anchor"/><span id="line-441" class="anchor"/><span id="line-442" class="anchor"/><span id="line-443" class="anchor"/><span id="line-444"
class="anchor"/><span id="line-445" class="anchor"/><span id="line-446" class="anchor"/><span id="line-447" class="anchor"/><span id="line-448" class="anchor"/><span id="line-449" class="anchor"/><span id="line-450" class="anchor"/><span id="line-451" class="anchor"/><span id="line-452" class="anchor"/><span id="line-453" class="anchor"/><span id="line-454" class="anchor"/><span id="line-455" class="anchor"/><span id="line-456" class="anchor"/><span id="line-457" class="anchor"/><span id="line-458" class="anchor"/><span id="line-459" class="anchor"/><span id="line-460"
class="anchor"/><span id="line-461" class="anchor"/><span id="line-462" class="anchor"/><span id="line-463" class="anchor"/><span id="line-464" class="anchor"/><span id="line-465" class="anchor"/><span id="line-466" class="anchor"/><span id="line-467" class="anchor"/><span id="line-468" class="anchor"/><span id="line-469" class="anchor"/><span id="line-470" class="anchor"/><span id="line-471" class="anchor"/><span id="line-472" class="anchor"/><span id="line-473" class="anchor"/><span id="line-474" class="anchor"/><span id="line-475" class="anchor"/><span id="line-476"
class="anchor"/><span id="line-477" class="anchor"/><span id="line-478" class="anchor"/><span id="line-479" class="anchor"/><span id="line-480" class="anchor"/><span id="line-481" class="anchor"/><span id="line-482" class="anchor"/><span id="line-483" class="anchor"/><span id="line-484" class="anchor"/><span id="line-485" class="anchor"/><span id="line-486" class="anchor"/><span id="line-487" class="anchor"/><span id="line-488" class="anchor"/><span id="line-489" class="anchor"/><span id="line-490" class="anchor"/><span id="line-491" class="anchor"/><span id="line-492"
class="anchor"/><span id="line-493" class="anchor"/><span id="line-494" class="anchor"/><span id="line-495" class="anchor"/><span id="line-496" class="anchor"/><span id="line-497" class="anchor"/><span id="line-498" class="anchor"/><span id="line-499" class="anchor"/><span id="line-500" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-e0670a7ab2b4798edfdca30c6508d428c92f4cc4_002\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-e0670a7ab2b4798edfdca30c6508d428c92f4cc4_002', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-e0670a7ab2b4798edfdca30c6508d428c92f4cc4_002" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">import</span> <span class="ID">wx</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="ResWord">from</span> <span class="ID">example1</span> <span class="ResWord">import</span> <span class="ID">SketchWindow</span></span>
<span class="line"><span class="LineNumber">   3 </span></span>
<span class="line"><span class="LineNumber">   4 </span></span>
<span class="line"><span class="LineNumber">   5 </span><span class="ResWord">class</span> <span class="ID">SketchFrame</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">Frame</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   6 </span>    <span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   7 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Frame</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="String">"Sketch Frame"</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   8 </span>                <span class="ID">size</span><span class="Operator">=</span><span class="Operator">(</span><span class="Number">800</span><span class="Operator">,</span><span class="Number">600</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   9 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span> <span class="Operator">=</span> <span class="ID">SketchWindow</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  10 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_MOTION</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSketchMotion</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">initStatusBar</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Comment">#1 这里因重构有点变化</span></span>
<span class="line"><span class="LineNumber">  12 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">createMenuBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  13 </span></span>
<span class="line"><span class="LineNumber">  14 </span>    <span class="ResWord">def</span> <span class="ID">initStatusBar</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  15 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">CreateStatusBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  16 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">.</span><span class="ID">SetFieldsCount</span><span class="Operator">(</span><span class="Number">3</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  17 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">.</span><span class="ID">SetStatusWidths</span><span class="Operator">(</span><span class="Operator">[</span><span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">2</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">3</span><span class="Operator">]</span><span
class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  18 </span></span>
<span class="line"><span class="LineNumber">  19 </span>    <span class="ResWord">def</span> <span class="ID">OnSketchMotion</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  20 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">.</span><span class="ID">SetStatusText</span><span class="Operator">(</span><span class="String">"Pos: %s"</span> <span class="Operator">%</span></span>
<span class="line"><span class="LineNumber">  21 </span>                <span class="ID">str</span><span class="Operator">(</span><span class="ID">event</span><span class="Operator">.</span><span class="ID">GetPositionTuple</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  22 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">.</span><span class="ID">SetStatusText</span><span class="Operator">(</span><span class="String">"Current Pts: %s"</span> <span class="Operator">%</span></span>
<span class="line"><span class="LineNumber">  23 </span>                <span class="ID">len</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">curLine</span><span class="Operator">)</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  24 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">.</span><span class="ID">SetStatusText</span><span class="Operator">(</span><span class="String">"Line Count: %s"</span> <span class="Operator">%</span></span>
<span class="line"><span class="LineNumber">  25 </span>                <span class="ID">len</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">lines</span><span class="Operator">)</span><span class="Operator">,</span> <span class="Number">2</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  26 </span>        <span class="ID">event</span><span class="Operator">.</span><span class="ID">Skip</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  27 </span></span>
<span class="line"><span class="LineNumber">  28 </span>    <span class="ResWord">def</span> <span class="ID">menuData</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span> <span class="Comment">#2 菜单数据</span></span>
<span class="line"><span class="LineNumber">  29 </span>        <span class="ResWord">return</span> <span class="Operator">[</span><span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="Operator">(</span></span>
<span class="line"><span class="LineNumber">  30 </span>                    <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">"New Sketch file"</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnNew</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  31 </span>                    <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">"Open sketch file"</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnOpen</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  32 </span>                    <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">"Save sketch file"</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSave</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  33 </span>                    <span class="Operator">(</span><span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  34 </span>                    <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="Operator">(</span></span>
<span class="line"><span class="LineNumber">  35 </span>                        <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnColor</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  36 </span>                           <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ITEM_RADIO</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  37 </span>                        <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnColor</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  38 </span>                           <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ITEM_RADIO</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  39 </span>                        <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnColor</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  40 </span>                           <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ITEM_RADIO</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  41 </span>                        <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnColor</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  42 </span>                           <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ITEM_RADIO</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  43 </span>                    <span class="Operator">(</span><span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  44 </span>                    <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">"Quit"</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnCloseWindow</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  45 </span></span>
<span class="line"><span class="LineNumber">  46 </span>    <span class="ResWord">def</span> <span class="ID">createMenuBar</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  47 </span>        <span class="ID">menuBar</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">MenuBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  48 </span>        <span class="ResWord">for</span> <span class="ID">eachMenuData</span> <span class="ResWord">in</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">menuData</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  49 </span>            <span class="ID">menuLabel</span> <span class="Operator">=</span> <span class="ID">eachMenuData</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  50 </span>            <span class="ID">menuItems</span> <span class="Operator">=</span> <span class="ID">eachMenuData</span><span class="Operator">[</span><span class="Number">1</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  51 </span>            <span class="ID">menuBar</span><span class="Operator">.</span><span class="ID">Append</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">createMenu</span><span class="Operator">(</span><span class="ID">menuItems</span><span class="Operator">)</span><span class="Operator">,</span> <span class="ID">menuLabel</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  52 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">SetMenuBar</span><span class="Operator">(</span><span class="ID">menuBar</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  53 </span></span>
<span class="line"><span class="LineNumber">  54 </span>    <span class="ResWord">def</span> <span class="ID">createMenu</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">menuData</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  55 </span>        <span class="ID">menu</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Menu</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  56 </span><span class="Comment">#3 创建子菜单</span></span>
<span class="line"><span class="LineNumber">  57 </span><span class="Comment"/>        <span class="ResWord">for</span> <span class="ID">eachItem</span> <span class="ResWord">in</span> <span class="ID">menuData</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  58 </span>            <span class="ResWord">if</span> <span class="ID">len</span><span class="Operator">(</span><span class="ID">eachItem</span><span class="Operator">)</span> <span class="Operator">==</span> <span class="Number">2</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  59 </span>                <span class="ID">label</span> <span class="Operator">=</span> <span class="ID">eachItem</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  60 </span>                <span class="ID">subMenu</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">createMenu</span><span class="Operator">(</span><span class="ID">eachItem</span><span class="Operator">[</span><span class="Number">1</span><span class="Operator">]</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  61 </span>                <span class="ID">menu</span><span class="Operator">.</span><span class="ID">AppendMenu</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">NewId</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">,</span> <span class="ID">label</span><span class="Operator">,</span> <span class="ID">subMenu</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  62 </span></span>
<span class="line"><span class="LineNumber">  63 </span>            <span class="ResWord">else</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  64 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">createMenuItem</span><span class="Operator">(</span><span class="ID">menu</span><span class="Operator">,</span> <span class="Operator">*</span><span class="ID">eachItem</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  65 </span>        <span class="ResWord">return</span> <span class="ID">menu</span></span>
<span class="line"><span class="LineNumber">  66 </span></span>
<span class="line"><span class="LineNumber">  67 </span>    <span class="ResWord">def</span> <span class="ID">createMenuItem</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">menu</span><span class="Operator">,</span> <span class="ID">label</span><span class="Operator">,</span> <span class="ID">status</span><span class="Operator">,</span> <span class="ID">handler</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  68 </span>                       <span class="ID">kind</span><span class="Operator">=</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">ITEM_NORMAL</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  69 </span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">label</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  70 </span>            <span class="ID">menu</span><span class="Operator">.</span><span class="ID">AppendSeparator</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  71 </span>            <span class="ResWord">return</span></span>
<span class="line"><span class="LineNumber">  72 </span>        <span class="ID">menuItem</span> <span class="Operator">=</span> <span class="ID">menu</span><span class="Operator">.</span><span class="ID">Append</span><span class="Operator">(</span><span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="ID">label</span><span class="Operator">,</span> <span class="ID">status</span><span class="Operator">,</span> <span class="ID">kind</span><span class="Operator">)</span><span class="Comment">#4
使用kind创建菜单项</span></span>
<span class="line"><span class="LineNumber">  73 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_MENU</span><span class="Operator">,</span> <span class="ID">handler</span><span class="Operator">,</span> <span class="ID">menuItem</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  74 </span></span>
<span class="line"><span class="LineNumber">  75 </span>    <span class="ResWord">def</span> <span class="ID">OnNew</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span> <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber">  76 </span>    <span class="ResWord">def</span> <span class="ID">OnOpen</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span> <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber">  77 </span>    <span class="ResWord">def</span> <span class="ID">OnSave</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span> <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber">  78 </span></span>
<span class="line"><span class="LineNumber">  79 </span>    <span class="ResWord">def</span> <span class="ID">OnColor</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#5 处理颜色的改变</span></span>
<span class="line"><span class="LineNumber">  80 </span>        <span class="ID">menubar</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">GetMenuBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  81 </span>        <span class="ID">itemId</span> <span class="Operator">=</span> <span class="ID">event</span><span class="Operator">.</span><span class="ID">GetId</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  82 </span>        <span class="ID">item</span> <span class="Operator">=</span> <span class="ID">menubar</span><span class="Operator">.</span><span class="ID">FindItemById</span><span class="Operator">(</span><span class="ID">itemId</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  83 </span>        <span class="ID">color</span> <span class="Operator">=</span> <span class="ID">item</span><span class="Operator">.</span><span class="ID">GetLabel</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  84 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">SetColor</span><span class="Operator">(</span><span class="ID">color</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  85 </span></span>
<span class="line"><span class="LineNumber">  86 </span>    <span class="ResWord">def</span> <span class="ID">OnCloseWindow</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  87 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Destroy</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  88 </span></span>
<span class="line"><span class="LineNumber">  89 </span></span>
<span class="line"><span class="LineNumber">  90 </span><span class="ResWord">if</span> <span class="ID">__name__</span> <span class="Operator">==</span> <span class="String">'__main__'</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  91 </span>    <span class="ID">app</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">PySimpleApp</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  92 </span>    <span class="ID">frame</span> <span class="Operator">=</span> <span class="ID">SketchFrame</span><span class="Operator">(</span><span class="ID">None</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  93 </span>    <span class="ID">frame</span><span class="Operator">.</span><span class="ID">Show</span><span class="Operator">(</span><span class="ID">True</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  94 </span>    <span class="ID">app</span><span class="Operator">.</span><span class="ID">MainLoop</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-501" class="anchor"/><p class="line867"><strong>说明</strong>： <span id="line-502" class="anchor"/><span id="line-503" class="anchor"/><span id="line-504" class="anchor"/></p><p class="line867"><strong>#1</strong>：现在<tt>__init__</tt>方法包含了更多的功能，我们把状态栏放在了它自己的方法中。 <span id="line-505" class="anchor"/><span id="line-506" class="anchor"/><span id="line-507" class="anchor"/></p><p class="line867"><strong>#2</strong>：菜单数据的格式现在是(标签, (项目))，其中的每个顶目也是一个列表(标签, 描术文字, 处理器,
可选的<tt>kind)</tt>或一个带有标签和项目的菜单。确定数据的一个子项目是菜单还是一个菜单项，请记住，菜单的长度是2，项目的长度是3或4。对于更复杂的产品数据，我建议使用<tt>XML</tt>或别的外部格式。 <span id="line-508" class="anchor"/><span id="line-509" class="anchor"/><span id="line-510" class="anchor"/></p><p class="line867"><strong>#3</strong>：如果数据块的长度是2，这意味它是一个菜单，将之分开，并递归调用<tt>createMenu</tt>，然后将之添加。 <span id="line-511" class="anchor"/><span id="line-512" class="anchor"/><span id="line-513" class="anchor"/></p><p
class="line867"><strong>#4</strong>：创建菜单项。对<tt>wx.MenuItem</tt>的构造器使用<tt>kind</tt>参数的方法比使用<tt>wx.Menu</tt>的特定方法更容易。 <span id="line-514" class="anchor"/><span id="line-515" class="anchor"/><span id="line-516" class="anchor"/></p><p class="line867"><strong>#5</strong>：<tt>OnColor</tt>方法根据所选菜单项来改变画笔的颜色。代码根据事件得到项目的<tt>id</tt>，再使用<tt>FindItemById()</tt>来得到正确的菜单项（注意我们这里使用菜单栏作为数据结构来访问，而没有使用项目<tt>id</tt>的哈希表），这个方法是以标签是<tt>wxPython</tt>颜色名为前提的。 <span
id="line-517" class="anchor"/><span id="line-518" class="anchor"/><span id="line-519" class="anchor"/><span id="line-520" class="anchor"/></p><p class="line867">
</p><h3 id="head-e60093b2627e5c41a74d9b42440a3a8c727e4d7b">1.2.3. 如何添加一个工具栏</h3>
<span id="line-521" class="anchor"/><span id="line-522" class="anchor"/><span id="line-523" class="anchor"/><p
class="line862">菜单栏和工具栏通常是紧密联系在一起的，工具栏的绝大部分功能与菜单项相对应。在<tt>wxPython</tt>中，这通过工具栏被敲击时发出<tt>wx.EVT_MENU</tt>事件，这样就可很容易地在处理菜单项的选择和工具栏的敲击时使用相同的方法。一个<tt>wxPython</tt>工具栏是类<tt>wx.ToolBar</tt>的一个实例，正如我们在第二章中所见的，可以使用框架的方法<tt>CreateToolBar()</tt>来创建。和状态栏一样，工具栏的大小也随其父框架的改变而自动改变。工具栏与其它的<tt>wxPython</tt>窗口一样可以拥有任意的子窗口。工具栏也包含创建工具按钮的方法。图6.4显示了带有一个工具栏的<tt>sketch</tt>窗口的一部分，这个工具栏使用了6.2.2中菜单的相应方法，以与菜单项的功能相对应。
<span id="line-524" class="anchor"/><span id="line-525" class="anchor"/></p><p class="line874">图6.4  <span id="line-526" class="anchor"/><span id="line-527" class="anchor"/></p><p class="line867"><img title="attachment:w6.4.gif" src="/moin/WxPythonInAction/ChapterSix?action=AttachFile&amp;do=get&amp;target=w6.4.gif" class="attachment"/> <span id="line-528" class="anchor"/><span id="line-529" class="anchor"/><span id="line-530" class="anchor"/></p><p class="line874">例6.5中，我们没有重复使用菜单改变画笔颜色的代码，而是使用了新的方法。 <span id="line-531"
class="anchor"/><span id="line-532" class="anchor"/><span id="line-533" class="anchor"/></p><p class="line867"><strong>例6.5</strong>  <span id="line-534" class="anchor"/><strong>添加一个工具栏到<tt>sketch</tt>应用程序</strong> <span id="line-535" class="anchor"/><span id="line-536" class="anchor"/><span id="line-537" class="anchor"/><span id="line-538" class="anchor"/><span id="line-539" class="anchor"/><span id="line-540" class="anchor"/><span id="line-541" class="anchor"/><span id="line-542" class="anchor"/><span id="line-543" class="anchor"/><span id="line-544"
class="anchor"/><span id="line-545" class="anchor"/><span id="line-546" class="anchor"/><span id="line-547" class="anchor"/><span id="line-548" class="anchor"/><span id="line-549" class="anchor"/><span id="line-550" class="anchor"/><span id="line-551" class="anchor"/><span id="line-552" class="anchor"/><span id="line-553" class="anchor"/><span id="line-554" class="anchor"/><span id="line-555" class="anchor"/><span id="line-556" class="anchor"/><span id="line-557" class="anchor"/><span id="line-558" class="anchor"/><span id="line-559" class="anchor"/><span id="line-560"
class="anchor"/><span id="line-561" class="anchor"/><span id="line-562" class="anchor"/><span id="line-563" class="anchor"/><span id="line-564" class="anchor"/><span id="line-565" class="anchor"/><span id="line-566" class="anchor"/><span id="line-567" class="anchor"/><span id="line-568" class="anchor"/><span id="line-569" class="anchor"/><span id="line-570" class="anchor"/><span id="line-571" class="anchor"/><span id="line-572" class="anchor"/><span id="line-573" class="anchor"/><span id="line-574" class="anchor"/><span id="line-575" class="anchor"/><span id="line-576"
class="anchor"/><span id="line-577" class="anchor"/><span id="line-578" class="anchor"/><span id="line-579" class="anchor"/><span id="line-580" class="anchor"/><span id="line-581" class="anchor"/><span id="line-582" class="anchor"/><span id="line-583" class="anchor"/><span id="line-584" class="anchor"/><span id="line-585" class="anchor"/><span id="line-586" class="anchor"/><span id="line-587" class="anchor"/><span id="line-588" class="anchor"/><span id="line-589" class="anchor"/><span id="line-590" class="anchor"/><span id="line-591" class="anchor"/><span id="line-592"
class="anchor"/><span id="line-593" class="anchor"/><span id="line-594" class="anchor"/><span id="line-595" class="anchor"/><span id="line-596" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-6b3d6e35320591c23c07cbd76ff8df277471cc4f_003\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-6b3d6e35320591c23c07cbd76ff8df277471cc4f_003', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-6b3d6e35320591c23c07cbd76ff8df277471cc4f_003" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Frame</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="String">"Sketch Frame"</span><span class="Operator">,</span><span
class="ID">size</span><span class="Operator">=</span><span class="Operator">(</span><span class="Number">800</span><span class="Operator">,</span><span class="Number">600</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   3 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span> <span class="Operator">=</span> <span class="ID">SketchWindow</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_MOTION</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSketchMotion</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   5 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">initStatusBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   6 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">createMenuBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   7 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">createToolBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span></span>
<span class="line"><span class="LineNumber">   9 </span><span class="ResWord">def</span> <span class="ID">createToolBar</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#1创建工具栏</span></span>
<span class="line"><span class="LineNumber">  10 </span>        <span class="ID">toolbar</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">CreateToolBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span>        <span class="ResWord">for</span> <span class="ID">each</span> <span class="ResWord">in</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">toolbarData</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  12 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">createSimpleTool</span><span class="Operator">(</span><span class="ID">toolbar</span><span class="Operator">,</span> <span class="Operator">*</span><span class="ID">each</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  13 </span>                <span class="ID">toolbar</span><span class="Operator">.</span><span class="ID">AddSeparator</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  14 </span>        <span class="ResWord">for</span> <span class="ID">each</span> <span class="ResWord">in</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">toolbarColorData</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  15 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">createColorTool</span><span class="Operator">(</span><span class="ID">toolbar</span><span class="Operator">,</span> <span class="ID">each</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  16 </span>                <span class="ID">toolbar</span><span class="Operator">.</span><span class="ID">Realize</span><span class="Operator">(</span><span class="Operator">)</span><span class="Comment">#2 显现工具栏</span></span>
<span class="line"><span class="LineNumber">  17 </span></span>
<span class="line"><span class="LineNumber">  18 </span><span class="ResWord">def</span> <span class="ID">createSimpleTool</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">toolbar</span><span class="Operator">,</span> <span class="ID">label</span><span class="Operator">,</span> <span class="ID">filename</span><span class="Operator">,</span><span class="ID">help</span><span class="Operator">,</span> <span class="ID">handler</span><span class="Operator">)</span><span
class="Operator">:</span><span class="Comment">#3 创建常规工具</span></span>
<span class="line"><span class="LineNumber">  19 </span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">label</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  20 </span>                <span class="ID">toolbar</span><span class="Operator">.</span><span class="ID">AddSeparator</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  21 </span>                <span class="ResWord">return</span></span>
<span class="line"><span class="LineNumber">  22 </span>        <span class="ID">bmp</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Image</span><span class="Operator">(</span><span class="ID">filename</span><span class="Operator">,</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">BITMAP_TYPE_BMP</span><span class="Operator">)</span><span class="Operator">.</span><span class="ID">ConvertToBitmap</span><span class="Operator">(</span><span
class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  23 </span>        <span class="ID">tool</span> <span class="Operator">=</span> <span class="ID">toolbar</span><span class="Operator">.</span><span class="ID">AddSimpleTool</span><span class="Operator">(</span><span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="ID">bmp</span><span class="Operator">,</span> <span class="ID">label</span><span class="Operator">,</span> <span class="ID">help</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  24 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_MENU</span><span class="Operator">,</span> <span class="ID">handler</span><span class="Operator">,</span> <span class="ID">tool</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  25 </span></span>
<span class="line"><span class="LineNumber">  26 </span><span class="ResWord">def</span> <span class="ID">toolbarData</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  27 </span>        <span class="ResWord">return</span> <span class="Operator">(</span><span class="Operator">(</span><span class="String">"New"</span><span class="Operator">,</span> <span class="String">"new.bmp"</span><span class="Operator">,</span> <span class="String">"Create new sketch"</span><span class="Operator">,</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">OnNew</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  28 </span>                <span class="Operator">(</span><span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  29 </span>                <span class="Operator">(</span><span class="String">"Open"</span><span class="Operator">,</span> <span class="String">"open.bmp"</span><span class="Operator">,</span> <span class="String">"Open existing sketch"</span><span class="Operator">,</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">OnOpen</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  30 </span>                <span class="Operator">(</span><span class="String">"Save"</span><span class="Operator">,</span> <span class="String">"save.bmp"</span><span class="Operator">,</span> <span class="String">"Save existing sketch"</span><span class="Operator">,</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSave</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  31 </span></span>
<span class="line"><span class="LineNumber">  32 </span><span class="ResWord">def</span> <span class="ID">createColorTool</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">toolbar</span><span class="Operator">,</span> <span class="ID">color</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#4 创建颜色工具</span></span>
<span class="line"><span class="LineNumber">  33 </span>        <span class="ID">bmp</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">MakeBitmap</span><span class="Operator">(</span><span class="ID">color</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  34 </span>        <span class="ID">newId</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">NewId</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  35 </span>        <span class="ID">tool</span> <span class="Operator">=</span> <span class="ID">toolbar</span><span class="Operator">.</span><span class="ID">AddRadioTool</span><span class="Operator">(</span><span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="ID">bmp</span><span class="Operator">,</span> <span class="ID">shortHelp</span><span class="Operator">=</span><span class="ID">color</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  36 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_MENU</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnColor</span><span class="Operator">,</span> <span class="ID">tool</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  37 </span></span>
<span class="line"><span class="LineNumber">  38 </span><span class="ResWord">def</span> <span class="ID">MakeBitmap</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">color</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#5 创建纯色的位图</span></span>
<span class="line"><span class="LineNumber">  39 </span>        <span class="ID">bmp</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">EmptyBitmap</span><span class="Operator">(</span><span class="Number">16</span><span class="Operator">,</span> <span class="Number">15</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  40 </span>        <span class="ID">dc</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">MemoryDC</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  41 </span>        <span class="ID">dc</span><span class="Operator">.</span><span class="ID">SelectObject</span><span class="Operator">(</span><span class="ID">bmp</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  42 </span>        <span class="ID">dc</span><span class="Operator">.</span><span class="ID">SetBackground</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">Brush</span><span class="Operator">(</span><span class="ID">color</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  43 </span>        <span class="ID">dc</span><span class="Operator">.</span><span class="ID">Clear</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  44 </span>        <span class="ID">dc</span><span class="Operator">.</span><span class="ID">SelectObject</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">NullBitmap</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  45 </span>        <span class="ResWord">return</span> <span class="ID">bmp</span></span>
<span class="line"><span class="LineNumber">  46 </span></span>
<span class="line"><span class="LineNumber">  47 </span><span class="ResWord">def</span> <span class="ID">toolbarColorData</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  48 </span>        <span class="ResWord">return</span> <span class="Operator">(</span><span class="String">"Black"</span><span class="Operator">,</span> <span class="String">"Red"</span><span class="Operator">,</span> <span class="String">"Green"</span><span class="Operator">,</span> <span class="String">"Blue"</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  49 </span></span>
<span class="line"><span class="LineNumber">  50 </span><span class="ResWord">def</span> <span class="ID">OnColor</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#6 改变画笔颜色以响应工具栏的敲击</span></span>
<span class="line"><span class="LineNumber">  51 </span>        <span class="ID">menubar</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">GetMenuBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  52 </span>        <span class="ID">itemId</span> <span class="Operator">=</span> <span class="ID">event</span><span class="Operator">.</span><span class="ID">GetId</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  53 </span>        <span class="ID">item</span> <span class="Operator">=</span> <span class="ID">menubar</span><span class="Operator">.</span><span class="ID">FindItemById</span><span class="Operator">(</span><span class="ID">itemId</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  54 </span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">item</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  55 </span>        <span class="ID">toolbar</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">GetToolBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  56 </span>        <span class="ID">item</span> <span class="Operator">=</span> <span class="ID">toolbar</span><span class="Operator">.</span><span class="ID">FindById</span><span class="Operator">(</span><span class="ID">itemId</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  57 </span>        <span class="ID">color</span> <span class="Operator">=</span> <span class="ID">item</span><span class="Operator">.</span><span class="ID">GetShortHelp</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  58 </span>        <span class="ResWord">else</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  59 </span>        <span class="ID">color</span> <span class="Operator">=</span> <span class="ID">item</span><span class="Operator">.</span><span class="ID">GetLabel</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  60 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">SetColor</span><span class="Operator">(</span><span class="ID">color</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-597" class="anchor"/><span id="line-598" class="anchor"/><p class="line867"><strong>#1</strong>：工具栏的代码在设置上类似于菜单代码。然而，这里，我们对常规的按钮和单选切换按钮使用了不同的循环设置。 <span id="line-599" class="anchor"/><span id="line-600" class="anchor"/><span id="line-601" class="anchor"/></p><p class="line867"><strong>#2</strong>：<tt>Realize()</tt>方法实际上是在工具栏中布局工具栏对象。它在工具栏被显示前必须被调用，如果工具栏中的添加或删除了工具，那么这个方法也必须被调用。 <span id="line-602"
class="anchor"/><span id="line-603" class="anchor"/><span id="line-604" class="anchor"/></p><p class="line867"><strong>#3</strong>：这个方法类似于菜单项的创建。主要区别是工具栏上的工具要求显示位图。这里我们使用了三个位于同一目录下基本位图。在该方法的最后，我们绑定了菜单项所使用的相同的<tt>wx.EVT_MENU</tt>事件。 <span id="line-605" class="anchor"/><span id="line-606" class="anchor"/><span id="line-607" class="anchor"/></p><p
class="line867"><strong>#4</strong>：颜色工具的创建类似于常规的工具。唯一的不同是使用了一个不同的方法去告诉工具栏它们是单选工具。纯色的位图由<tt>MakeBitmap()</tt>方法创建。 <span id="line-608" class="anchor"/><span id="line-609" class="anchor"/><span id="line-610" class="anchor"/></p><p class="line867"><strong>#5</strong>：该方法为单选工具创建纯色的位图。 <span id="line-611" class="anchor"/><span id="line-612" class="anchor"/><span id="line-613" class="anchor"/></p><p
class="line867"><strong>#6</strong>：该方法在原有的基础上添加了搜索正确的工具以具此来改变颜色。然而，所写的代码的问题是，通过菜单项使画笔颜色改变了，但是工具栏上的单选工具的状态没有相应改变，反过来也是一样。 <span id="line-614" class="anchor"/><span id="line-615" class="anchor"/></p><p class="line862">工具栏中的工具在鼠标右键敲击时能够产生<tt>wx.EVT_TOOL_RCLICKED</tt>类型事件。工具栏也有一些不同的样式，它们被作为位图参数传递给<tt>CreateToolBar()</tt>。表6.4列出了一些工具栏的样式。 <span id="line-616" class="anchor"/><span id="line-617"
class="anchor"/><span id="line-618" class="anchor"/></p><p class="line867"><strong>表6.4</strong>  <span id="line-619" class="anchor"/><strong><tt>wx.ToolBar</tt>类的样式</strong> <span id="line-620" class="anchor"/><span id="line-621" class="anchor"/></p><p class="line867"><tt>wx.TB_3DBUTTONS</tt>：3D外观 <span id="line-622" class="anchor"/><span id="line-623" class="anchor"/></p><p class="line867"><tt>wx.TB_HORIZONTAL</tt>：默认样式，工具栏水平布置 <span id="line-624" class="anchor"/><span id="line-625" class="anchor"/></p><p
class="line867"><tt>wx.TB_NOICONS</tt>：不为每个工具显示位图 <span id="line-626" class="anchor"/><span id="line-627" class="anchor"/></p><p class="line867"><tt>wx.TB_TEXT</tt>：根据不同的位图显示简短的帮助文本 <span id="line-628" class="anchor"/><span id="line-629" class="anchor"/></p><p class="line867"><tt>wx.TB_VERTICAL</tt>：垂直放置工具栏 <span id="line-630" class="anchor"/><span id="line-631" class="anchor"/></p><p class="line874">工具栏比状态栏更复杂。表6.5显示了其常用的一些方法。 <span id="line-632" class="anchor"/><span id="line-633"
class="anchor"/><span id="line-634" class="anchor"/></p><p class="line867"><strong>表6.5</strong>  <span id="line-635" class="anchor"/><strong><tt>wx.ToolBar</tt>的常用方法</strong> <span id="line-636" class="anchor"/><span id="line-637" class="anchor"/></p><p class="line867"><tt>AddControl(control)</tt>：添加一个任意的<tt>wxPython</tt>控件到工具栏。相关方法<tt>InsertControl()</tt>。 <span id="line-638" class="anchor"/><span id="line-639" class="anchor"/></p><p class="line867"><tt>AddSeparator()</tt>：在工具之间放置空格。 <span id="line-640"
class="anchor"/><span id="line-641" class="anchor"/></p><p class="line867"><tt>AddSimpleTool(id</tt>, <tt>bitmap</tt>,<tt>shortHelpString</tt>="",<tt>kind</tt>=<tt>wx.ITEM_NORMAL)</tt>：添加一个简单的带有给定位图的工具到工具栏。<tt>shortHelpString</tt>作为提示显示。<tt>kind</tt>的值可以是<tt>wx.ITEM_NORMAL</tt>, <tt>wx.ITEM_CHECKBOX</tt>, 或<tt>wx.ITEM_RADIO</tt>。 <span id="line-642" class="anchor"/><span id="line-643" class="anchor"/></p><p class="line867"><tt>AddTool(id</tt>,
<tt>bitmap</tt>,<tt>bitmap2</tt>=<tt>wx.NullBitmap</tt>,<tt>kind</tt>=<tt>wx.ITEM_NORMAL</tt>,<tt>shortHelpString</tt>="",<tt>longHelpString</tt>="", <span id="line-644" class="anchor"/><tt>clientData</tt>=<tt>None)</tt>：简单工具的其它参数。<tt>bitmap2</tt>是当该工具被按下时所显示的位图。<tt>longHelpString</tt>是当指针位于该工具中时显示在状态栏中的帮助字符串。<tt>clientData</tt>用于将任意的一块数据与工具相联系起来。相关方法<tt>InsertTool()</tt>。 <span id="line-645" class="anchor"/><span id="line-646" class="anchor"/></p><p
class="line867"><tt>AddCheckTool(...)</tt>：添加一个复选框切换工具，所要求参数同<tt>AddTool()</tt>。 <span id="line-647" class="anchor"/><span id="line-648" class="anchor"/></p><p class="line867"><tt>AddRadioTool(...)</tt>：添加一个单选切换工具，所要求参数同<tt>AddTool()</tt>。对于连续的未分隔的单选工具被视为一组。 <span id="line-649" class="anchor"/><span id="line-650" class="anchor"/></p><p class="line867"><tt>DeleteTool(toolId)</tt> <span id="line-651" class="anchor"/><tt>DeleteToolByPosition(x</tt>,
<tt>y)</tt>：删除所给定的<tt>id</tt>的工具，或删除给定显示位置的工具。 <span id="line-652" class="anchor"/><span id="line-653" class="anchor"/></p><p class="line867"><tt>FindControl(toolId)</tt> <span id="line-654" class="anchor"/><tt>FindToolForPosition(x</tt>, <tt>y)</tt>：查找并返回给定<tt>id</tt>或显示位置的工具。 <span id="line-655" class="anchor"/><span id="line-656" class="anchor"/></p><p class="line867"><tt>ToggleTool(toolId</tt>, <tt>toggle)</tt>：根据布尔什<tt>toggle</tt>来设置给定<tt>id</tt>的工具的状态。 <span id="line-657"
class="anchor"/><span id="line-658" class="anchor"/></p><p class="line874">下一节，我们将给你展示如何使用通用对话框来得到用户的信息。 <span id="line-659" class="anchor"/><span id="line-660" class="anchor"/><span id="line-661" class="anchor"/><span id="line-662" class="anchor"/></p><p class="line867">
</p><h2 id="head-2fd6e8713057e909471ca9a3ab7abde364b35647">1.3. 得到标准信息</h2>
<span id="line-663" class="anchor"/><span id="line-664" class="anchor"/><span id="line-665" class="anchor"/><p class="line874">你的应用程序经常需要从用户那里得到基本的信息，这通常通过对话框。在这一节，我们将讨论针对标准用户信息的标准文件和颜色对话框。 <span id="line-666" class="anchor"/><span id="line-667" class="anchor"/><span id="line-668" class="anchor"/></p><p class="line867">
</p><h3 id="head-f3ef70168fc08d5c7cb60a727ee6ba59d5447a33">1.3.1. 如何使用标准文件对话框？</h3>
<span id="line-669" class="anchor"/><span id="line-670" class="anchor"/><span id="line-671" class="anchor"/><p class="line862">大部分的<tt>GUI</tt>应用程序都要保存和载入这样那样的数据。考虑到你和你的用户，应该有一个简单的，方便的机制来选择文件。很高兴，为此<tt>wxPython</tt>提供了标准的文件对话框<tt>wx.FileDialog</tt>。图6.5显示了这个用于<tt>sketch</tt>程序的文件对话框。 <span id="line-672" class="anchor"/><span id="line-673" class="anchor"/><span id="line-674" class="anchor"/></p><p class="line867"><img title="attachment:w6.5.gif"
src="/moin/WxPythonInAction/ChapterSix?action=AttachFile&amp;do=get&amp;target=w6.5.gif" class="attachment"/> <span id="line-675" class="anchor"/><span id="line-676" class="anchor"/><span id="line-677" class="anchor"/></p><p class="line867"><tt>wx.FileDialog</tt>最重要的方法是它的构造器，语法如下： <span id="line-678" class="anchor"/><span id="line-679" class="anchor"/></p><p class="line867"><tt>wx.FileDialog(parent</tt>, <tt>message</tt>="<tt>Choose</tt> a <tt>file</tt>", <tt>defaultDir</tt>="", <span id="line-680"
class="anchor"/><tt>defaultFile</tt>="", <tt>wildcard</tt>="*.*", <tt>style</tt>=0) <span id="line-681" class="anchor"/><span id="line-682" class="anchor"/></p><p class="line874">表6.6对构造器的参数进行了说明。 <span id="line-683" class="anchor"/><span id="line-684" class="anchor"/><span id="line-685" class="anchor"/></p><p class="line867"><strong>表6.6</strong>  <span id="line-686" class="anchor"/><strong><tt>wx.FileDialog</tt>构造器的参数</strong> <span id="line-687" class="anchor"/><span id="line-688" class="anchor"/></p><p
class="line867"><tt>parent</tt>：对话框的父窗口。如果没有父窗口则为<tt>None</tt>。 <span id="line-689" class="anchor"/><span id="line-690" class="anchor"/></p><p class="line867"><tt>message</tt>：<tt>message</tt>显示在对话框的标题栏中。 <span id="line-691" class="anchor"/><span id="line-692" class="anchor"/></p><p class="line867"><tt>defaultDir</tt>：当对话框打开时，默认的目录。如果为空，则为当前工作目录。 <span id="line-693" class="anchor"/><span id="line-694" class="anchor"/></p><p
class="line867"><tt>defaultFile</tt>：当对话框打开时，默认选择的文件。如果为空，则没有文件被选择。 <span id="line-695" class="anchor"/><span id="line-696" class="anchor"/></p><p class="line867"><tt>wildcard</tt>：通配符。指定要选择的文件类型。格式是 <tt>display</tt> | <tt>wildcard</tt> 。可以指定多种类型的文件，例如：“<tt>Sketch</tt> <tt>files</tt> (*.<tt>sketch)</tt>|*.<tt>sketch</tt>|<tt>All</tt> <tt>files</tt> <span id="line-697" class="anchor"/>(*.*)|*.*”。 <span id="line-698" class="anchor"/><span id="line-699" class="anchor"/></p><p
class="line867"><tt>style</tt>：样式。见下表6.7。 <span id="line-700" class="anchor"/><span id="line-701" class="anchor"/><span id="line-702" class="anchor"/></p><p class="line867"><strong>表6.7</strong>  <span id="line-703" class="anchor"/><strong><tt>wx.FileDialog</tt>的样式</strong> <span id="line-704" class="anchor"/><span id="line-705" class="anchor"/></p><p class="line867"><tt>wx.CHANGE_DIR</tt>：在用户选择了一个文件之后，当前工作目录相应改变到所选文件所在的目录。 <span id="line-706" class="anchor"/><span id="line-707" class="anchor"/></p><p
class="line867"><tt>wx.MULTIPLE</tt>：仅适用于打开对话框。这个样式使得用户可以选择多个文件。 <span id="line-708" class="anchor"/><span id="line-709" class="anchor"/></p><p class="line867"><tt>wx.OPEN</tt>：这个样式用于打开一个文件。 <span id="line-710" class="anchor"/><span id="line-711" class="anchor"/></p><p class="line867"><tt>wx.OVERWRITE_PROMPT</tt>：仅适用于保存文件对话框。显示一个提示信息以确认是否覆盖一个已存在的文件。 <span id="line-712" class="anchor"/><span id="line-713" class="anchor"/></p><p
class="line867"><tt>wx.SAVE</tt>：这个样式用于保存一个文件。 <span id="line-714" class="anchor"/><span id="line-715" class="anchor"/></p><p class="line862">要使用文件对话框，要对一个对话框实例调用<tt>ShowModal()</tt>方法。这个方法根据用户所敲击的对话框上的按钮来返回<tt>wx.ID_OK</tt>或<tt>wx.ID_CANCEL</tt>。选择之后。使用<tt>GetFilename()</tt>, <tt>GetDirectory()</tt>, 或<tt>GetPath()</tt>方法来获取数据。之后，调用<tt>Destroy()</tt>销毁对话框是一个好的观念。 <span id="line-716" class="anchor"/><span id="line-717" class="anchor"/></p><p
class="line862">下例6.6显了对<tt>SketchFrame</tt>所作的修改以提供保存和装载（完整的附书源码请到论坛的"相关资源"的"教程下载"中下载）。这些改变要求导入<tt>cPickle</tt>和<tt>os</tt>模块。我们使用<tt>cPickle</tt>来将数据的列表转换为可用于文件读写的数据格式。 <span id="line-718" class="anchor"/><span id="line-719" class="anchor"/><span id="line-720" class="anchor"/></p><p class="line867"><strong>例6.6</strong>  <span id="line-721" class="anchor"/><strong><tt>SketchFrame</tt>的保存和装载方法</strong> <span id="line-722" class="anchor"/><span id="line-723"
class="anchor"/><span id="line-724" class="anchor"/><span id="line-725" class="anchor"/><span id="line-726" class="anchor"/><span id="line-727" class="anchor"/><span id="line-728" class="anchor"/><span id="line-729" class="anchor"/><span id="line-730" class="anchor"/><span id="line-731" class="anchor"/><span id="line-732" class="anchor"/><span id="line-733" class="anchor"/><span id="line-734" class="anchor"/><span id="line-735" class="anchor"/><span id="line-736" class="anchor"/><span id="line-737" class="anchor"/><span id="line-738"
class="anchor"/><span id="line-739" class="anchor"/><span id="line-740" class="anchor"/><span id="line-741" class="anchor"/><span id="line-742" class="anchor"/><span id="line-743" class="anchor"/><span id="line-744" class="anchor"/><span id="line-745" class="anchor"/><span id="line-746" class="anchor"/><span id="line-747" class="anchor"/><span id="line-748" class="anchor"/><span id="line-749" class="anchor"/><span id="line-750" class="anchor"/><span id="line-751" class="anchor"/><span id="line-752" class="anchor"/><span id="line-753"
class="anchor"/><span id="line-754" class="anchor"/><span id="line-755" class="anchor"/><span id="line-756" class="anchor"/><span id="line-757" class="anchor"/><span id="line-758" class="anchor"/><span id="line-759" class="anchor"/><span id="line-760" class="anchor"/><span id="line-761" class="anchor"/><span id="line-762" class="anchor"/><span id="line-763" class="anchor"/><span id="line-764" class="anchor"/><span id="line-765" class="anchor"/><span id="line-766" class="anchor"/><span id="line-767" class="anchor"/><span id="line-768"
class="anchor"/><span id="line-769" class="anchor"/><span id="line-770" class="anchor"/><span id="line-771" class="anchor"/><span id="line-772" class="anchor"/><span id="line-773" class="anchor"/><span id="line-774" class="anchor"/><span id="line-775" class="anchor"/><span id="line-776" class="anchor"/><span id="line-777" class="anchor"/><span id="line-778" class="anchor"/><span id="line-779" class="anchor"/><span id="line-780" class="anchor"/><span id="line-781" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-c619426922bf521b070138f474bc6c0f26f3db77_004\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-c619426922bf521b070138f474bc6c0f26f3db77_004', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-c619426922bf521b070138f474bc6c0f26f3db77_004" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">title</span> <span class="Operator">=</span> <span class="String">"Sketch Frame"</span></span>
<span class="line"><span class="LineNumber">   3 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Frame</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span
class="ID">title</span><span class="Operator">,</span><span class="ID">size</span><span class="Operator">=</span><span class="Operator">(</span><span class="Number">800</span><span class="Operator">,</span><span class="Number">600</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span> <span class="Operator">=</span> <span class="String">""</span></span>
<span class="line"><span class="LineNumber">   5 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span> <span class="Operator">=</span> <span class="ID">SketchWindow</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   6 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_MOTION</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSketchMotion</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   7 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">initStatusBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">createMenuBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   9 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">createToolBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  10 </span></span>
<span class="line"><span class="LineNumber">  11 </span><span class="ResWord">def</span> <span class="ID">SaveFile</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#1 保存文件</span></span>
<span class="line"><span class="LineNumber">  12 </span>        <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  13 </span>                <span class="ID">data</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">GetLinesData</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  14 </span>                <span class="ID">f</span> <span class="Operator">=</span> <span class="ID">open</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span><span class="Operator">,</span> <span class="String">'w'</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  15 </span>                <span class="ID">cPickle</span><span class="Operator">.</span><span class="ID">dump</span><span class="Operator">(</span><span class="ID">data</span><span class="Operator">,</span> <span class="ID">f</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  16 </span>                <span class="ID">f</span><span class="Operator">.</span><span class="ID">close</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  17 </span></span>
<span class="line"><span class="LineNumber">  18 </span><span class="ResWord">def</span> <span class="ID">ReadFile</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#2 读文件</span></span>
<span class="line"><span class="LineNumber">  19 </span>        <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  20 </span>                <span class="ResWord">try</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  21 </span>                        <span class="ID">f</span> <span class="Operator">=</span> <span class="ID">open</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span><span class="Operator">,</span> <span class="String">'r'</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  22 </span>                        <span class="ID">data</span> <span class="Operator">=</span> <span class="ID">cPickle</span><span class="Operator">.</span><span class="ID">load</span><span class="Operator">(</span><span class="ID">f</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  23 </span>                        <span class="ID">f</span><span class="Operator">.</span><span class="ID">close</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  24 </span>                        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">SetLinesData</span><span class="Operator">(</span><span class="ID">data</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  25 </span>                <span class="ResWord">except</span> <span class="ID">cPickle</span><span class="Operator">.</span><span class="ID">UnpicklingError</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  26 </span>                        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">MessageBox</span><span class="Operator">(</span><span class="String">"%s is not a sketch file."</span> <span class="Operator">%</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span><span class="Operator">,</span> <span class="String">"oops!"</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  27 </span>                        <span class="ID">style</span><span class="Operator">=</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">OK</span><span class="Operator">|</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">ICON_EXCLAMATION</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  28 </span></span>
<span class="line"><span class="LineNumber">  29 </span>        <span class="ID">wildcard</span> <span class="Operator">=</span> <span class="String">"Sketch files (*.sketch)|*.sketch|All files (*.*)|*.*"</span></span>
<span class="line"><span class="LineNumber">  30 </span></span>
<span class="line"><span class="LineNumber">  31 </span><span class="ResWord">def</span> <span class="ID">OnOpen</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#3 弹出打开对话框</span></span>
<span class="line"><span class="LineNumber">  32 </span>        <span class="ID">dlg</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">FileDialog</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="String">"Open sketch file..."</span><span class="Operator">,</span><span class="ID">os</span><span class="Operator">.</span><span class="ID">getcwd</span><span class="Operator">(</span><span class="Operator">)</span><span
class="Operator">,</span> <span class="ID">style</span><span class="Operator">=</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">OPEN</span><span class="Operator">,</span><span class="ID">wildcard</span><span class="Operator">=</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">wildcard</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  33 </span>        <span class="ResWord">if</span> <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">ShowModal</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">==</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ID_OK</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  34 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span> <span class="Operator">=</span> <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">GetPath</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  35 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">ReadFile</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  36 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">SetTitle</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">title</span> <span class="Operator">+</span> <span class="String">' -- '</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  37 </span>                <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">Destroy</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  38 </span></span>
<span class="line"><span class="LineNumber">  39 </span><span class="ResWord">def</span> <span class="ID">OnSave</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#4 保存文件</span></span>
<span class="line"><span class="LineNumber">  40 </span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  41 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSaveAs</span><span class="Operator">(</span><span class="ID">event</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  42 </span>        <span class="ResWord">else</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  43 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">SaveFile</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  44 </span></span>
<span class="line"><span class="LineNumber">  45 </span><span class="ResWord">def</span> <span class="ID">OnSaveAs</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#5 弹出保存对话框</span></span>
<span class="line"><span class="LineNumber">  46 </span>        <span class="ID">dlg</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">FileDialog</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="String">"Save sketch as..."</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  47 </span>        <span class="ID">os</span><span class="Operator">.</span><span class="ID">getcwd</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  48 </span>        <span class="ID">style</span><span class="Operator">=</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">SAVE</span> <span class="Operator">|</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">OVERWRITE_PROMPT</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  49 </span>        <span class="ID">wildcard</span><span class="Operator">=</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">wildcard</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  50 </span>        <span class="ResWord">if</span> <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">ShowModal</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">==</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ID_OK</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  51 </span>                <span class="ID">filename</span> <span class="Operator">=</span> <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">GetPath</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  52 </span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">os</span><span class="Operator">.</span><span class="ID">path</span><span class="Operator">.</span><span class="ID">splitext</span><span class="Operator">(</span><span class="ID">filename</span><span class="Operator">)</span><span class="Operator">[</span><span class="Number">1</span><span class="Operator">]</span><span class="Operator">:</span><span class="Comment">#6
确保文件名后缀</span></span>
<span class="line"><span class="LineNumber">  53 </span>                <span class="ID">filename</span> <span class="Operator">=</span> <span class="ID">filename</span> <span class="Operator">+</span> <span class="String">'.sketch'</span></span>
<span class="line"><span class="LineNumber">  54 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span> <span class="Operator">=</span> <span class="ID">filename</span></span>
<span class="line"><span class="LineNumber">  55 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">SaveFile</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  56 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">SetTitle</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">title</span> <span class="Operator">+</span> <span class="String">' -- '</span> <span class="Operator">+</span></span>
<span class="line"><span class="LineNumber">  57 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  58 </span>        <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">Destroy</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-782" class="anchor"/><span id="line-783" class="anchor"/><p class="line867"><strong>#1</strong>：该方法写文件数据到磁盘中，给定了文件名，使用了<tt>cPickle</tt>模块。 <span id="line-784" class="anchor"/><span id="line-785" class="anchor"/><span id="line-786" class="anchor"/></p><p class="line867"><strong>#2</strong>：该方法使用<tt>cPickle</tt>来读文件。如果文件不是期望的类型，则弹出一个消息框来警告。 <span id="line-787" class="anchor"/><span id="line-788" class="anchor"/><span id="line-789"
class="anchor"/></p><p class="line867"><strong>#3</strong>：<tt>OnOpen()</tt>方法使用<tt>wx.OPEN</tt>样式来创建一个对话框。通配符让用户可以限定选择.<tt>sketch</tt>文件。如果用户敲击<tt>OK</tt>，那么该方法根据所选择的路径调用<tt>ReadFile()</tt>方法。 <span id="line-790" class="anchor"/><span id="line-791" class="anchor"/><span id="line-792" class="anchor"/></p><p class="line867"><strong>#4</strong>：如果已经选择了用于保存当前数据的文件名，那么保存文件，否则，我们打开保存对话框。 <span id="line-793" class="anchor"/><span id="line-794"
class="anchor"/><span id="line-795" class="anchor"/></p><p class="line867"><strong>#5</strong>：<tt>OnSave()</tt>方法创建一个<tt>wx.SAVE</tt>文件对话框。 <span id="line-796" class="anchor"/><span id="line-797" class="anchor"/><span id="line-798" class="anchor"/></p><p class="line867"><strong>#6</strong>：这行确保文件名后缀为.<tt>sketch</tt>。 <span id="line-799" class="anchor"/><span id="line-800" class="anchor"/></p><p class="line874">下一节，我们将讨论如何使用文件选择器。 <span id="line-801" class="anchor"/><span id="line-802"
class="anchor"/><span id="line-803" class="anchor"/></p><p class="line867">
</p><h3 id="head-ff4ca0e787be7581f9bda3547d63e62f30a525fd">1.3.2. 如何使用标准的颜色选择器？</h3>
<span id="line-804" class="anchor"/><span id="line-805" class="anchor"/><span id="line-806" class="anchor"/><p
class="line862">如果用户能够在<tt>sketch</tt>对话框中选择任意的颜色，那么这将是有用。对于这个目的，我们可以使用<tt>wxPython</tt>提供的标准<tt>wx.ColourDialog</tt>。这个对话框的用法类似于文件对话框。它的构造器只需要一个<tt>parent(</tt>双亲)和一个可选的数据属性参数。数据属性是一个<tt>wx.ColourData</tt>的实例，它存储与该对话框相关的一些数据，如用户选择的颜色，还有自定义的颜色的列表。使用数据属性使你能够在以后的应用中保持自定义颜色的一致性。 <span id="line-807" class="anchor"/><span id="line-808" class="anchor"/></p><p
class="line862">在<tt>sketch</tt>应用程序中使用颜色对话框，要求增加一个菜单项和一个处理器方法。例6.7显示了所增加的代码。 <span id="line-809" class="anchor"/><span id="line-810" class="anchor"/><span id="line-811" class="anchor"/></p><p class="line867"><strong>例6.7</strong>  <span id="line-812" class="anchor"/><strong>对<tt>SketchFrame</tt>做一些改变，以显示颜色对话框</strong> <span id="line-813" class="anchor"/><span id="line-814" class="anchor"/><span id="line-815" class="anchor"/><span id="line-816" class="anchor"/><span id="line-817"
class="anchor"/><span id="line-818" class="anchor"/><span id="line-819" class="anchor"/><span id="line-820" class="anchor"/><span id="line-821" class="anchor"/><span id="line-822" class="anchor"/><span id="line-823" class="anchor"/><span id="line-824" class="anchor"/><span id="line-825" class="anchor"/><span id="line-826" class="anchor"/><span id="line-827" class="anchor"/><span id="line-828" class="anchor"/><span id="line-829" class="anchor"/><span id="line-830" class="anchor"/><span id="line-831" class="anchor"/><span id="line-832"
class="anchor"/><span id="line-833" class="anchor"/><span id="line-834" class="anchor"/><span id="line-835" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-daa6bcf91c0656b893eabc9228ca933d40507650_005\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-daa6bcf91c0656b893eabc9228ca933d40507650_005', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-daa6bcf91c0656b893eabc9228ca933d40507650_005" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">def</span> <span class="ID">menuData</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>        <span class="ResWord">return</span> <span class="Operator">[</span><span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="Operator">(</span></span>
<span class="line"><span class="LineNumber">   3 </span>                <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">"New Sketch file"</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnNew</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   4 </span>                <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">"Open sketch file"</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnOpen</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   5 </span>                <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">"Save sketch file"</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSave</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   6 </span>                <span class="Operator">(</span><span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   7 </span>                <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="Operator">(</span></span>
<span class="line"><span class="LineNumber">   8 </span>                <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnColor</span><span class="Operator">,</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">ITEM_RADIO</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   9 </span>                <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnColor</span><span class="Operator">,</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">ITEM_RADIO</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  10 </span>                <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnColor</span><span class="Operator">,</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">ITEM_RADIO</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  11 </span>                <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnColor</span><span class="Operator">,</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">ITEM_RADIO</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  12 </span>                <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnOtherColor</span><span class="Operator">,</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">ITEM_RADIO</span><span class="Operator">)</span><span class="Operator">)</span><span
class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  13 </span>                <span class="Operator">(</span><span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">,</span> <span class="String">""</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  14 </span>                <span class="Operator">(</span><span class="String">" "</span><span class="Operator">,</span> <span class="String">"Quit"</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnCloseWindow</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  15 </span></span>
<span class="line"><span class="LineNumber">  16 </span><span class="ResWord">def</span> <span class="ID">OnOtherColor</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  17 </span>        <span class="ID">dlg</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ColourDialog</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  18 </span>        <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">GetColourData</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">.</span><span class="ID">SetChooseFull</span><span class="Operator">(</span><span class="ID">True</span><span class="Operator">)</span><span class="Comment"># 创建颜色数据对象</span></span>
<span class="line"><span class="LineNumber">  19 </span>        <span class="ResWord">if</span> <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">ShowModal</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">==</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ID_OK</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  20 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">SetColor</span><span class="Operator">(</span><span class="ID">dlg</span><span class="Operator">.</span><span class="ID">GetColourData</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">.</span><span class="ID">GetColour</span><span class="Operator">(</span><span
class="Operator">)</span><span class="Operator">)</span><span class="Comment"># 根据用户的输入设置颜色</span></span>
<span class="line"><span class="LineNumber">  21 </span>        <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">Destroy</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-836" class="anchor"/><span id="line-837" class="anchor"/><p class="line862">颜色数据实例的<tt>SetChooseFull()</tt>方法告诉对话框去显示整个调色板，其中包括了自定义的颜色信息。对话框关闭后，我们根据得到的颜色来拾取颜色数据。颜色数据作为一个<tt>wx.Color</tt>的实例返回并传递给<tt>sketch</tt>程序来设置颜色。 <span id="line-838" class="anchor"/><span id="line-839" class="anchor"/><span id="line-840" class="anchor"/></p><p class="line867">
</p><h2 id="head-b61bae071dfa0a00f0b89a92ba2c31220f128e0a">1.4. 给应用程序一个好看的外观</h2>
<span id="line-841" class="anchor"/><span id="line-842" class="anchor"/><span id="line-843" class="anchor"/><p class="line862">在这一节中，我们将讨论如何让你的程序有一个好的外观。从重要性来说，储如你如何作安排以便用户调整窗口的大小，从细节来说，储如你如何显示一个<tt>about</tt>框。在本书的第二部分，我们将更详细地对这些主题进行进一步的讨论。 <span id="line-844" class="anchor"/><span id="line-845" class="anchor"/><span id="line-846" class="anchor"/></p><p class="line867">
</p><h3 id="head-270ac61b4f28930e55c2bc47e5461d8fc043f7bf">1.4.1. 如何布局窗口部件？</h3>
<span id="line-847" class="anchor"/><span id="line-848" class="anchor"/><span id="line-849" class="anchor"/><p class="line862">在你的<tt>wxPython</tt>应用程序中布局你的窗口部件的方法之一是，在每个窗口部件被创建时显式地指定它的位置和大小。虽然这个方法相当地简单，但是它一直存在几个缺点。其中之一就是，因为窗口部件的尺寸和默认字体的尺寸不同，对于在所有系统上要得到一个正确的定位是非常困难的。另外，每当用户调整父窗口的大小时，你必须显式地改变每个窗口部件的定位，要正确地实现它是十分痛苦的。 <span id="line-850"
class="anchor"/><span id="line-851" class="anchor"/></p><p class="line862">幸运的是，这儿有一个更好的方法。在<tt>wxPython</tt>中的布局机制是一个被称为<tt>sizer</tt>的东西，它类似于<tt>Java</tt> <tt>AWT</tt>和其它的界面工具包中的布局管理器。每个不同的<tt>sizer</tt>基于一套规则管理它的窗口的尺寸和位置。<tt>sizer</tt>属于一个容器窗口（比如<tt>wx.Panel</tt>）。在父中创建的子窗口必须被添加给<tt>sizer</tt>，<tt>sizer</tt>管理每个窗口部件的尺寸和位置。 <span id="line-852" class="anchor"/><span id="line-853" class="anchor"/><span
id="line-854" class="anchor"/></p><p class="line867"><strong>创建一个<tt>sizer</tt></strong> <span id="line-855" class="anchor"/><span id="line-856" class="anchor"/></p><p class="line862">创建一个<tt>sizer</tt>的步骤： <span id="line-857" class="anchor"/><span id="line-858" class="anchor"/></p><p class="line862">1、创建你想用来自动调用尺寸的<tt>panel</tt>或<tt>container(</tt>容器)。 <span id="line-859" class="anchor"/>2、创建<tt>sizer</tt>。 <span id="line-860" class="anchor"/>3、创建你的子窗口。 <span id="line-861"
class="anchor"/>4、使用<tt>sizer</tt>的<tt>Add()</tt>方法来将每个子窗口添加给<tt>sizer</tt>。当你添加窗口时，给了<tt>sizer</tt>附加的信息，这包括窗口周围空间的度量、在由<tt>sizer</tt>所管理分配的空间中如何对齐窗口、当容器窗口改变大小时如何扩展子窗口等。 <span id="line-862" class="anchor"/>5、<tt>sizer</tt>可以嵌套，这意味你可以像窗口对象一样添加别的<tt>sizer</tt>到父<tt>sizer</tt>。你也可以预留一定数量的空间作为分隔。 <span id="line-863" class="anchor"/>6、调用容器的<tt>SetSizer(sizer)</tt>方法。 <span id="line-864"
class="anchor"/><span id="line-865" class="anchor"/></p><p class="line862">表6.8列出了在<tt>wxPython</tt>中有效的最常用的<tt>sizer</tt>。对于每个专门的<tt>sizer</tt>的更完整的说明见第11章。 <span id="line-866" class="anchor"/><span id="line-867" class="anchor"/><span id="line-868" class="anchor"/></p><p class="line867"><strong>表6.8</strong>  <span id="line-869" class="anchor"/><strong>最常用的<tt>wxPython</tt>的<tt>sizer</tt></strong> <span id="line-870" class="anchor"/><span id="line-871" class="anchor"/></p><p
class="line867"><tt>wx.BoxSizer</tt>：在一条线上布局子窗口部件。<tt>wx.BoxSizer</tt>的布局方向可以是水平或坚直的，并且可以在水平或坚直方向上包含子<tt>sizer</tt>以创建复杂的布局。在项目被添加时传递给<tt>sizer</tt>的参数控制子窗口部件如何根据<tt>box</tt>的主体或垂直轴线作相应的尺寸调整。 <span id="line-872" class="anchor"/><span id="line-873" class="anchor"/></p><p class="line867"><tt>wx.FlexGridSizer</tt>：一个固定的二维网格，它与<tt>wx.GridSizer</tt>的区别是，行和列根据所在行或列的最大元素分别被设置。 <span id="line-874"
class="anchor"/><span id="line-875" class="anchor"/></p><p class="line867"><tt>wx.GridSizer</tt>：一个固定的二维网格，其中的每个元素都有相同的尺寸。当创建一个<tt>grid</tt> <tt>sizer</tt>时，你要么固定行的数量，要么固定列的数量。项目被从左到右的添加，直到一行被填满，然后从下一行开始。 <span id="line-876" class="anchor"/><span id="line-877" class="anchor"/></p><p class="line867"><tt>wx.GridBagSizer</tt>：一个固定的二维网格，基于<tt>wx.FlexGridSizer</tt>。允许项目被放置在网格上的特定点，也允许项目跨越多和网格区域。 <span
id="line-878" class="anchor"/><span id="line-879" class="anchor"/></p><p class="line867"><tt>wx.StaticBoxSizer</tt>：等同于<tt>wx.BoxSizer</tt>，只是在<tt>box</tt>周围多了一个附加的边框（有一个可选的标签）。 <span id="line-880" class="anchor"/><span id="line-881" class="anchor"/><span id="line-882" class="anchor"/></p><p class="line867"><strong>使用<tt>sizer</tt></strong> <span id="line-883" class="anchor"/><span id="line-884" class="anchor"/></p><p
class="line862">为了演示<tt>sizer</tt>的用法，我们将给<tt>sketch</tt>应用程序增加一个<tt>control</tt> <tt>panel</tt>。<tt>control</tt> <tt>panel</tt>包含用来设置线条颜色和粗细的按钮。这个例子使用了<tt>wx.GridSizer</tt>（用于按钮）和<tt>wx.BoxSizer</tt>（用于其余的布局部分）。图6.6显示了使用了<tt>panel</tt>的<tt>sketch</tt>应用程序，并图解了<tt>grid</tt>和<tt>box</tt>的实际布局。 <span id="line-885" class="anchor"/><span id="line-886" class="anchor"/><span id="line-887" class="anchor"/></p><p class="line867"><img
title="attachment:w6.6.gif" src="/moin/WxPythonInAction/ChapterSix?action=AttachFile&amp;do=get&amp;target=w6.6.gif" class="attachment"/> <span id="line-888" class="anchor"/><span id="line-889" class="anchor"/><span id="line-890" class="anchor"/></p><p class="line862">例6.8显示了实现<tt>control</tt> <tt>panel</tt>而对<tt>sketch</tt>程序所作的必要的改变。在这一节，我们的讨论将着重于<tt>sizer</tt>的实现。 <span id="line-891" class="anchor"/><span id="line-892" class="anchor"/><span id="line-893" class="anchor"/></p><p
class="line867"><strong>例6.8</strong> <span id="line-894" class="anchor"/><span id="line-895" class="anchor"/><span id="line-896" class="anchor"/><span id="line-897" class="anchor"/><span id="line-898" class="anchor"/><span id="line-899" class="anchor"/><span id="line-900" class="anchor"/><span id="line-901" class="anchor"/><span id="line-902" class="anchor"/><span id="line-903" class="anchor"/><span id="line-904" class="anchor"/><span id="line-905" class="anchor"/><span id="line-906" class="anchor"/><span id="line-907"
class="anchor"/><span id="line-908" class="anchor"/><span id="line-909" class="anchor"/><span id="line-910" class="anchor"/><span id="line-911" class="anchor"/><span id="line-912" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-83de35a25ae5a36c7e811e0f0ed1ce741b0c62f8_006\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-83de35a25ae5a36c7e811e0f0ed1ce741b0c62f8_006', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-83de35a25ae5a36c7e811e0f0ed1ce741b0c62f8_006" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">title</span> <span class="Operator">=</span> <span class="String">"Sketch Frame"</span></span>
<span class="line"><span class="LineNumber">   3 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Frame</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="ID">self</span><span
class="Operator">.</span><span class="ID">title</span><span class="Operator">,</span> <span class="ID">size</span><span class="Operator">=</span><span class="Operator">(</span><span class="Number">800</span><span class="Operator">,</span><span class="Number">600</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">filename</span> <span class="Operator">=</span> <span class="String">""</span></span>
<span class="line"><span class="LineNumber">   5 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span> <span class="Operator">=</span> <span class="ID">SketchWindow</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   6 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_MOTION</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSketchMotion</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   7 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">initStatusBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">createMenuBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   9 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">createToolBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  10 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">createPanel</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span></span>
<span class="line"><span class="LineNumber">  12 </span><span class="ResWord">def</span> <span class="ID">createPanel</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  13 </span>        <span class="ID">controlPanel</span> <span class="Operator">=</span> <span class="ID">ControlPanel</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  14 </span>        <span class="ID">box</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">BoxSizer</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">HORIZONTAL</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  15 </span>        <span class="ID">box</span><span class="Operator">.</span><span class="ID">Add</span><span class="Operator">(</span><span class="ID">controlPanel</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">EXPAND</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  16 </span>        <span class="ID">box</span><span class="Operator">.</span><span class="ID">Add</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">EXPAND</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  17 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">SetSizer</span><span class="Operator">(</span><span class="ID">box</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-913" class="anchor"/><p class="line862">在例6.8中，<tt>createPanel()</tt>方法创建了<tt>ControlPanel</tt>（在下面的列表中说明）的实例，并且与<tt>box</tt>
<tt>sizer</tt>放在一起。<tt>wx.BoxSizer</tt>的构造器的唯一参数是方向，取值可以是<tt>wx.HORIZONTAL</tt>或<tt>wx.VERTICAL</tt>。接下来，这个新的<tt>controlPanel</tt>和先前创建的<tt>SketchWindow</tt>被使用<tt>Add()</tt>方法添加给了<tt>sizer</tt>。第一个参数是要被添加给<tt>sizer</tt>的对象。第二个参数是被<tt>wx.BoxSizer</tt>用作因数去决定当<tt>sizer</tt>的大小改变时，<tt>sizer</tt>应该如何调整它的孩子的尺寸。我们这里使用的是水平方向调整的<tt>sizer</tt>，<tt>stretch</tt>因数决定每个孩子的水平尺寸如何改变（坚直方向的改变由<tt>box</tt>
<tt>sizer</tt>基于第三个参数来决定）。 <span id="line-914" class="anchor"/><span id="line-915" class="anchor"/></p><p
class="line862">如果第二个参数（<tt>stretch</tt>因数）是0，对象将不改变尺寸，无论<tt>sizer</tt>如何变化。如果第二个参数大于0，则<tt>sizer</tt>中的孩子根据因数分割<tt>sizer</tt>的总尺寸（类似于<tt>wx.StatusBar</tt>管理文本域的宽度的做法）。如果<tt>sizer</tt>中的所有孩子有相同的因数，那么它们按相同的比例分享放置了固定尺寸的元素后剩下的空间。这里的0表示假如用户伸展框架时，<tt>controlPanel</tt>不改变水平的尺寸，而1表示绘画窗口（<tt>sketch</tt> <tt>window</tt>）的尺寸要随框架的改变而改变。 <span id="line-916"
class="anchor"/><span id="line-917" class="anchor"/></p><p class="line867"><tt>Add()</tt>的第三个参数是另一个位掩码标志。完整的说明将在以后的章节中给出。<tt>wx.EXPAND</tt>指示<tt>sizer</tt>调整孩子的大小以完全填满有效的空间。其它的可能的选项允许孩子被按比例的调整尺寸或根据<tt>sizer</tt>的特定部分对齐。图6.7将帮助阐明参数及其控制的调整尺寸的方向。 <span id="line-918" class="anchor"/><span id="line-919" class="anchor"/></p><p class="line862">这些设置的结果是当你运行这个带有<tt>box</tt>
<tt>sizer</tt>的框架的时候，任何在水平方向的改变都将导致<tt>sketch</tt> <tt>window</tt>的尺寸在该方向?系母谋洌瑊{{control}}} <tt>panel</tt>不会在该方向上改变。在坚直方向的尺寸改变导致这两个子窗口都要在坚直方向缩放。 <span id="line-920" class="anchor"/><span id="line-921" class="anchor"/></p><p class="line862">例6.8中涉及的类<tt>ControlPanel</tt>结合使用了<tt>grid</tt>和<tt>box</tt> <tt>sizer</tt>。例6.9包含了这个类的代码。 <span id="line-922" class="anchor"/><span id="line-923" class="anchor"/><span
id="line-924" class="anchor"/></p><p class="line867"><img title="attachment:w6.7.gif" src="/moin/WxPythonInAction/ChapterSix?action=AttachFile&amp;do=get&amp;target=w6.7.gif" class="attachment"/> <span id="line-925" class="anchor"/><span id="line-926" class="anchor"/><span id="line-927" class="anchor"/><span id="line-928" class="anchor"/></p><p class="line867"><strong>例6.9</strong>  <span id="line-929" class="anchor"/><strong><tt>ControlPanel</tt>类</strong> <span id="line-930" class="anchor"/><span
id="line-931" class="anchor"/><span id="line-932" class="anchor"/><span id="line-933" class="anchor"/><span id="line-934" class="anchor"/><span id="line-935" class="anchor"/><span id="line-936" class="anchor"/><span id="line-937" class="anchor"/><span id="line-938" class="anchor"/><span id="line-939" class="anchor"/><span id="line-940" class="anchor"/><span id="line-941" class="anchor"/><span id="line-942" class="anchor"/><span id="line-943" class="anchor"/><span id="line-944" class="anchor"/><span
id="line-945" class="anchor"/><span id="line-946" class="anchor"/><span id="line-947" class="anchor"/><span id="line-948" class="anchor"/><span id="line-949" class="anchor"/><span id="line-950" class="anchor"/><span id="line-951" class="anchor"/><span id="line-952" class="anchor"/><span id="line-953" class="anchor"/><span id="line-954" class="anchor"/><span id="line-955" class="anchor"/><span id="line-956" class="anchor"/><span id="line-957" class="anchor"/><span id="line-958" class="anchor"/><span
id="line-959" class="anchor"/><span id="line-960" class="anchor"/><span id="line-961" class="anchor"/><span id="line-962" class="anchor"/><span id="line-963" class="anchor"/><span id="line-964" class="anchor"/><span id="line-965" class="anchor"/><span id="line-966" class="anchor"/><span id="line-967" class="anchor"/><span id="line-968" class="anchor"/><span id="line-969" class="anchor"/><span id="line-970" class="anchor"/><span id="line-971" class="anchor"/><span id="line-972" class="anchor"/><span
id="line-973" class="anchor"/><span id="line-974" class="anchor"/><span id="line-975" class="anchor"/><span id="line-976" class="anchor"/><span id="line-977" class="anchor"/><span id="line-978" class="anchor"/><span id="line-979" class="anchor"/><span id="line-980" class="anchor"/><span id="line-981" class="anchor"/><span id="line-982" class="anchor"/><span id="line-983" class="anchor"/><span id="line-984" class="anchor"/><span id="line-985" class="anchor"/><span id="line-986" class="anchor"/><span
id="line-987" class="anchor"/><span id="line-988" class="anchor"/><span id="line-989" class="anchor"/><span id="line-990" class="anchor"/><span id="line-991" class="anchor"/><span id="line-992" class="anchor"/><span id="line-993" class="anchor"/><span id="line-994" class="anchor"/><span id="line-995" class="anchor"/><span id="line-996" class="anchor"/><span id="line-997" class="anchor"/><span id="line-998" class="anchor"/><span id="line-999" class="anchor"/><span id="line-1000" class="anchor"/><span
id="line-1001" class="anchor"/><span id="line-1002" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-bc14338437b3fdfae62252fedc9c6297c419df26_007\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-bc14338437b3fdfae62252fedc9c6297c419df26_007', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-bc14338437b3fdfae62252fedc9c6297c419df26_007" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">class</span> <span class="ID">ControlPanel</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">Panel</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span></span>
<span class="line"><span class="LineNumber">   3 </span>    <span class="ID">BMP_SIZE</span> <span class="Operator">=</span> <span class="Number">16</span></span>
<span class="line"><span class="LineNumber">   4 </span>    <span class="ID">BMP_BORDER</span> <span class="Operator">=</span> <span class="Number">3</span></span>
<span class="line"><span class="LineNumber">   5 </span>    <span class="ID">NUM_COLS</span> <span class="Operator">=</span> <span class="Number">4</span></span>
<span class="line"><span class="LineNumber">   6 </span>    <span class="ID">SPACING</span> <span class="Operator">=</span> <span class="Number">4</span></span>
<span class="line"><span class="LineNumber">   7 </span></span>
<span class="line"><span class="LineNumber">   8 </span>    <span class="ID">colorList</span> <span class="Operator">=</span> <span class="Operator">(</span><span class="String">'Black'</span><span class="Operator">,</span> <span class="String">'Yellow'</span><span class="Operator">,</span> <span class="String">'Red'</span><span class="Operator">,</span> <span class="String">'Green'</span><span class="Operator">,</span> <span class="String">'Blue'</span><span class="Operator">,</span> <span
class="String">'Purple'</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   9 </span>              <span class="String">'Brown'</span><span class="Operator">,</span> <span class="String">'Aquamarine'</span><span class="Operator">,</span> <span class="String">'Forest Green'</span><span class="Operator">,</span> <span class="String">'Light Blue'</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  10 </span>              <span class="String">'Goldenrod'</span><span class="Operator">,</span> <span class="String">'Cyan'</span><span class="Operator">,</span> <span class="String">'Orange'</span><span class="Operator">,</span> <span class="String">'Navy'</span><span class="Operator">,</span> <span class="String">'Dark Grey'</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  11 </span>              <span class="String">'Light Grey'</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  12 </span>    <span class="ID">maxThickness</span> <span class="Operator">=</span> <span class="Number">16</span></span>
<span class="line"><span class="LineNumber">  13 </span></span>
<span class="line"><span class="LineNumber">  14 </span>    <span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="ID">ID</span><span class="Operator">,</span> <span class="ID">sketch</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  15 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Panel</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="ID">ID</span><span class="Operator">,</span> <span class="ID">style</span><span class="Operator">=</span><span
class="ID">wx</span><span class="Operator">.</span><span class="ID">RAISED_BORDER</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  16 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span> <span class="Operator">=</span> <span class="ID">sketch</span></span>
<span class="line"><span class="LineNumber">  17 </span>        <span class="ID">buttonSize</span> <span class="Operator">=</span> <span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">BMP_SIZE</span> <span class="Operator">+</span> <span class="Number">2</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">BMP_BORDER</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  18 </span>                      <span class="ID">self</span><span class="Operator">.</span><span class="ID">BMP_SIZE</span> <span class="Operator">+</span> <span class="Number">2</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">BMP_BORDER</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  19 </span>        <span class="ID">colorGrid</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">createColorGrid</span><span class="Operator">(</span><span class="ID">parent</span><span class="Operator">,</span> <span class="ID">buttonSize</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  20 </span>        <span class="ID">thicknessGrid</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">createThicknessGrid</span><span class="Operator">(</span><span class="ID">buttonSize</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  21 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">layout</span><span class="Operator">(</span><span class="ID">colorGrid</span><span class="Operator">,</span> <span class="ID">thicknessGrid</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  22 </span></span>
<span class="line"><span class="LineNumber">  23 </span>    <span class="ResWord">def</span> <span class="ID">createColorGrid</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="ID">buttonSize</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#1 创建颜色网格</span></span>
<span class="line"><span class="LineNumber">  24 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">colorMap</span> <span class="Operator">=</span> <span class="Operator">{</span><span class="Operator">}</span></span>
<span class="line"><span class="LineNumber">  25 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">colorButtons</span> <span class="Operator">=</span> <span class="Operator">{</span><span class="Operator">}</span></span>
<span class="line"><span class="LineNumber">  26 </span>        <span class="ID">colorGrid</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">GridSizer</span><span class="Operator">(</span><span class="ID">cols</span><span class="Operator">=</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">NUM_COLS</span><span class="Operator">,</span> <span class="ID">hgap</span><span
class="Operator">=</span><span class="Number">2</span><span class="Operator">,</span> <span class="ID">vgap</span><span class="Operator">=</span><span class="Number">2</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  27 </span>        <span class="ResWord">for</span> <span class="ID">eachColor</span> <span class="ResWord">in</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">colorList</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  28 </span>            <span class="ID">bmp</span> <span class="Operator">=</span> <span class="ID">parent</span><span class="Operator">.</span><span class="ID">MakeBitmap</span><span class="Operator">(</span><span class="ID">eachColor</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  29 </span>            <span class="ID">b</span> <span class="Operator">=</span> <span class="ID">buttons</span><span class="Operator">.</span><span class="ID">GenBitmapToggleButton</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="ID">bmp</span><span class="Operator">,</span> <span
class="ID">size</span><span class="Operator">=</span><span class="ID">buttonSize</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  30 </span>            <span class="ID">b</span><span class="Operator">.</span><span class="ID">SetBezelWidth</span><span class="Operator">(</span><span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  31 </span>            <span class="ID">b</span><span class="Operator">.</span><span class="ID">SetUseFocusIndicator</span><span class="Operator">(</span><span class="ID">False</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  32 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_BUTTON</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSetColour</span><span class="Operator">,</span> <span class="ID">b</span><span
class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  33 </span>            <span class="ID">colorGrid</span><span class="Operator">.</span><span class="ID">Add</span><span class="Operator">(</span><span class="ID">b</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  34 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">colorMap</span><span class="Operator">[</span><span class="ID">b</span><span class="Operator">.</span><span class="ID">GetId</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">]</span> <span class="Operator">=</span> <span class="ID">eachColor</span></span>
<span class="line"><span class="LineNumber">  35 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">colorButtons</span><span class="Operator">[</span><span class="ID">eachColor</span><span class="Operator">]</span> <span class="Operator">=</span> <span class="ID">b</span></span>
<span class="line"><span class="LineNumber">  36 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">colorButtons</span><span class="Operator">[</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">colorList</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span><span class="Operator">]</span><span class="Operator">.</span><span class="ID">SetToggle</span><span
class="Operator">(</span><span class="ID">True</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  37 </span>        <span class="ResWord">return</span> <span class="ID">colorGrid</span></span>
<span class="line"><span class="LineNumber">  38 </span></span>
<span class="line"><span class="LineNumber">  39 </span>    <span class="ResWord">def</span> <span class="ID">createThicknessGrid</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">buttonSize</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#2 创建线条粗细网格</span></span>
<span class="line"><span class="LineNumber">  40 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">thicknessIdMap</span> <span class="Operator">=</span> <span class="Operator">{</span><span class="Operator">}</span></span>
<span class="line"><span class="LineNumber">  41 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">thicknessButtons</span> <span class="Operator">=</span> <span class="Operator">{</span><span class="Operator">}</span></span>
<span class="line"><span class="LineNumber">  42 </span>        <span class="ID">thicknessGrid</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">GridSizer</span><span class="Operator">(</span><span class="ID">cols</span><span class="Operator">=</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">NUM_COLS</span><span class="Operator">,</span> <span class="ID">hgap</span><span
class="Operator">=</span><span class="Number">2</span><span class="Operator">,</span> <span class="ID">vgap</span><span class="Operator">=</span><span class="Number">2</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  43 </span>        <span class="ResWord">for</span> <span class="ID">x</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">1</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">maxThickness</span> <span class="Operator">+</span> <span class="Number">1</span><span class="Operator">)</span><span
class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  44 </span>            <span class="ID">b</span> <span class="Operator">=</span> <span class="ID">buttons</span><span class="Operator">.</span><span class="ID">GenToggleButton</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="ID">str</span><span class="Operator">(</span><span
class="ID">x</span><span class="Operator">)</span><span class="Operator">,</span> <span class="ID">size</span><span class="Operator">=</span><span class="ID">buttonSize</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  45 </span>            <span class="ID">b</span><span class="Operator">.</span><span class="ID">SetBezelWidth</span><span class="Operator">(</span><span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  46 </span>            <span class="ID">b</span><span class="Operator">.</span><span class="ID">SetUseFocusIndicator</span><span class="Operator">(</span><span class="ID">False</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  47 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">Bind</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">EVT_BUTTON</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">OnSetThickness</span><span class="Operator">,</span> <span class="ID">b</span><span
class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  48 </span>            <span class="ID">thicknessGrid</span><span class="Operator">.</span><span class="ID">Add</span><span class="Operator">(</span><span class="ID">b</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  49 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">thicknessIdMap</span><span class="Operator">[</span><span class="ID">b</span><span class="Operator">.</span><span class="ID">GetId</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">]</span> <span class="Operator">=</span> <span class="ID">x</span></span>
<span class="line"><span class="LineNumber">  50 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">thicknessButtons</span><span class="Operator">[</span><span class="ID">x</span><span class="Operator">]</span> <span class="Operator">=</span> <span class="ID">b</span></span>
<span class="line"><span class="LineNumber">  51 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">thicknessButtons</span><span class="Operator">[</span><span class="Number">1</span><span class="Operator">]</span><span class="Operator">.</span><span class="ID">SetToggle</span><span class="Operator">(</span><span class="ID">True</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  52 </span>        <span class="ResWord">return</span> <span class="ID">thicknessGrid</span></span>
<span class="line"><span class="LineNumber">  53 </span></span>
<span class="line"><span class="LineNumber">  54 </span>    <span class="ResWord">def</span> <span class="ID">layout</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">colorGrid</span><span class="Operator">,</span> <span class="ID">thicknessGrid</span><span class="Operator">)</span><span class="Operator">:</span><span class="Comment">#3 合并网格</span></span>
<span class="line"><span class="LineNumber">  55 </span>        <span class="ID">box</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">BoxSizer</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">VERTICAL</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  56 </span>        <span class="ID">box</span><span class="Operator">.</span><span class="ID">Add</span><span class="Operator">(</span><span class="ID">colorGrid</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ALL</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span
class="ID">SPACING</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  57 </span>        <span class="ID">box</span><span class="Operator">.</span><span class="ID">Add</span><span class="Operator">(</span><span class="ID">thicknessGrid</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ALL</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span
class="ID">SPACING</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  58 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">SetSizer</span><span class="Operator">(</span><span class="ID">box</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  59 </span>        <span class="ID">box</span><span class="Operator">.</span><span class="ID">Fit</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  60 </span></span>
<span class="line"><span class="LineNumber">  61 </span>    <span class="ResWord">def</span> <span class="ID">OnSetColour</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  62 </span>        <span class="ID">color</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">colorMap</span><span class="Operator">[</span><span class="ID">event</span><span class="Operator">.</span><span class="ID">GetId</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  63 </span>        <span class="ResWord">if</span> <span class="ID">color</span> <span class="Operator">!=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">color</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  64 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">colorButtons</span><span class="Operator">[</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">color</span><span class="Operator">]</span><span class="Operator">.</span><span class="ID">SetToggle</span><span class="Operator">(</span><span
class="ID">False</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  65 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">SetColor</span><span class="Operator">(</span><span class="ID">color</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  66 </span></span>
<span class="line"><span class="LineNumber">  67 </span>    <span class="ResWord">def</span> <span class="ID">OnSetThickness</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  68 </span>        <span class="ID">thickness</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">thicknessIdMap</span><span class="Operator">[</span><span class="ID">event</span><span class="Operator">.</span><span class="ID">GetId</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  69 </span>        <span class="ResWord">if</span> <span class="ID">thickness</span> <span class="Operator">!=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">thickness</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  70 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">thicknessButtons</span><span class="Operator">[</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">thickness</span><span class="Operator">]</span><span class="Operator">.</span><span class="ID">SetToggle</span><span class="Operator">(</span><span
class="ID">False</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  71 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">sketch</span><span class="Operator">.</span><span class="ID">SetThickness</span><span class="Operator">(</span><span class="ID">thickness</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-1003" class="anchor"/><span id="line-1004" class="anchor"/><p class="line867"><strong>#1</strong>：<tt>createColorGrid()</tt>方法建造包含颜色按钮的<tt>grid</tt>
<tt>sizer</tt>。首先，我们创建<tt>sizer</tt>本身，指定列为4列。由于列数已被设定，所以按钮将被从左到右的布局，然后向下。接下来我们要求颜色的列表，并为每种颜色创建一个按钮。在<tt>for</tt>循环中，我们为每种颜色创建了一个方形的位图，并使用<tt>wxPython</tt>库中所定义的一般的按钮窗口部件类创建了带有位图的切换按钮。然后我们把按钮与事件相绑定，并把它添加到<tt>grid</tt>。之后，我们把它添加到字典以便在以后的代码中，易于关联颜色、<tt>ID</tt>和按钮。我们不必指定按钮在网格中的位置；<tt>sizer</tt>将为我们做这件事。
<span id="line-1005" class="anchor"/><span id="line-1006" class="anchor"/><span id="line-1007" class="anchor"/></p><p class="line867"><strong>#2</strong>：<tt>createThicknessGrid()</tt>方法基本上类似于<tt>createColorGrid()</tt>方法。实际上，一个有进取心的程序员可以把它们做成一个通用函数。<tt>grid</tt> <tt>sizer</tt>被创建，十六个按钮被一次性添加，<tt>sizer</tt>确保了它们在屏幕上很好地排列。 <span id="line-1008" class="anchor"/><span id="line-1009" class="anchor"/><span id="line-1010"
class="anchor"/></p><p class="line867"><strong>#3</strong>：我们使用一个坚直的<tt>box</tt> <tt>sizer</tt>来放置网格(<tt>grid)</tt>。每个<tt>grid</tt>的第二个参数都是0，这表明<tt>grid</tt> <tt>sizer</tt>当<tt>control</tt> <tt>panel</tt>在垂直方向伸展时不改变尺寸。（由于我们已经知道<tt>control</tt>
<tt>panel</tt>不在水平方向改变尺寸，所以我们不必指定水平方向的行为。）<tt>Add()</tt>的第四个参数是项目的边框宽度，这里使用<tt>self.SPACING</tt>变量指定。第三个参数<tt>wx.ALL</tt>是一套标志中的一个，它控制那些边套用第四个参数指定的边框宽度，<tt>wx.ALL</tt>表明对象的四个边都套用。最后，我们调用<tt>box</tt> <tt>sizer</tt>的<tt>Fit()</tt>方法，使用的参数是<tt>control</tt> <tt>panel</tt>。这个方法告诉<tt>control</tt>
<tt>panel</tt>调整自身尺寸以匹配<tt>sizer</tt>认为所需要的最小化尺寸。通常这个方法在使用了<tt>sizer</tt>的窗口的构造中被调用，以确保窗口的大小足以包含<tt>sizer</tt>。 <span id="line-1011" class="anchor"/><span id="line-1012" class="anchor"/></p><p class="line862">基类<tt>wx.Sizer</tt>包含了几个通用于所有<tt>sizer</tt>的方法。表6.9列出了最常用的方法。 <span id="line-1013" class="anchor"/><span id="line-1014" class="anchor"/><span id="line-1015" class="anchor"/></p><p
class="line867"><strong>表6.9</strong>  <span id="line-1016" class="anchor"/><strong><tt>wx.Sizer</tt>的方法</strong> <span id="line-1017" class="anchor"/><span id="line-1018" class="anchor"/><span id="line-1019" class="anchor"/><span id="line-1020" class="anchor"/><span id="line-1021" class="anchor"/><span id="line-1022" class="anchor"/><span id="line-1023" class="anchor"/><span id="line-1024" class="anchor"/><span id="line-1025" class="anchor"/></p><div lang="en" dir="ltr"
class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-2e0b96081d0c900798f1a8655f33bfc7c65691c8_008\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-2e0b96081d0c900798f1a8655f33bfc7c65691c8_008', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-2e0b96081d0c900798f1a8655f33bfc7c65691c8_008" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ID">Add</span><span class="Operator">(</span><span class="ID">window</span><span class="Operator">,</span> <span class="ID">proportion</span><span class="Operator">=</span><span class="Number">0</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   2 </span>        <span class="ID">flag</span><span class="Operator">=</span><span class="Number">0</span><span class="Operator">,</span> <span class="ID">border</span><span class="Operator">=</span><span class="Number">0</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   3 </span>        <span class="ID">userData</span><span class="Operator">=</span><span class="ID">None</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span></span>
<span class="line"><span class="LineNumber">   5 </span><span class="ID">Add</span><span class="Operator">(</span><span class="ID">sizer</span><span class="Operator">,</span> <span class="ID">proportion</span><span class="Operator">=</span><span class="Number">0</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   6 </span>        <span class="ID">flag</span><span class="Operator">=</span><span class="Number">0</span><span class="Operator">,</span> <span class="ID">border</span><span class="Operator">=</span><span class="Number">0</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   7 </span>        <span class="ID">userData</span><span class="Operator">=</span><span class="ID">None</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-1026" class="anchor"/><span id="line-1027" class="anchor"/><p class="line867"><tt>Add(size</tt>, <tt>proportion</tt>=0,<tt>flag</tt>=0,
<tt>border</tt>=0,<tt>userData</tt>=<tt>None)</tt>：第一个添加一个<tt>wxWindow</tt>，第二个添加一个嵌套的<tt>sizer</tt>，第三个添加空的空间，用作分隔符。参数<tt>proportion</tt>管理窗口总尺寸，它是相对于别的窗口的改变而言的，它只对<tt>wx.BoxSizer</tt>有意义。参数<tt>flag</tt>是一个位图，针对对齐、边框位置，增长有许多不同的标志，完整的列表见第十一章。参数<tt>border</tt>是窗口或<tt>sizer</tt>周围以像素为单位的空间总量。<tt>userData</tt>使你能够将对象与数据关联，例如，在一个子类中，可能需要更多的用于尺寸的信息。
<span id="line-1028" class="anchor"/><span id="line-1029" class="anchor"/></p><p class="line867"><tt>Fit(window)</tt> <span id="line-1030" class="anchor"/><tt>FitInside(window</tt> )：调整<tt>window</tt>尺寸以匹配<tt>sizer</tt>认为所需要的最小化尺寸。这个参数的值通常是使用<tt>sizer</tt>的窗口。<tt>FitInside()</tt>是一个类似的方法，只不过将改变窗口在屏幕上的显示替换为只改变它的内部实现。它用于<tt>scroll</tt> <tt>panel</tt>中的窗口以触发滚动栏的显示。 <span id="line-1031"
class="anchor"/><span id="line-1032" class="anchor"/></p><p class="line867"><tt>GetSize()</tt>：以<tt>wx.Size</tt>对象的形式返回<tt>sizer</tt>的尺寸。 <span id="line-1033" class="anchor"/><span id="line-1034" class="anchor"/></p><p class="line867"><tt>GetPosition()</tt>：以<tt>wx.Point</tt>对象的形式返回<tt>sizer</tt>的位置。 <span id="line-1035" class="anchor"/><span id="line-1036" class="anchor"/></p><p
class="line867"><tt>GetMinSize()</tt>：以<tt>wx.Size</tt>对象的形式返回完全填充<tt>sizer</tt>所需的最小尺寸。 <span id="line-1037" class="anchor"/><span id="line-1038" class="anchor"/></p><p class="line867"><tt>Layout()</tt>：强迫<tt>sizer</tt>去重新计算它的孩子的尺寸和位置。在动态地添加或删除了一个孩子之后调用。 <span id="line-1039" class="anchor"/><span id="line-1040" class="anchor"/></p><p
class="line867"><tt>Prepend(...)</tt>：与<tt>Add()</tt>相同（只是为了布局的目的，把新的对象放在<tt>sizer</tt>列表的开头）。 <span id="line-1041" class="anchor"/><span id="line-1042" class="anchor"/></p><p class="line867"><tt>Remove(window)</tt> <span id="line-1043" class="anchor"/><tt>Remove(sizer)</tt> <span id="line-1044" class="anchor"/><tt>Remove(nth)</tt>：从<tt>sizer</tt>中删除一个对象。 <span id="line-1045" class="anchor"/><span id="line-1046" class="anchor"/></p><p
class="line867"><tt>SetDimension(x</tt>, y, <tt>width</tt>,<tt>height)</tt>：强迫<tt>sizer</tt>按照给定的参数重新定位它的所有孩子。 <span id="line-1047" class="anchor"/><span id="line-1048" class="anchor"/></p><p class="line862">有关<tt>sizer</tt>和嵌套<tt>sizer</tt>的更详细的信息请参考第11章。 <span id="line-1049" class="anchor"/><span id="line-1050" class="anchor"/><span id="line-1051" class="anchor"/></p><p class="line867">
</p><h3 id="head-39a0e8508136cd64b5d4b3229bfcb4084dba4916">1.4.2. 如何建造一个关于(about)框？</h3>
<span id="line-1052" class="anchor"/><span id="line-1053" class="anchor"/><span id="line-1054" class="anchor"/><p class="line867"><tt>about</tt>框是显示对话框的一个好的例子，它能够显示比纯信息框更复杂的信息。这里，你可以使用<tt>wx.html.HtmlWindow</tt>作为一个简单的机制来显示样式文本。实际上，<tt>wx.html.HtmlWindow</tt>远比我们这里演示的强大，它包括了管理用户交互以及绘制的方法。第16章涵盖了<tt>wx.html.HtmlWindow</tt>的特性。例6.10展示了一个类，它使用<tt>HTML</tt>
<tt>renderer</tt>创建一个<tt>about</tt>框。 <span id="line-1055" class="anchor"/><span id="line-1056" class="anchor"/><span id="line-1057" class="anchor"/></p><p class="line867"><strong>例6.10</strong>  <span id="line-1058" class="anchor"/><strong>使用<tt>wx.html.HtmlWindow</tt>作为一个<tt>about</tt>框</strong> <span id="line-1059" class="anchor"/><span id="line-1060" class="anchor"/><span id="line-1061" class="anchor"/><span id="line-1062" class="anchor"/><span
id="line-1063" class="anchor"/><span id="line-1064" class="anchor"/><span id="line-1065" class="anchor"/><span id="line-1066" class="anchor"/><span id="line-1067" class="anchor"/><span id="line-1068" class="anchor"/><span id="line-1069" class="anchor"/><span id="line-1070" class="anchor"/><span id="line-1071" class="anchor"/><span id="line-1072" class="anchor"/><span id="line-1073" class="anchor"/><span id="line-1074" class="anchor"/><span id="line-1075" class="anchor"/><span
id="line-1076" class="anchor"/><span id="line-1077" class="anchor"/><span id="line-1078" class="anchor"/><span id="line-1079" class="anchor"/><span id="line-1080" class="anchor"/><span id="line-1081" class="anchor"/><span id="line-1082" class="anchor"/><span id="line-1083" class="anchor"/><span id="line-1084" class="anchor"/><span id="line-1085" class="anchor"/><span id="line-1086" class="anchor"/><span id="line-1087" class="anchor"/><span id="line-1088" class="anchor"/><span
id="line-1089" class="anchor"/><span id="line-1090" class="anchor"/><span id="line-1091" class="anchor"/><span id="line-1092" class="anchor"/><span id="line-1093" class="anchor"/><span id="line-1094" class="anchor"/><span id="line-1095" class="anchor"/><span id="line-1096" class="anchor"/><span id="line-1097" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-7ba318dbb615d52e2bf76db886b6ff199b225e0a_009\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-7ba318dbb615d52e2bf76db886b6ff199b225e0a_009', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-7ba318dbb615d52e2bf76db886b6ff199b225e0a_009" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">class</span> <span class="ID">SketchAbout</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">Dialog</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>    <span class="ID">text</span> <span class="Operator">=</span> <span class="String">'''</span></span>
<span class="line"><span class="LineNumber">   3 </span><span class="String"><html></span></span>
<span class="line"><span class="LineNumber">   4 </span><span class="String"><body bgcolor="#ACAA60"></span></span>
<span class="line"><span class="LineNumber">   5 </span><span class="String"><center><table bgcolor="#455481" width="100%" cellspacing="0"</span></span>
<span class="line"><span class="LineNumber">   6 </span><span class="String">cellpadding="0" border="1"></span></span>
<span class="line"><span class="LineNumber">   7 </span><span class="String"><tr></span></span>
<span class="line"><span class="LineNumber">   8 </span><span class="String"><td align="center"><h1>Sketch!</h1></td></span></span>
<span class="line"><span class="LineNumber">   9 </span><span class="String"></tr></span></span>
<span class="line"><span class="LineNumber">  10 </span><span class="String"></table></span></span>
<span class="line"><span class="LineNumber">  11 </span><span class="String"></center></span></span>
<span class="line"><span class="LineNumber">  12 </span><span class="String"><p><b>Sketch</b> is a demonstration program for</span></span>
<span class="line"><span class="LineNumber">  13 </span><span class="String"><b>wxPython In Action</b></span></span>
<span class="line"><span class="LineNumber">  14 </span><span class="String">Chapter 6. It is based on the SuperDoodle demo included</span></span>
<span class="line"><span class="LineNumber">  15 </span><span class="String">with wxPython, available at http://www.wxpython.org/</span></span>
<span class="line"><span class="LineNumber">  16 </span><span class="String"></p></span></span>
<span class="line"><span class="LineNumber">  17 </span><span class="String"><p><b>SuperDoodle</b> and <b>wxPython</b> are brought to you by</span></span>
<span class="line"><span class="LineNumber">  18 </span><span class="String"><b>Robin Dunn</b> and <b>Total Control Software</b>, Copyright</span></span>
<span class="line"><span class="LineNumber">  19 </span><span class="String">&copy; 1997-2006.</p></span></span>
<span class="line"><span class="LineNumber">  20 </span><span class="String"></body></span></span>
<span class="line"><span class="LineNumber">  21 </span><span class="String"></html>s</span></span>
<span class="line"><span class="LineNumber">  22 </span><span class="String">'''</span></span>
<span class="line"><span class="LineNumber">  23 </span></span>
<span class="line"><span class="LineNumber">  24 </span>    <span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  25 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Dialog</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span
class="String">'About Sketch'</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  26 </span>                          <span class="ID">size</span><span class="Operator">=</span><span class="Operator">(</span><span class="Number">440</span><span class="Operator">,</span> <span class="Number">400</span><span class="Operator">)</span> <span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  27 </span></span>
<span class="line"><span class="LineNumber">  28 </span>        <span class="ID">html</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">html</span><span class="Operator">.</span><span class="ID">HtmlWindow</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  29 </span>        <span class="ID">html</span><span class="Operator">.</span><span class="ID">SetPage</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">text</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  30 </span>        <span class="ID">button</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Button</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ID_OK</span><span class="Operator">,</span> <span class="String">"Okay"</span><span
class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  31 </span></span>
<span class="line"><span class="LineNumber">  32 </span>        <span class="ID">sizer</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">BoxSizer</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">VERTICAL</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  33 </span>        <span class="ID">sizer</span><span class="Operator">.</span><span class="ID">Add</span><span class="Operator">(</span><span class="ID">html</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">EXPAND</span><span class="Operator">|</span><span class="ID">wx</span><span
class="Operator">.</span><span class="ID">ALL</span><span class="Operator">,</span> <span class="Number">5</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  34 </span>        <span class="ID">sizer</span><span class="Operator">.</span><span class="ID">Add</span><span class="Operator">(</span><span class="ID">button</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">ALIGN_CENTER</span><span class="Operator">|</span><span class="ID">wx</span><span
class="Operator">.</span><span class="ID">ALL</span><span class="Operator">,</span> <span class="Number">5</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  35 </span></span>
<span class="line"><span class="LineNumber">  36 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">SetSizer</span><span class="Operator">(</span><span class="ID">sizer</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  37 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">Layout</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-1098" class="anchor"/><p class="line862">上面的<tt>HTML</tt>字符串中，有一些布局和字体标记。这里的对话框合并了<tt>wx.html.HtmlWindow</tt>和一个<tt>wx.ID_OK</tt> <tt>ID</tt>按钮。敲击按钮则自动关闭窗口，如同其它对话框一样。一个垂直的<tt>box</tt> <tt>sizer</tt>用于管理这个布局。 <span id="line-1099" class="anchor"/><span id="line-1100" class="anchor"/></p><p class="line874">图6.8显示了该对话框。 <span id="line-1101"
class="anchor"/>图6.8 <span id="line-1102" class="anchor"/><span id="line-1103" class="anchor"/></p><p class="line867"><img title="attachment:w6.8.gif" src="/moin/WxPythonInAction/ChapterSix?action=AttachFile&amp;do=get&amp;target=w6.8.gif" class="attachment"/> <span id="line-1104" class="anchor"/><span id="line-1105" class="anchor"/><span id="line-1106" class="anchor"/></p><p class="line862">把它作为一个菜单项(<tt>About)</tt>的处理器的方法如下： <span
id="line-1107" class="anchor"/><span id="line-1108" class="anchor"/><span id="line-1109" class="anchor"/><span id="line-1110" class="anchor"/><span id="line-1111" class="anchor"/><span id="line-1112" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-653e7453a1868e6293d50a6fc3a47b96f5db8f4e_010\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-653e7453a1868e6293d50a6fc3a47b96f5db8f4e_010', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-653e7453a1868e6293d50a6fc3a47b96f5db8f4e_010" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">def</span> <span class="ID">OnAbout</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>        <span class="ID">dlg</span> <span class="Operator">=</span> <span class="ID">SketchAbout</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   3 </span>        <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">ShowModal</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span>        <span class="ID">dlg</span><span class="Operator">.</span><span class="ID">Destroy</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-1113" class="anchor"/><span id="line-1114" class="anchor"/><p class="line867">
</p><h3 id="head-21ede5b328cae69a3c5586248fb660c43ed400ac">1.4.3. 如何建造一个启动画面？</h3>
<span id="line-1115" class="anchor"/><span id="line-1116" class="anchor"/><span id="line-1117" class="anchor"/><p class="line862">显示一个好的启动画面，将给你的用户一种专业化的感觉。在你的应用程序完成一个费时的设置的时候，它也可以转移用户的注意力。在<tt>wxPython</tt>中，使用类<tt>wx.SplashScreen</tt>建造一个启动画面是很容易的。启动画面可以保持显示指定的时间，并且无论时间是否被设置，当用户在其上敲击时，它总是会关闭。 <span id="line-1118"
class="anchor"/><span id="line-1119" class="anchor"/></p><p class="line867"><tt>wx.SplashScreen</tt>类的构造函数如下： <span id="line-1120" class="anchor"/><span id="line-1121" class="anchor"/><span id="line-1122" class="anchor"/><span id="line-1123" class="anchor"/><span id="line-1124" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-1c9440a1eff4762cbe6809596b98e30ad1381284_011\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-1c9440a1eff4762cbe6809596b98e30ad1381284_011', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-1c9440a1eff4762cbe6809596b98e30ad1381284_011" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">SplashScreen</span><span class="Operator">(</span><span class="ID">bitmap</span><span class="Operator">,</span> <span class="ID">splashStyle</span><span class="Operator">,</span> <span class="ID">milliseconds</span><span
class="Operator">,</span> <span class="ID">parent</span><span class="Operator">,</span> <span class="ID">id</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   2 </span>        <span class="ID">pos</span><span class="Operator">=</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">DefaultPosition</span><span class="Operator">,</span> <span class="ID">size</span><span class="Operator">=</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">DefaultSize</span><span
class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   3 </span>        <span class="ID">style</span><span class="Operator">=</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">SIMPLE_BORDER</span><span class="Operator">|</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">FRAME_NO_TASKBAR</span><span class="Operator">|</span><span class="ID">wx</span><span
class="Operator">.</span><span class="ID">STAY_ON_TOP</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-1125" class="anchor"/><p class="line862">表6.10说明了<tt>wx.SplashScreen</tt>构造函数的参数 <span id="line-1126" class="anchor"/><span id="line-1127" class="anchor"/><span id="line-1128" class="anchor"/></p><p class="line867"><strong>表6.10</strong>  <span id="line-1129" class="anchor"/><strong><tt>wx.SplashScreen</tt>构造函数的参数</strong> <span id="line-1130" class="anchor"/><span id="line-1131"
class="anchor"/></p><p class="line867"><tt>bitmap</tt>：一个<tt>wx.Bitmap</tt>，它被显示在屏幕上。 <span id="line-1132" class="anchor"/><span id="line-1133" class="anchor"/></p><p class="line867"><tt>splashStyle</tt>：另一个位图样式，可以是下列的结合：<tt>wx.SPLASH_CENTRE_ON_PARENT</tt>,<tt>wx.SPLASH_CENTRE_ON_SCREEN</tt>, <span id="line-1134" class="anchor"/><tt>wx.SPLASH_NO_CENTRE</tt>, <tt>wx.SPLASH_TIMEOUT</tt>,
<tt>wx.SPLASH_NO_TIMEOUT</tt> <span id="line-1135" class="anchor"/><span id="line-1136" class="anchor"/></p><p class="line867"><tt>milliseconds</tt>：如果<tt>splashStyle</tt>指定为<tt>wx.SPLASH_TIMEOUT</tt>，<tt>milliseconds</tt>是保持显示的毫秒数。 <span id="line-1137" class="anchor"/><span id="line-1138" class="anchor"/></p><p class="line867"><tt>parent</tt>：父窗口，通常为<tt>None</tt>。 <span id="line-1139"
class="anchor"/><span id="line-1140" class="anchor"/></p><p class="line867"><tt>id</tt>：窗口<tt>ID</tt>，通常使用-1比较好。 <span id="line-1141" class="anchor"/><span id="line-1142" class="anchor"/></p><p class="line867"><tt>pos</tt>：如果<tt>splashStyle</tt>取值<tt>wx.SPLASH_NO_CENTER</tt>的话，<tt>pos</tt>指定画面在屏幕上的位置。 <span id="line-1143" class="anchor"/><span id="line-1144" class="anchor"/></p><p
class="line867"><tt>size</tt>：尺寸。通常你不需要指定这个参数，因为通常使用位图的尺寸。 <span id="line-1145" class="anchor"/><span id="line-1146" class="anchor"/></p><p class="line867"><tt>style</tt>：常规的<tt>wxPython</tt>框架的样式，一般使用默认值就可以了。 <span id="line-1147" class="anchor"/><span id="line-1148" class="anchor"/></p><p
class="line862">例6.11显示了启动画面的代码。这里我们用一具自定义的<tt>wx.App</tt>子类来替代了<tt>wx.PySimpleApp</tt>。 <span id="line-1149" class="anchor"/><span id="line-1150" class="anchor"/><span id="line-1151" class="anchor"/></p><p class="line867"><strong>例6.11</strong>  <span id="line-1152" class="anchor"/><strong>一个启动画面的代码</strong> <span id="line-1153" class="anchor"/><span id="line-1154" class="anchor"/><span
id="line-1155" class="anchor"/><span id="line-1156" class="anchor"/><span id="line-1157" class="anchor"/><span id="line-1158" class="anchor"/><span id="line-1159" class="anchor"/><span id="line-1160" class="anchor"/><span id="line-1161" class="anchor"/><span id="line-1162" class="anchor"/><span id="line-1163" class="anchor"/><span id="line-1164" class="anchor"/><span id="line-1165" class="anchor"/><span id="line-1166"
class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-ca60ccc01c7dc22d8139a49bfb06ce497ad85fd6_012\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-ca60ccc01c7dc22d8139a49bfb06ce497ad85fd6_012', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-ca60ccc01c7dc22d8139a49bfb06ce497ad85fd6_012" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">class</span> <span class="ID">SketchApp</span><span class="Operator">(</span><span class="ID">wx</span><span class="Operator">.</span><span class="ID">App</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span></span>
<span class="line"><span class="LineNumber">   3 </span>    <span class="ResWord">def</span> <span class="ID">OnInit</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   4 </span>        <span class="ID">bmp</span> <span class="Operator">=</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Image</span><span class="Operator">(</span><span class="String">"splash.png"</span><span class="Operator">)</span><span class="Operator">.</span><span class="ID">ConvertToBitmap</span><span
class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   5 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">SplashScreen</span><span class="Operator">(</span><span class="ID">bmp</span><span class="Operator">,</span> <span class="ID">wx</span><span class="Operator">.</span><span class="ID">SPLASH_CENTRE_ON_SCREEN</span> <span class="Operator">|</span> <span class="ID">wx</span><span
class="Operator">.</span><span class="ID">SPLASH_TIMEOUT</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   6 </span>                <span class="Number">1000</span><span class="Operator">,</span> <span class="ID">None</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   7 </span>        <span class="ID">wx</span><span class="Operator">.</span><span class="ID">Yield</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span></span>
<span class="line"><span class="LineNumber">   9 </span>        <span class="ID">frame</span> <span class="Operator">=</span> <span class="ID">SketchFrame</span><span class="Operator">(</span><span class="ID">None</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  10 </span>        <span class="ID">frame</span><span class="Operator">.</span><span class="ID">Show</span><span class="Operator">(</span><span class="ID">True</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">SetTopWindow</span><span class="Operator">(</span><span class="ID">frame</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  12 </span>        <span class="ResWord">return</span> <span class="ID">True</span><span class="Text"/></span>
</pre></div><span id="line-1167" class="anchor"/><p class="line862">通常，启动画面被声明在应用程序启动期间的<tt>OnInit</tt>方法中。启动画面将一直显示直到它被敲击或超时。这里，启动画面显示在屏幕的中央，一秒后超时。<tt>Yield()</tt>的调用很重要，因为它使得在应用程序继续启动前，任何未被处理的事件仍可以被继续处理。这里，<tt>Yield()</tt>的调用确保了在应用程序继续启动前，启动画面能够接受并处理它的初始化绘制事件。 <span
id="line-1168" class="anchor"/><span id="line-1169" class="anchor"/><span id="line-1170" class="anchor"/></p><p class="line867">
</p><h2 id="head-7128fdbb7115084ca4c31c13a4b6b2d31f26f09e">1.5. 本章小结</h2>
<span id="line-1171" class="anchor"/><span id="line-1172" class="anchor"/><span id="line-1173" class="anchor"/><ol type="1"><li><p
class="line862">大多数的应用程序使用了诸如菜单、工具栏和启动画面这样的通常的元素。它们的使用不但对你程序的可用性有帮助，并且使你的应用程序看起来更专业。在这一章里，我们使用了一个简单的<tt>sketch</tt>应用程序，并且使用了工具栏、状态栏、菜单栏，通用对话框、复杂的布局、<tt>about</tt>框和启动画面来逐步对它作了改进。 <span id="line-1174" class="anchor"/><span id="line-1175" class="anchor"/></p></li><li class="gap"><p
class="line862">你可以使用一个设备上下文来直接对<tt>wxPython</tt>的显示进行绘制。不同的显示要求不同的设备上下文，然而它们共享一个通用<tt>API</tt>。为了平滑的显示，设备上下文可以被缓存。 <span id="line-1176" class="anchor"/><span id="line-1177" class="anchor"/></p></li><li class="gap">一个状态栏能够被自动地创建在框架的底部。它可以包含一个或多个文本域，各文本域可被独立调整尺寸和设置。 <span id="line-1178"
class="anchor"/><span id="line-1179" class="anchor"/></li><li class="gap">菜单可以包含嵌套的子菜单，菜单项可以有切换状态。工具栏产生与菜单栏同种的事件，并且被设计来更易于对工具按钮分组布局。 <span id="line-1180" class="anchor"/><span id="line-1181" class="anchor"/></li><li class="gap"><p class="line862">可以使用标准<tt>wx.FileDialog</tt>来管理打开和保存数据。可以使用<tt>wx.ColourDialog</tt>来选择颜色。 <span
id="line-1182" class="anchor"/><span id="line-1183" class="anchor"/></p></li><li class="gap"><p class="line862">使用<tt>sizer</tt>可以进行窗口部件的复杂布局，而不用明确地指定具体位置。<tt>sizer</tt>根据规则自动放置它的孩子对象。<tt>sizer</tt>包括的<tt>wx.GridSizer</tt>按二维网格来布局对象。<tt>wx.BoxSizer</tt>在一条线上布局项目。<tt>sizer</tt>可以嵌套，并且当<tt>sizer</tt>伸展时可以，它可以控制其孩子的行为。
<span id="line-1184" class="anchor"/><span id="line-1185" class="anchor"/></p></li><li class="gap"><p class="line891"><tt>about</tt>框或别的简单的对话框可以使用<tt>wx.html.HtmlWindow</tt>来创建。启动画面用<tt>wx.SplashScreen</tt>来创建。 <span id="line-1186" class="anchor"/><span id="line-1187" class="anchor"/></p></li></ol><p class="line862">在第一部分（<tt>part</tt>
1）中，我们已经涵盖了<tt>wxPython</tt>的基本概念，并且我们已经涉及了一些最常见的任务。在接下来的第二部分（<tt>part</tt> 2）中，我们将使用目前常见的问答的格式，但是我们将涉及有关<tt>wxPython</tt>工具包的组成和功能方面的更详细的问题。 <span id="line-1188" class="anchor"/><span id="bottom" class="anchor"/></p></div>
