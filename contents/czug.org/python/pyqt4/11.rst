---
created: 
creator: Benky
description: ''
title: 俄罗斯方块游戏
---
<div lang="en" id="content" dir="ltr"><span id="top" class="anchor"/>
<span id="line-3" class="anchor"/><p class="line867"/><div lang="en" id="Include_TheTetrisGame" dir="ltr"><span id="top_Include_TheTetrisGame" class="anchor"/>
<span id="line-5" class="anchor"/><span id="line-6" class="anchor"/><span id="line-7" class="anchor"/><p class="line862">SEE: <a href="http://wiki.woodpecker.org.cn/moin/WoodpeckerIdxProj" class="http">http://wiki.woodpecker.org.cn/moin/WoodpeckerIdxProj</a> <span id="line-8" class="anchor"/><span id="line-9" class="anchor"/></p><p class="line867">
</p><h1 id="head-7f69455b61b48a37519b8515f922c729023762a4">1. The Tetris game in PyQt4</h1>
<span id="line-10" class="anchor"/><p class="line867"><strong><a href="/moin/PyQt4" class="nonexistent">PyQt4</a>中的俄罗斯方块游戏</strong> <span id="line-11" class="anchor"/><span id="line-12" class="anchor"/></p><p class="line867"><em>Creating a computer game is very challenging. Sooner or later, a programmer will want to create a computer game one day. In fact, many people became interested in programming, because they played games and wanted to create their own. Creating a computer game will vastly help improving your programming skills.</em> <span id="line-13" class="anchor"/><span id="line-14" class="anchor"/></p><ul><li style="list-style-type:
none;">编写计算机游戏非常有挑战性，早晚有一天，一名程序员会希望编写一个计算机游戏。事实上，很多人因为玩游戏并希望创造自己的游戏而对编程产生兴趣的。编写计算机游戏可以大大的提高你的编程水平。 <span id="line-15" class="anchor"/><span id="line-16" class="anchor"/></li></ul><p class="line867">
</p><h2 id="head-9781a97e2bba46e25e6cf3579843823ae78604c3">1.1. Tetris</h2>
<span id="line-17" class="anchor"/><p class="line867"><em>The tetris game is one of the most popular computer games ever created. The original game was designed and programmed by a russian programmer Alexey Pajitnov in 1985. Since then, tetris is available on almost every computer platform in lots of variations. Even my mobile phone has a modified version of the tetris game.</em> <span id="line-18" class="anchor"/><span id="line-19" class="anchor"/></p><ul><li style="list-style-type: none;">俄罗斯方块游戏是现有的最受欢迎的计算机游戏之一。游戏最初由一名俄罗斯程序员Alexey Pajitnov于1985年设计并编写。从那时开始，俄罗斯方块游戏的众多变种出现在几乎每种计算机平台上。甚至我的移动电话也有一个改版的俄罗斯方块游戏。 <span id="line-20" class="anchor"/></li></ul><p
class="line867"><em>Tetris is called a falling block puzzle game. In this game, we have seven different shapes called tetrominoes. S-shape, Z-shape, T-shape, L-shape, Line-shape, MirroredL-shape and a Square-shape. Each of these shapes is formed with four squares. The shapes are falling down the board. The object of the tetris game is to move and rotate the shapes, so that they fit as much as possible. If we manage to form a row, the row is destroyed and we score. We play the tetris game until we top out.</em> <span id="line-21" class="anchor"/><span id="line-22" class="anchor"/></p><ul><li style="list-style-type:
none;">俄罗斯方块也叫作掉落方块解迷游戏。在这个游戏中，我们有七种不同的形状叫做tetrominoes.S形，Z形，T形，L形，线形，反L形和方块。每个形状由四个小方块组成。形状从顶板上落下来。俄罗斯方块游戏的目标是移动并旋转形状以便将他们尽可能的组合起来。如果我们控制填充满了一行，这一行就会消失，并且我们的得分。直到方块顶到顶部游戏结束。 <span id="line-23" class="anchor"/></li></ul><p class="line874">Tetrominoes Figure: Tetrominoes <span id="line-24" class="anchor"/><span id="line-25" class="anchor"/></p><p class="line867"><em><a href="/moin/PyQt4" class="nonexistent">PyQt4</a> is a toolkit designed to create applications. There are other libraries which are targeted at creating computer games. Nevertheless, <a href="/moin/PyQt4" class="nonexistent">PyQt4</a> and other application toolkits
can be used to create games.</em> <span id="line-26" class="anchor"/><span id="line-27" class="anchor"/></p><ul><li style="list-style-type: none;"><p class="line891"><a href="/moin/PyQt4" class="nonexistent">PyQt4</a>被设计成用来编写程序的工具包。有其他的库是专门设计用来编写计算机游戏的。尽管如此，<a href="/moin/PyQt4" class="nonexistent">PyQt4</a>和其他应用程序工具包也可以被用来编写游戏。 <span id="line-28" class="anchor"/></p></li></ul><p class="line867"><em>The following example is a modified version of the tetris game, available with <a href="/moin/PyQt4" class="nonexistent">PyQt4</a> installation files.</em> <span id="line-29" class="anchor"/><span id="line-30" class="anchor"/></p><ul><li style="list-style-type: none;"><p
class="line862">下面的例子是俄罗斯方块游戏的改版，随<a href="/moin/PyQt4" class="nonexistent">PyQt4</a>的安装文件而存在。 <span id="line-31" class="anchor"/></p></li></ul><p class="line874">The development  <span id="line-32" class="anchor"/><em>We do not have images for our tetris game, we draw the tetrominoes using the drawing API available in the <a href="/moin/PyQt4" class="nonexistent">PyQt4</a> programming toolkit. Behind every computer game, there is a mathematical model. So it is in tetris.</em> <span id="line-33" class="anchor"/><span id="line-34" class="anchor"/></p><ul><li style="list-style-type: none;"><p class="line862">我们没有为我们的俄罗斯方块使用图片。我们通过<a href="/moin/PyQt4"
class="nonexistent">PyQt4</a>编程工具包中的绘图API来绘制方块。每个计算机游戏中，都有数学模型，俄罗斯方块游戏也是。 <span id="line-35" class="anchor"/></p></li></ul><p class="line867"><em>Some ideas behind the game.</em> <span id="line-36" class="anchor"/><span id="line-37" class="anchor"/></p><ul><li style="list-style-type: none;">游戏内部的设计。 <span id="line-38" class="anchor"/><ul><li><p class="line862">We use <a href="/moin/QtCore" class="nonexistent">QtCore</a>.QBasicTimer() to create a game cycle <span id="line-39" class="anchor"/></p><ul><li style="list-style-type: none;"><p class="line862">我们用<a href="/moin/QtCore" class="nonexistent">QtCore</a>.QBasicTimer()来创建一个游戏循环 <span id="line-40" class="anchor"/></p></li></ul></li><li>The tetrominoes are drawn <span
id="line-41" class="anchor"/><ul><li style="list-style-type: none;">绘制俄罗斯方块 <span id="line-42" class="anchor"/></li></ul></li><li>The shapes move on a square by square basis (not pixel by pixel) <span id="line-43" class="anchor"/><ul><li style="list-style-type: none;">图形一块一块的移动而不是一个像素一个像素的移动。 <span id="line-44" class="anchor"/></li></ul></li><li>Mathematically a board is a simple list of numbers <span id="line-45" class="anchor"/><ul><li style="list-style-type: none;">数学上背板是一个简单的数的列表 <span id="line-46" class="anchor"/></li></ul></li></ul></li></ul><p class="line867"><span id="line-47" class="anchor"/><span id="line-48" class="anchor"/><span id="line-49" class="anchor"/><span id="line-50" class="anchor"/><span id="line-51"
class="anchor"/><span id="line-52" class="anchor"/><span id="line-53" class="anchor"/><span id="line-54" class="anchor"/><span id="line-55" class="anchor"/><span id="line-56" class="anchor"/><span id="line-57" class="anchor"/><span id="line-58" class="anchor"/><span id="line-59" class="anchor"/><span id="line-60" class="anchor"/><span id="line-61" class="anchor"/><span id="line-62" class="anchor"/><span id="line-63" class="anchor"/><span id="line-64" class="anchor"/><span id="line-65" class="anchor"/><span id="line-66" class="anchor"/><span id="line-67" class="anchor"/><span id="line-68" class="anchor"/><span id="line-69" class="anchor"/><span id="line-70" class="anchor"/><span id="line-71" class="anchor"/><span id="line-72" class="anchor"/><span id="line-73"
class="anchor"/><span id="line-74" class="anchor"/><span id="line-75" class="anchor"/><span id="line-76" class="anchor"/><span id="line-77" class="anchor"/><span id="line-78" class="anchor"/><span id="line-79" class="anchor"/><span id="line-80" class="anchor"/><span id="line-81" class="anchor"/><span id="line-82" class="anchor"/><span id="line-83" class="anchor"/><span id="line-84" class="anchor"/><span id="line-85" class="anchor"/><span id="line-86" class="anchor"/><span id="line-87" class="anchor"/><span id="line-88" class="anchor"/><span id="line-89" class="anchor"/><span id="line-90" class="anchor"/><span id="line-91" class="anchor"/><span id="line-92" class="anchor"/><span id="line-93" class="anchor"/><span id="line-94" class="anchor"/><span id="line-95"
class="anchor"/><span id="line-96" class="anchor"/><span id="line-97" class="anchor"/><span id="line-98" class="anchor"/><span id="line-99" class="anchor"/><span id="line-100" class="anchor"/><span id="line-101" class="anchor"/><span id="line-102" class="anchor"/><span id="line-103" class="anchor"/><span id="line-104" class="anchor"/><span id="line-105" class="anchor"/><span id="line-106" class="anchor"/><span id="line-107" class="anchor"/><span id="line-108" class="anchor"/><span id="line-109" class="anchor"/><span id="line-110" class="anchor"/><span id="line-111" class="anchor"/><span id="line-112" class="anchor"/><span id="line-113" class="anchor"/><span id="line-114" class="anchor"/><span id="line-115" class="anchor"/><span id="line-116" class="anchor"/><span id="line-117"
class="anchor"/><span id="line-118" class="anchor"/><span id="line-119" class="anchor"/><span id="line-120" class="anchor"/><span id="line-121" class="anchor"/><span id="line-122" class="anchor"/><span id="line-123" class="anchor"/><span id="line-124" class="anchor"/><span id="line-125" class="anchor"/><span id="line-126" class="anchor"/><span id="line-127" class="anchor"/><span id="line-128" class="anchor"/><span id="line-129" class="anchor"/><span id="line-130" class="anchor"/><span id="line-131" class="anchor"/><span id="line-132" class="anchor"/><span id="line-133" class="anchor"/><span id="line-134" class="anchor"/><span id="line-135" class="anchor"/><span id="line-136" class="anchor"/><span id="line-137" class="anchor"/><span id="line-138" class="anchor"/><span
id="line-139" class="anchor"/><span id="line-140" class="anchor"/><span id="line-141" class="anchor"/><span id="line-142" class="anchor"/><span id="line-143" class="anchor"/><span id="line-144" class="anchor"/><span id="line-145" class="anchor"/><span id="line-146" class="anchor"/><span id="line-147" class="anchor"/><span id="line-148" class="anchor"/><span id="line-149" class="anchor"/><span id="line-150" class="anchor"/><span id="line-151" class="anchor"/><span id="line-152" class="anchor"/><span id="line-153" class="anchor"/><span id="line-154" class="anchor"/><span id="line-155" class="anchor"/><span id="line-156" class="anchor"/><span id="line-157" class="anchor"/><span id="line-158" class="anchor"/><span id="line-159" class="anchor"/><span id="line-160"
class="anchor"/><span id="line-161" class="anchor"/><span id="line-162" class="anchor"/><span id="line-163" class="anchor"/><span id="line-164" class="anchor"/><span id="line-165" class="anchor"/><span id="line-166" class="anchor"/><span id="line-167" class="anchor"/><span id="line-168" class="anchor"/><span id="line-169" class="anchor"/><span id="line-170" class="anchor"/><span id="line-171" class="anchor"/><span id="line-172" class="anchor"/><span id="line-173" class="anchor"/><span id="line-174" class="anchor"/><span id="line-175" class="anchor"/><span id="line-176" class="anchor"/><span id="line-177" class="anchor"/><span id="line-178" class="anchor"/><span id="line-179" class="anchor"/><span id="line-180" class="anchor"/><span id="line-181" class="anchor"/><span
id="line-182" class="anchor"/><span id="line-183" class="anchor"/><span id="line-184" class="anchor"/><span id="line-185" class="anchor"/><span id="line-186" class="anchor"/><span id="line-187" class="anchor"/><span id="line-188" class="anchor"/><span id="line-189" class="anchor"/><span id="line-190" class="anchor"/><span id="line-191" class="anchor"/><span id="line-192" class="anchor"/><span id="line-193" class="anchor"/><span id="line-194" class="anchor"/><span id="line-195" class="anchor"/><span id="line-196" class="anchor"/><span id="line-197" class="anchor"/><span id="line-198" class="anchor"/><span id="line-199" class="anchor"/><span id="line-200" class="anchor"/><span id="line-201" class="anchor"/><span id="line-202" class="anchor"/><span id="line-203"
class="anchor"/><span id="line-204" class="anchor"/><span id="line-205" class="anchor"/><span id="line-206" class="anchor"/><span id="line-207" class="anchor"/><span id="line-208" class="anchor"/><span id="line-209" class="anchor"/><span id="line-210" class="anchor"/><span id="line-211" class="anchor"/><span id="line-212" class="anchor"/><span id="line-213" class="anchor"/><span id="line-214" class="anchor"/><span id="line-215" class="anchor"/><span id="line-216" class="anchor"/><span id="line-217" class="anchor"/><span id="line-218" class="anchor"/><span id="line-219" class="anchor"/><span id="line-220" class="anchor"/><span id="line-221" class="anchor"/><span id="line-222" class="anchor"/><span id="line-223" class="anchor"/><span id="line-224" class="anchor"/><span
id="line-225" class="anchor"/><span id="line-226" class="anchor"/><span id="line-227" class="anchor"/><span id="line-228" class="anchor"/><span id="line-229" class="anchor"/><span id="line-230" class="anchor"/><span id="line-231" class="anchor"/><span id="line-232" class="anchor"/><span id="line-233" class="anchor"/><span id="line-234" class="anchor"/><span id="line-235" class="anchor"/><span id="line-236" class="anchor"/><span id="line-237" class="anchor"/><span id="line-238" class="anchor"/><span id="line-239" class="anchor"/><span id="line-240" class="anchor"/><span id="line-241" class="anchor"/><span id="line-242" class="anchor"/><span id="line-243" class="anchor"/><span id="line-244" class="anchor"/><span id="line-245" class="anchor"/><span id="line-246"
class="anchor"/><span id="line-247" class="anchor"/><span id="line-248" class="anchor"/><span id="line-249" class="anchor"/><span id="line-250" class="anchor"/><span id="line-251" class="anchor"/><span id="line-252" class="anchor"/><span id="line-253" class="anchor"/><span id="line-254" class="anchor"/><span id="line-255" class="anchor"/><span id="line-256" class="anchor"/><span id="line-257" class="anchor"/><span id="line-258" class="anchor"/><span id="line-259" class="anchor"/><span id="line-260" class="anchor"/><span id="line-261" class="anchor"/><span id="line-262" class="anchor"/><span id="line-263" class="anchor"/><span id="line-264" class="anchor"/><span id="line-265" class="anchor"/><span id="line-266" class="anchor"/><span id="line-267" class="anchor"/><span
id="line-268" class="anchor"/><span id="line-269" class="anchor"/><span id="line-270" class="anchor"/><span id="line-271" class="anchor"/><span id="line-272" class="anchor"/><span id="line-273" class="anchor"/><span id="line-274" class="anchor"/><span id="line-275" class="anchor"/><span id="line-276" class="anchor"/><span id="line-277" class="anchor"/><span id="line-278" class="anchor"/><span id="line-279" class="anchor"/><span id="line-280" class="anchor"/><span id="line-281" class="anchor"/><span id="line-282" class="anchor"/><span id="line-283" class="anchor"/><span id="line-284" class="anchor"/><span id="line-285" class="anchor"/><span id="line-286" class="anchor"/><span id="line-287" class="anchor"/><span id="line-288" class="anchor"/><span id="line-289"
class="anchor"/><span id="line-290" class="anchor"/><span id="line-291" class="anchor"/><span id="line-292" class="anchor"/><span id="line-293" class="anchor"/><span id="line-294" class="anchor"/><span id="line-295" class="anchor"/><span id="line-296" class="anchor"/><span id="line-297" class="anchor"/><span id="line-298" class="anchor"/><span id="line-299" class="anchor"/><span id="line-300" class="anchor"/><span id="line-301" class="anchor"/><span id="line-302" class="anchor"/><span id="line-303" class="anchor"/><span id="line-304" class="anchor"/><span id="line-305" class="anchor"/><span id="line-306" class="anchor"/><span id="line-307" class="anchor"/><span id="line-308" class="anchor"/><span id="line-309" class="anchor"/><span id="line-310" class="anchor"/><span
id="line-311" class="anchor"/><span id="line-312" class="anchor"/><span id="line-313" class="anchor"/><span id="line-314" class="anchor"/><span id="line-315" class="anchor"/><span id="line-316" class="anchor"/><span id="line-317" class="anchor"/><span id="line-318" class="anchor"/><span id="line-319" class="anchor"/><span id="line-320" class="anchor"/><span id="line-321" class="anchor"/><span id="line-322" class="anchor"/><span id="line-323" class="anchor"/><span id="line-324" class="anchor"/><span id="line-325" class="anchor"/><span id="line-326" class="anchor"/><span id="line-327" class="anchor"/><span id="line-328" class="anchor"/><span id="line-329" class="anchor"/><span id="line-330" class="anchor"/><span id="line-331" class="anchor"/><span id="line-332"
class="anchor"/><span id="line-333" class="anchor"/><span id="line-334" class="anchor"/><span id="line-335" class="anchor"/><span id="line-336" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
function isnumbered(obj) {
return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
var nlen = Math.max(0,chrs-(''+num).length), res = '';
while (nlen>0) { res += ' '; nlen-- }
return res+num+add;
}
function addnumber(did, nstart, nstep) {
var c = document.getElementById(did), l = c.firstChild, n = 1;
if (!isnumbered(c))
if (typeof nstart == 'undefined') nstart = 1;
if (typeof nstep  == 'undefined') nstep = 1;
n = nstart;
while (l != null) {
if (l.tagName == 'SPAN') {
var s = document.createElement('SPAN');
s.className = 'LineNumber'
s.appendChild(document.createTextNode(nformat(n,4,' ')));
n += nstep;
if (l.childNodes.length)
l.insertBefore(s, l.firstChild)
else
l.appendChild(s)
}
l = l.nextSibling;
}
return false;
}
function remnumber(did) {
var c = document.getElementById(did), l = c.firstChild;
if (isnumbered(c))
while (l != null) {
if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
l = l.nextSibling;
}
return false;
}
function togglenumber(did, nstart, nstep) {
var c = document.getElementById(did);
if (isnumbered(c)) {
remnumber(did);
} else {
addnumber(did,nstart,nstep);
}
return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-1ecfdedbe6db92ba98ba683a5b827ef9a31267bd_000\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-1ecfdedbe6db92ba98ba683a5b827ef9a31267bd_000', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-1ecfdedbe6db92ba98ba683a5b827ef9a31267bd_000" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="Comment">#!/usr/bin/python</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="Comment"/><span class="Comment"># tetris.py</span></span>
<span class="line"><span class="LineNumber">   3 </span><span class="Comment"/><span class="ResWord">import</span> <span class="ID">sys</span></span>
<span class="line"><span class="LineNumber">   4 </span><span class="ResWord">import</span> <span class="ID">random</span></span>
<span class="line"><span class="LineNumber">   5 </span><span class="ResWord">from</span> <span class="ID">PyQt4</span> <span class="ResWord">import</span> <span class="ID">QtCore</span><span class="Operator">,</span> <span class="ID">QtGui</span></span>
<span class="line"><span class="LineNumber">   6 </span><span class="ResWord">class</span> <span class="ID">Tetris</span><span class="Operator">(</span><span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QMainWindow</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   7 </span>    <span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   8 </span>        <span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QMainWindow</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   9 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">setGeometry</span><span class="Operator">(</span><span class="Number">300</span><span class="Operator">,</span> <span class="Number">300</span><span class="Operator">,</span> <span class="Number">180</span><span class="Operator">,</span> <span class="Number">380</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  10 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">setWindowTitle</span><span class="Operator">(</span><span class="String">'Tetris'</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">tetrisboard</span> <span class="Operator">=</span> <span class="ID">Board</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  12 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">setCentralWidget</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">tetrisboard</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  13 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusBar</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  14 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">connect</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">tetrisboard</span><span class="Operator">,</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">SIGNAL</span><span class="Operator">(</span><span class="String">"messageToStatusbar(QString)"</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  15 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">statusbar</span><span class="Operator">,</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">SLOT</span><span class="Operator">(</span><span class="String">"showMessage(QString)"</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  16 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">tetrisboard</span><span class="Operator">.</span><span class="ID">start</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  17 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">center</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  18 </span>    <span class="ResWord">def</span> <span class="ID">center</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  19 </span>        <span class="ID">screen</span> <span class="Operator">=</span> <span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QDesktopWidget</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">.</span><span class="ID">screenGeometry</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  20 </span>        <span class="ID">size</span> <span class="Operator">=</span>  <span class="ID">self</span><span class="Operator">.</span><span class="ID">geometry</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  21 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">move</span><span class="Operator">(</span><span class="Operator">(</span><span class="ID">screen</span><span class="Operator">.</span><span class="ID">width</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">-</span><span class="ID">size</span><span class="Operator">.</span><span class="ID">width</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span><span
class="Operator">/</span><span class="Number">2</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  22 </span>            <span class="Operator">(</span><span class="ID">screen</span><span class="Operator">.</span><span class="ID">height</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">-</span><span class="ID">size</span><span class="Operator">.</span><span class="ID">height</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">/</span><span class="Number">2</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  23 </span><span class="ResWord">class</span> <span class="ID">Board</span><span class="Operator">(</span><span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QFrame</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  24 </span>    <span class="ID">BoardWidth</span> <span class="Operator">=</span> <span class="Number">10</span></span>
<span class="line"><span class="LineNumber">  25 </span>    <span class="ID">BoardHeight</span> <span class="Operator">=</span> <span class="Number">22</span></span>
<span class="line"><span class="LineNumber">  26 </span>    <span class="ID">Speed</span> <span class="Operator">=</span> <span class="Number">300</span></span>
<span class="line"><span class="LineNumber">  27 </span>    <span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  28 </span>        <span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QFrame</span><span class="Operator">.</span><span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">parent</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  29 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">timer</span> <span class="Operator">=</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">QBasicTimer</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  30 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">isWaitingAfterLine</span> <span class="Operator">=</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber">  31 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span> <span class="Operator">=</span> <span class="ID">Shape</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  32 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">nextPiece</span> <span class="Operator">=</span> <span class="ID">Shape</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  33 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">=</span> <span class="Number">0</span></span>
<span class="line"><span class="LineNumber">  34 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span> <span class="Operator">=</span> <span class="Number">0</span></span>
<span class="line"><span class="LineNumber">  35 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">numLinesRemoved</span> <span class="Operator">=</span> <span class="Number">0</span></span>
<span class="line"><span class="LineNumber">  36 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">board</span> <span class="Operator">=</span> <span class="Operator">[</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  37 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">setFocusPolicy</span><span class="Operator">(</span><span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">Qt</span><span class="Operator">.</span><span class="ID">StrongFocus</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  38 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">isStarted</span> <span class="Operator">=</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber">  39 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">isPaused</span> <span class="Operator">=</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber">  40 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">clearBoard</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  41 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">nextPiece</span><span class="Operator">.</span><span class="ID">setRandomShape</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  42 </span>    <span class="ResWord">def</span> <span class="ID">shapeAt</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">x</span><span class="Operator">,</span> <span class="ID">y</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  43 </span>        <span class="ResWord">return</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">board</span><span class="Operator">[</span><span class="Operator">(</span><span class="ID">y</span> <span class="Operator">*</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span><span class="Operator">)</span> <span class="Operator">+</span> <span class="ID">x</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">  44 </span>    <span class="ResWord">def</span> <span class="ID">setShapeAt</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">x</span><span class="Operator">,</span> <span class="ID">y</span><span class="Operator">,</span> <span class="ID">shape</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  45 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">board</span><span class="Operator">[</span><span class="Operator">(</span><span class="ID">y</span> <span class="Operator">*</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span><span class="Operator">)</span> <span class="Operator">+</span> <span class="ID">x</span><span class="Operator">]</span> <span class="Operator">=</span> <span class="ID">shape</span></span>
<span class="line"><span class="LineNumber">  46 </span>    <span class="ResWord">def</span> <span class="ID">squareWidth</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  47 </span>        <span class="ResWord">return</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">contentsRect</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">.</span><span class="ID">width</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">/</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span></span>
<span class="line"><span class="LineNumber">  48 </span>    <span class="ResWord">def</span> <span class="ID">squareHeight</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  49 </span>        <span class="ResWord">return</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">contentsRect</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">.</span><span class="ID">height</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">/</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span></span>
<span class="line"><span class="LineNumber">  50 </span>    <span class="ResWord">def</span> <span class="ID">start</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  51 </span>        <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">isPaused</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  52 </span>            <span class="ResWord">return</span></span>
<span class="line"><span class="LineNumber">  53 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">isStarted</span> <span class="Operator">=</span> <span class="ID">True</span></span>
<span class="line"><span class="LineNumber">  54 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">isWaitingAfterLine</span> <span class="Operator">=</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber">  55 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">numLinesRemoved</span> <span class="Operator">=</span> <span class="Number">0</span></span>
<span class="line"><span class="LineNumber">  56 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">clearBoard</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  57 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">emit</span><span class="Operator">(</span><span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">SIGNAL</span><span class="Operator">(</span><span class="String">"messageToStatusbar(QString)"</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  58 </span>            <span class="ID">str</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">numLinesRemoved</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  59 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">newPiece</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  60 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">timer</span><span class="Operator">.</span><span class="ID">start</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">Speed</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  61 </span>    <span class="ResWord">def</span> <span class="ID">pause</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  62 </span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">isStarted</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  63 </span>            <span class="ResWord">return</span></span>
<span class="line"><span class="LineNumber">  64 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">isPaused</span> <span class="Operator">=</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">isPaused</span></span>
<span class="line"><span class="LineNumber">  65 </span>        <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">isPaused</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  66 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">timer</span><span class="Operator">.</span><span class="ID">stop</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  67 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">emit</span><span class="Operator">(</span><span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">SIGNAL</span><span class="Operator">(</span><span class="String">"messageToStatusbar(QString)"</span><span class="Operator">)</span><span class="Operator">,</span> <span class="String">"paused"</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  68 </span>        <span class="ResWord">else</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  69 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">timer</span><span class="Operator">.</span><span class="ID">start</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">Speed</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  70 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">emit</span><span class="Operator">(</span><span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">SIGNAL</span><span class="Operator">(</span><span class="String">"messageToStatusbar(QString)"</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  71 </span>                <span class="ID">str</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">numLinesRemoved</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  72 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">update</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  73 </span>    <span class="ResWord">def</span> <span class="ID">paintEvent</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  74 </span>        <span class="ID">painter</span> <span class="Operator">=</span> <span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QPainter</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  75 </span>        <span class="ID">rect</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">contentsRect</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  76 </span>        <span class="ID">boardTop</span> <span class="Operator">=</span> <span class="ID">rect</span><span class="Operator">.</span><span class="ID">bottom</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">-</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareHeight</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  77 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  78 </span>            <span class="ResWord">for</span> <span class="ID">j</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  79 </span>                <span class="ID">shape</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">shapeAt</span><span class="Operator">(</span><span class="ID">j</span><span class="Operator">,</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span> <span class="Operator">-</span> <span class="ID">i</span> <span class="Operator">-</span> <span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  80 </span>                <span class="ResWord">if</span> <span class="ID">shape</span> <span class="Operator">!=</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  81 </span>                    <span class="ID">self</span><span class="Operator">.</span><span class="ID">drawSquare</span><span class="Operator">(</span><span class="ID">painter</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  82 </span>                        <span class="ID">rect</span><span class="Operator">.</span><span class="ID">left</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">+</span> <span class="ID">j</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareWidth</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  83 </span>                        <span class="ID">boardTop</span> <span class="Operator">+</span> <span class="ID">i</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareHeight</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">,</span> <span class="ID">shape</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  84 </span>        <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">shape</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">!=</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  85 </span>            <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  86 </span>                <span class="ID">x</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">x</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  87 </span>                <span class="ID">y</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span> <span class="Operator">-</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">y</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  88 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">drawSquare</span><span class="Operator">(</span><span class="ID">painter</span><span class="Operator">,</span> <span class="ID">rect</span><span class="Operator">.</span><span class="ID">left</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">+</span> <span class="ID">x</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareWidth</span><span
class="Operator">(</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  89 </span>                    <span class="ID">boardTop</span> <span class="Operator">+</span> <span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span> <span class="Operator">-</span> <span class="ID">y</span> <span class="Operator">-</span> <span class="Number">1</span><span class="Operator">)</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareHeight</span><span class="Operator">(</span><span
class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">  90 </span>                    <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">shape</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  91 </span>    <span class="ResWord">def</span> <span class="ID">keyPressEvent</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  92 </span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">isStarted</span> <span class="ResWord">or</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">shape</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">==</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span
class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  93 </span>            <span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QWidget</span><span class="Operator">.</span><span class="ID">keyPressEvent</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  94 </span>            <span class="ResWord">return</span></span>
<span class="line"><span class="LineNumber">  95 </span>        <span class="ID">key</span> <span class="Operator">=</span> <span class="ID">event</span><span class="Operator">.</span><span class="ID">key</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  96 </span>        <span class="ResWord">if</span> <span class="ID">key</span> <span class="Operator">==</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">Qt</span><span class="Operator">.</span><span class="ID">Key_P</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  97 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">pause</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  98 </span>            <span class="ResWord">return</span></span>
<span class="line"><span class="LineNumber">  99 </span>        <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">isPaused</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 100 </span>            <span class="ResWord">return</span></span>
<span class="line"><span class="LineNumber"> 101 </span>        <span class="ResWord">elif</span> <span class="ID">key</span> <span class="Operator">==</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">Qt</span><span class="Operator">.</span><span class="ID">Key_Left</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 102 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">-</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span><span
class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 103 </span>        <span class="ResWord">elif</span> <span class="ID">key</span> <span class="Operator">==</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">Qt</span><span class="Operator">.</span><span class="ID">Key_Right</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 104 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">+</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span><span
class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 105 </span>        <span class="ResWord">elif</span> <span class="ID">key</span> <span class="Operator">==</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">Qt</span><span class="Operator">.</span><span class="ID">Key_Down</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 106 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">rotatedRight</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span><span class="Operator">,</span> <span class="ID">self</span><span
class="Operator">.</span><span class="ID">curY</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 107 </span>        <span class="ResWord">elif</span> <span class="ID">key</span> <span class="Operator">==</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">Qt</span><span class="Operator">.</span><span class="ID">Key_Up</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 108 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">rotatedLeft</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span><span class="Operator">,</span> <span class="ID">self</span><span
class="Operator">.</span><span class="ID">curY</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 109 </span>        <span class="ResWord">elif</span> <span class="ID">key</span> <span class="Operator">==</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">Qt</span><span class="Operator">.</span><span class="ID">Key_Space</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 110 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">dropDown</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 111 </span>        <span class="ResWord">elif</span> <span class="ID">key</span> <span class="Operator">==</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">Qt</span><span class="Operator">.</span><span class="ID">Key_D</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 112 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">oneLineDown</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 113 </span>        <span class="ResWord">else</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 114 </span>            <span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QWidget</span><span class="Operator">.</span><span class="ID">keyPressEvent</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 115 </span>    <span class="ResWord">def</span> <span class="ID">timerEvent</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 116 </span>        <span class="ResWord">if</span> <span class="ID">event</span><span class="Operator">.</span><span class="ID">timerId</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">==</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">timer</span><span class="Operator">.</span><span class="ID">timerId</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 117 </span>            <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">isWaitingAfterLine</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 118 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">isWaitingAfterLine</span> <span class="Operator">=</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber"> 119 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">newPiece</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 120 </span>            <span class="ResWord">else</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 121 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">oneLineDown</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 122 </span>        <span class="ResWord">else</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 123 </span>            <span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QFrame</span><span class="Operator">.</span><span class="ID">timerEvent</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 124 </span>    <span class="ResWord">def</span> <span class="ID">clearBoard</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 125 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span> <span class="Operator">*</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 126 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">board</span><span class="Operator">.</span><span class="ID">append</span><span class="Operator">(</span><span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 127 </span>    <span class="ResWord">def</span> <span class="ID">dropDown</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 128 </span>        <span class="ID">newY</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span></span>
<span class="line"><span class="LineNumber"> 129 </span>        <span class="ResWord">while</span> <span class="ID">newY</span> <span class="Operator">></span> <span class="Number">0</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 130 </span>            <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span><span class="Operator">,</span> <span class="ID">newY</span> <span class="Operator">-</span> <span class="Number">1</span><span
class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 131 </span>                <span class="ResWord">break</span></span>
<span class="line"><span class="LineNumber"> 132 </span>            <span class="ID">newY</span> <span class="Operator">-=</span> <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"> 133 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">pieceDropped</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 134 </span>    <span class="ResWord">def</span> <span class="ID">oneLineDown</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 135 </span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span> <span
class="Operator">-</span> <span class="Number">1</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 136 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">pieceDropped</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 137 </span>    <span class="ResWord">def</span> <span class="ID">pieceDropped</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 138 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 139 </span>            <span class="ID">x</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">x</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 140 </span>            <span class="ID">y</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span> <span class="Operator">-</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">y</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 141 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">setShapeAt</span><span class="Operator">(</span><span class="ID">x</span><span class="Operator">,</span> <span class="ID">y</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">shape</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 142 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">removeFullLines</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 143 </span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">isWaitingAfterLine</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 144 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">newPiece</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 145 </span>    <span class="ResWord">def</span> <span class="ID">removeFullLines</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 146 </span>        <span class="ID">numFullLines</span> <span class="Operator">=</span> <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"> 147 </span>        <span class="ID">rowsToRemove</span> <span class="Operator">=</span> <span class="Operator">[</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 148 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 149 </span>            <span class="ID">n</span> <span class="Operator">=</span> <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"> 150 </span>            <span class="ResWord">for</span> <span class="ID">j</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 151 </span>                <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">shapeAt</span><span class="Operator">(</span><span class="ID">j</span><span class="Operator">,</span> <span class="ID">i</span><span class="Operator">)</span> <span class="Operator">==</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 152 </span>                    <span class="ID">n</span> <span class="Operator">=</span> <span class="ID">n</span> <span class="Operator">+</span> <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"> 153 </span>            <span class="ResWord">if</span> <span class="ID">n</span> <span class="Operator">==</span> <span class="Number">10</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 154 </span>                <span class="ID">rowsToRemove</span><span class="Operator">.</span><span class="ID">append</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 155 </span>        <span class="ID">rowsToRemove</span><span class="Operator">.</span><span class="ID">reverse</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 156 </span>        <span class="ResWord">for</span> <span class="ID">m</span> <span class="ResWord">in</span> <span class="ID">rowsToRemove</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 157 </span>            <span class="ResWord">for</span> <span class="ID">k</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">m</span><span class="Operator">,</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 158 </span>                <span class="ResWord">for</span> <span class="ID">l</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 159 </span>                    <span class="ID">self</span><span class="Operator">.</span><span class="ID">setShapeAt</span><span class="Operator">(</span><span class="ID">l</span><span class="Operator">,</span> <span class="ID">k</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">shapeAt</span><span class="Operator">(</span><span class="ID">l</span><span class="Operator">,</span> <span class="ID">k</span> <span class="Operator">+</span> <span class="Number">1</span><span
class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 160 </span>        <span class="ID">numFullLines</span> <span class="Operator">=</span> <span class="ID">numFullLines</span> <span class="Operator">+</span> <span class="ID">len</span><span class="Operator">(</span><span class="ID">rowsToRemove</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 161 </span>        <span class="ResWord">if</span> <span class="ID">numFullLines</span> <span class="Operator">></span> <span class="Number">0</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 162 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">numLinesRemoved</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">numLinesRemoved</span> <span class="Operator">+</span> <span class="ID">numFullLines</span></span>
<span class="line"><span class="LineNumber"> 163 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">emit</span><span class="Operator">(</span><span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">SIGNAL</span><span class="Operator">(</span><span class="String">"messageToStatusbar(QString)"</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 164 </span>                <span class="ID">str</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">numLinesRemoved</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 165 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">isWaitingAfterLine</span> <span class="Operator">=</span> <span class="ID">True</span></span>
<span class="line"><span class="LineNumber"> 166 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">setShape</span><span class="Operator">(</span><span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 167 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">update</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 168 </span>    <span class="ResWord">def</span> <span class="ID">newPiece</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 169 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">nextPiece</span></span>
<span class="line"><span class="LineNumber"> 170 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">nextPiece</span><span class="Operator">.</span><span class="ID">setRandomShape</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 171 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">=</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span> <span class="Operator">/</span> <span class="Number">2</span> <span class="Operator">+</span> <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"> 172 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span> <span class="Operator">=</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span> <span class="Operator">-</span> <span class="Number">1</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">minY</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 173 </span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span><span
class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 174 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">setShape</span><span class="Operator">(</span><span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 175 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">timer</span><span class="Operator">.</span><span class="ID">stop</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 176 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">isStarted</span> <span class="Operator">=</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber"> 177 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">emit</span><span class="Operator">(</span><span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">SIGNAL</span><span class="Operator">(</span><span class="String">"messageToStatusbar(QString)"</span><span class="Operator">)</span><span class="Operator">,</span> <span class="String">"Game over"</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 178 </span>    <span class="ResWord">def</span> <span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">newPiece</span><span class="Operator">,</span> <span class="ID">newX</span><span class="Operator">,</span> <span class="ID">newY</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 179 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 180 </span>            <span class="ID">x</span> <span class="Operator">=</span> <span class="ID">newX</span> <span class="Operator">+</span> <span class="ID">newPiece</span><span class="Operator">.</span><span class="ID">x</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 181 </span>            <span class="ID">y</span> <span class="Operator">=</span> <span class="ID">newY</span> <span class="Operator">-</span> <span class="ID">newPiece</span><span class="Operator">.</span><span class="ID">y</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 182 </span>            <span class="ResWord">if</span> <span class="ID">x</span> <span class="Operator"><</span> <span class="Number">0</span> <span class="ResWord">or</span> <span class="ID">x</span> <span class="Operator">>=</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span> <span class="ResWord">or</span> <span class="ID">y</span> <span class="Operator"><</span> <span class="Number">0</span> <span class="ResWord">or</span> <span class="ID">y</span> <span class="Operator">>=</span> <span
class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 183 </span>                <span class="ResWord">return</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber"> 184 </span>            <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">shapeAt</span><span class="Operator">(</span><span class="ID">x</span><span class="Operator">,</span> <span class="ID">y</span><span class="Operator">)</span> <span class="Operator">!=</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 185 </span>                <span class="ResWord">return</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber"> 186 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span> <span class="Operator">=</span> <span class="ID">newPiece</span></span>
<span class="line"><span class="LineNumber"> 187 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">=</span> <span class="ID">newX</span></span>
<span class="line"><span class="LineNumber"> 188 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span> <span class="Operator">=</span> <span class="ID">newY</span></span>
<span class="line"><span class="LineNumber"> 189 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">update</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 190 </span>        <span class="ResWord">return</span> <span class="ID">True</span></span>
<span class="line"><span class="LineNumber"> 191 </span>    <span class="ResWord">def</span> <span class="ID">drawSquare</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">painter</span><span class="Operator">,</span> <span class="ID">x</span><span class="Operator">,</span> <span class="ID">y</span><span class="Operator">,</span> <span class="ID">shape</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 192 </span>        <span class="ID">colorTable</span> <span class="Operator">=</span> <span class="Operator">[</span><span class="Number">0x000000</span><span class="Operator">,</span> <span class="Number">0xCC6666</span><span class="Operator">,</span> <span class="Number">0x66CC66</span><span class="Operator">,</span> <span class="Number">0x6666CC</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 193 </span>                      <span class="Number">0xCCCC66</span><span class="Operator">,</span> <span class="Number">0xCC66CC</span><span class="Operator">,</span> <span class="Number">0x66CCCC</span><span class="Operator">,</span> <span class="Number">0xDAAA00</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 194 </span>        <span class="ID">color</span> <span class="Operator">=</span> <span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QColor</span><span class="Operator">(</span><span class="ID">colorTable</span><span class="Operator">[</span><span class="ID">shape</span><span class="Operator">]</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 195 </span>        <span class="ID">painter</span><span class="Operator">.</span><span class="ID">fillRect</span><span class="Operator">(</span><span class="ID">x</span> <span class="Operator">+</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">y</span> <span class="Operator">+</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareWidth</span><span class="Operator">(</span><span class="Operator">)</span> <span
class="Operator">-</span> <span class="Number">2</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 196 </span>            <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareHeight</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">-</span> <span class="Number">2</span><span class="Operator">,</span> <span class="ID">color</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 197 </span>        <span class="ID">painter</span><span class="Operator">.</span><span class="ID">setPen</span><span class="Operator">(</span><span class="ID">color</span><span class="Operator">.</span><span class="ID">light</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 198 </span>        <span class="ID">painter</span><span class="Operator">.</span><span class="ID">drawLine</span><span class="Operator">(</span><span class="ID">x</span><span class="Operator">,</span> <span class="ID">y</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareHeight</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">-</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">x</span><span
class="Operator">,</span> <span class="ID">y</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 199 </span>        <span class="ID">painter</span><span class="Operator">.</span><span class="ID">drawLine</span><span class="Operator">(</span><span class="ID">x</span><span class="Operator">,</span> <span class="ID">y</span><span class="Operator">,</span> <span class="ID">x</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareWidth</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">-</span> <span class="Number">1</span><span
class="Operator">,</span> <span class="ID">y</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 200 </span>        <span class="ID">painter</span><span class="Operator">.</span><span class="ID">setPen</span><span class="Operator">(</span><span class="ID">color</span><span class="Operator">.</span><span class="ID">dark</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 201 </span>        <span class="ID">painter</span><span class="Operator">.</span><span class="ID">drawLine</span><span class="Operator">(</span><span class="ID">x</span> <span class="Operator">+</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">y</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareHeight</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">-</span> <span class="Number">1</span><span
class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 202 </span>            <span class="ID">x</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareWidth</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">-</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">y</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareHeight</span><span class="Operator">(</span><span class="Operator">)</span> <span
class="Operator">-</span> <span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 203 </span>        <span class="ID">painter</span><span class="Operator">.</span><span class="ID">drawLine</span><span class="Operator">(</span><span class="ID">x</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareWidth</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">-</span> <span class="Number">1</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 204 </span>            <span class="ID">y</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareHeight</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">-</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">x</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareWidth</span><span class="Operator">(</span><span class="Operator">)</span> <span
class="Operator">-</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">y</span> <span class="Operator">+</span> <span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 205 </span><span class="ResWord">class</span> <span class="ID">Tetrominoes</span><span class="Operator">(</span><span class="ID">object</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 206 </span>    <span class="ID">NoShape</span> <span class="Operator">=</span> <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"> 207 </span>    <span class="ID">ZShape</span> <span class="Operator">=</span> <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"> 208 </span>    <span class="ID">SShape</span> <span class="Operator">=</span> <span class="Number">2</span></span>
<span class="line"><span class="LineNumber"> 209 </span>    <span class="ID">LineShape</span> <span class="Operator">=</span> <span class="Number">3</span></span>
<span class="line"><span class="LineNumber"> 210 </span>    <span class="ID">TShape</span> <span class="Operator">=</span> <span class="Number">4</span></span>
<span class="line"><span class="LineNumber"> 211 </span>    <span class="ID">SquareShape</span> <span class="Operator">=</span> <span class="Number">5</span></span>
<span class="line"><span class="LineNumber"> 212 </span>    <span class="ID">LShape</span> <span class="Operator">=</span> <span class="Number">6</span></span>
<span class="line"><span class="LineNumber"> 213 </span>    <span class="ID">MirroredLShape</span> <span class="Operator">=</span> <span class="Number">7</span></span>
<span class="line"><span class="LineNumber"> 214 </span><span class="ResWord">class</span> <span class="ID">Shape</span><span class="Operator">(</span><span class="ID">object</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 215 </span>    <span class="ID">coordsTable</span> <span class="Operator">=</span> <span class="Operator">(</span></span>
<span class="line"><span class="LineNumber"> 216 </span>        <span class="Operator">(</span><span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span
class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 217 </span>        <span class="Operator">(</span><span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span><span class="Operator">,</span>    <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Operator">-</span><span class="Number">1</span><span
class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>    <span class="Operator">(</span><span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 218 </span>        <span class="Operator">(</span><span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span><span class="Operator">,</span>    <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">1</span><span class="Operator">,</span> <span
class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">1</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 219 </span>        <span class="Operator">(</span><span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span><span class="Operator">,</span>    <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span
class="Number">1</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">2</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 220 </span>        <span class="Operator">(</span><span class="Operator">(</span><span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>    <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">1</span><span class="Operator">,</span> <span
class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 221 </span>        <span class="Operator">(</span><span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">1</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">1</span><span
class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">1</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 222 </span>        <span class="Operator">(</span><span class="Operator">(</span><span class="Operator">-</span><span class="Number">1</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span><span class="Operator">,</span>   <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span><span class="Operator">,</span>    <span class="Operator">(</span><span
class="Number">0</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">)</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber"> 223 </span>        <span class="Operator">(</span><span class="Operator">(</span><span class="Number">1</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span><span class="Operator">,</span>    <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">)</span><span class="Operator">,</span>    <span class="Operator">(</span><span class="Number">0</span><span
class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span><span class="Operator">,</span>     <span class="Operator">(</span><span class="Number">0</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 224 </span>    <span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 225 </span>    <span class="ResWord">def</span> <span class="ID">__init__</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 226 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span> <span class="Operator">=</span> <span class="Operator">[</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">,</span><span class="Number">0</span><span class="Operator">]</span> <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span
class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 227 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">pieceShape</span> <span class="Operator">=</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span></span>
<span class="line"><span class="LineNumber"> 228 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">setShape</span><span class="Operator">(</span><span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 229 </span>    <span class="ResWord">def</span> <span class="ID">shape</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 230 </span>        <span class="ResWord">return</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">pieceShape</span></span>
<span class="line"><span class="LineNumber"> 231 </span>    <span class="ResWord">def</span> <span class="ID">setShape</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">shape</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 232 </span>        <span class="ID">table</span> <span class="Operator">=</span> <span class="ID">Shape</span><span class="Operator">.</span><span class="ID">coordsTable</span><span class="Operator">[</span><span class="ID">shape</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 233 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 234 </span>            <span class="ResWord">for</span> <span class="ID">j</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">2</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 235 </span>                <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="ID">i</span><span class="Operator">]</span><span class="Operator">[</span><span class="ID">j</span><span class="Operator">]</span> <span class="Operator">=</span> <span class="ID">table</span><span class="Operator">[</span><span class="ID">i</span><span class="Operator">]</span><span class="Operator">[</span><span class="ID">j</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 236 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">pieceShape</span> <span class="Operator">=</span> <span class="ID">shape</span></span>
<span class="line"><span class="LineNumber"> 237 </span>    <span class="ResWord">def</span> <span class="ID">setRandomShape</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 238 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">setShape</span><span class="Operator">(</span><span class="ID">random</span><span class="Operator">.</span><span class="ID">randint</span><span class="Operator">(</span><span class="Number">1</span><span class="Operator">,</span> <span class="Number">7</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 239 </span>    <span class="ResWord">def</span> <span class="ID">x</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">index</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 240 </span>        <span class="ResWord">return</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="ID">index</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 241 </span>    <span class="ResWord">def</span> <span class="ID">y</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">index</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 242 </span>        <span class="ResWord">return</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="ID">index</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">1</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 243 </span>    <span class="ResWord">def</span> <span class="ID">setX</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">index</span><span class="Operator">,</span> <span class="ID">x</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 244 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="ID">index</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span> <span class="Operator">=</span> <span class="ID">x</span></span>
<span class="line"><span class="LineNumber"> 245 </span>    <span class="ResWord">def</span> <span class="ID">setY</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">index</span><span class="Operator">,</span> <span class="ID">y</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 246 </span>        <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="ID">index</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">1</span><span class="Operator">]</span> <span class="Operator">=</span> <span class="ID">y</span></span>
<span class="line"><span class="LineNumber"> 247 </span>    <span class="ResWord">def</span> <span class="ID">minX</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 248 </span>        <span class="ID">m</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 249 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 250 </span>            <span class="ID">m</span> <span class="Operator">=</span> <span class="ID">min</span><span class="Operator">(</span><span class="ID">m</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="ID">i</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 251 </span>        <span class="ResWord">return</span> <span class="ID">m</span></span>
<span class="line"><span class="LineNumber"> 252 </span>    <span class="ResWord">def</span> <span class="ID">maxX</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 253 </span>        <span class="ID">m</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 254 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 255 </span>            <span class="ID">m</span> <span class="Operator">=</span> <span class="ID">max</span><span class="Operator">(</span><span class="ID">m</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="ID">i</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 256 </span>        <span class="ResWord">return</span> <span class="ID">m</span></span>
<span class="line"><span class="LineNumber"> 257 </span>    <span class="ResWord">def</span> <span class="ID">minY</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 258 </span>        <span class="ID">m</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">1</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 259 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 260 </span>            <span class="ID">m</span> <span class="Operator">=</span> <span class="ID">min</span><span class="Operator">(</span><span class="ID">m</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="ID">i</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">1</span><span class="Operator">]</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 261 </span>        <span class="ResWord">return</span> <span class="ID">m</span></span>
<span class="line"><span class="LineNumber"> 262 </span>    <span class="ResWord">def</span> <span class="ID">maxY</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 263 </span>        <span class="ID">m</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="Number">0</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">1</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber"> 264 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 265 </span>            <span class="ID">m</span> <span class="Operator">=</span> <span class="ID">max</span><span class="Operator">(</span><span class="ID">m</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">coords</span><span class="Operator">[</span><span class="ID">i</span><span class="Operator">]</span><span class="Operator">[</span><span class="Number">1</span><span class="Operator">]</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 266 </span>        <span class="ResWord">return</span> <span class="ID">m</span></span>
<span class="line"><span class="LineNumber"> 267 </span>    <span class="ResWord">def</span> <span class="ID">rotatedLeft</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 268 </span>        <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">pieceShape</span> <span class="Operator">==</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">SquareShape</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 269 </span>            <span class="ResWord">return</span> <span class="ID">self</span></span>
<span class="line"><span class="LineNumber"> 270 </span>        <span class="ID">result</span> <span class="Operator">=</span> <span class="ID">Shape</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 271 </span>        <span class="ID">result</span><span class="Operator">.</span><span class="ID">pieceShape</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">pieceShape</span></span>
<span class="line"><span class="LineNumber"> 272 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 273 </span>            <span class="ID">result</span><span class="Operator">.</span><span class="ID">setX</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">y</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 274 </span>            <span class="ID">result</span><span class="Operator">.</span><span class="ID">setY</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">,</span> <span class="Operator">-</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">x</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 275 </span>        <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"> 276 </span>    <span class="ResWord">def</span> <span class="ID">rotatedRight</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 277 </span>        <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">pieceShape</span> <span class="Operator">==</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">SquareShape</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 278 </span>            <span class="ResWord">return</span> <span class="ID">self</span></span>
<span class="line"><span class="LineNumber"> 279 </span>        <span class="ID">result</span> <span class="Operator">=</span> <span class="ID">Shape</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 280 </span>        <span class="ID">result</span><span class="Operator">.</span><span class="ID">pieceShape</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">pieceShape</span></span>
<span class="line"><span class="LineNumber"> 281 </span>        <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber"> 282 </span>            <span class="ID">result</span><span class="Operator">.</span><span class="ID">setX</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">,</span> <span class="Operator">-</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">y</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 283 </span>            <span class="ID">result</span><span class="Operator">.</span><span class="ID">setY</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">x</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 284 </span>        <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"> 285 </span><span class="ID">app</span> <span class="Operator">=</span> <span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QApplication</span><span class="Operator">(</span><span class="ID">sys</span><span class="Operator">.</span><span class="ID">argv</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 286 </span><span class="ID">tetris</span> <span class="Operator">=</span> <span class="ID">Tetris</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 287 </span><span class="ID">tetris</span><span class="Operator">.</span><span class="ID">show</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber"> 288 </span><span class="ID">sys</span><span class="Operator">.</span><span class="ID">exit</span><span class="Operator">(</span><span class="ID">app</span><span class="Operator">.</span><span class="ID">exec_</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-337" class="anchor"/><p class="line867"><em>I have simplified the game a bit, so that it is easier to understand. The game starts immediately, after it is launched. We can pause the game by pressing the p key. The space key will drop the tetris piece immediately to the bottom. The game goes at constant speed, no acceleration is implemented. The score is the number of lines, that we have removed.</em> <span id="line-338" class="anchor"/><span id="line-339" class="anchor"/></p><ul><li style="list-style-type:
none;">我们对游戏作一些简化，以便于理解。游戏在启动后立刻开始。我们可以通过按'p'键暂停游戏。空格键将使俄罗斯方块立刻落到底部。游戏使用固定的速度，没有实现加速。游戏的分数是我们已经消掉的行数。 <span id="line-340" class="anchor"/></li></ul><p class="line867"><span id="line-341" class="anchor"/></p><pre> self.statusbar = self.statusBar()
<span id="line-342" class="anchor"/> self.connect(self.tetrisboard, QtCore.SIGNAL("messageToStatusbar(QString)"),
<span id="line-343" class="anchor"/>     self.statusbar, QtCore.SLOT("showMessage(QString)"))
<span id="line-344" class="anchor"/></pre><span id="line-345" class="anchor"/><p class="line867"><em>We create a statusbar, where we will display messages. We will display three possible messages. The number of lines alredy removed. The paused message and the game over message.</em> <span id="line-346" class="anchor"/><span id="line-347" class="anchor"/></p><ul><li style="list-style-type: none;">我们创建一个状态栏用来显示信息。我们将显示三种可能的信息，已经消掉的行数，暂停的消息和游戏结束的消息。 <span id="line-348" class="anchor"/></li></ul><p class="line867"><span id="line-349"
class="anchor"/></p><pre> ...
<span id="line-350" class="anchor"/> self.curX = 0
<span id="line-351" class="anchor"/> self.curY = 0
<span id="line-352" class="anchor"/> self.numLinesRemoved = 0
<span id="line-353" class="anchor"/> self.board = []
<span id="line-354" class="anchor"/> ...
<span id="line-355" class="anchor"/></pre><span id="line-356" class="anchor"/><p class="line867"><em>Before we start the game cycle, we initialize some important variables. The self.board variable is a list of numbers from 0 ... 7. It represents the position of various shapes and remains of the shapes on the board.</em> <span id="line-357" class="anchor"/><span id="line-358" class="anchor"/></p><ul><li style="list-style-type: none;">在我们开始游戏之前，我们初始化一些重要的变量。self.board变量四从0到7的数字列表。它表示不同的图形的位置和面板上剩余的图形。 <span id="line-359"
class="anchor"/></li></ul><p class="line867"><span id="line-360" class="anchor"/><span id="line-361" class="anchor"/><span id="line-362" class="anchor"/><span id="line-363" class="anchor"/><span id="line-364" class="anchor"/><span id="line-365" class="anchor"/><span id="line-366" class="anchor"/><span id="line-367" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-2fb1eddc9d9b4fad8343184892cfffc92b126800_001\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-2fb1eddc9d9b4fad8343184892cfffc92b126800_001', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-2fb1eddc9d9b4fad8343184892cfffc92b126800_001" dir="ltr"><span class="line"><span class="LineNumber">   1 </span> <span class="ResWord">for</span> <span class="ID">j</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>     <span class="ID">shape</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">shapeAt</span><span class="Operator">(</span><span class="ID">j</span><span class="Operator">,</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span> <span class="Operator">-</span> <span class="ID">i</span> <span class="Operator">-</span> <span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   3 </span>     <span class="ResWord">if</span> <span class="ID">shape</span> <span class="Operator">!=</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   4 </span>         <span class="ID">self</span><span class="Operator">.</span><span class="ID">drawSquare</span><span class="Operator">(</span><span class="ID">painter</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   5 </span>             <span class="ID">rect</span><span class="Operator">.</span><span class="ID">left</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">+</span> <span class="ID">j</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareWidth</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   6 </span>             <span class="ID">boardTop</span> <span class="Operator">+</span> <span class="ID">i</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareHeight</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">,</span> <span class="ID">shape</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-368" class="anchor"/><p class="line867"><em>The painting of the game is divided into two steps. In the first step, we draw all the shapes, or remains of the shapes, that have been dropped to the bottom of the board. All the squares are rememberd in the self.board list variable. We access it using the shapeAt() method.</em> <span id="line-369" class="anchor"/><span id="line-370" class="anchor"/></p><ul><li style="list-style-type:
none;">游戏的显示分成两步。第一步，我们绘制所有的图形，或已经掉落在底部的剩余的图形。所有的方块被保存在self.board列表变量中。我们通过使用shapeAt()方法来访问它。 <span id="line-371" class="anchor"/></li></ul><p class="line867"><span id="line-372" class="anchor"/><span id="line-373" class="anchor"/><span id="line-374" class="anchor"/><span id="line-375" class="anchor"/><span id="line-376" class="anchor"/><span id="line-377" class="anchor"/><span id="line-378" class="anchor"/><span id="line-379" class="anchor"/><span id="line-380" class="anchor"/></p><div lang="en" dir="ltr"
class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-875c892bcd31d50e0723eaf92d8380e3f903238b_002\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-875c892bcd31d50e0723eaf92d8380e3f903238b_002', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-875c892bcd31d50e0723eaf92d8380e3f903238b_002" dir="ltr"><span class="line"><span class="LineNumber">   1 </span> <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">shape</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">!=</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>     <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   3 </span>         <span class="ID">x</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">x</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span>         <span class="ID">y</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span> <span class="Operator">-</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">y</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   5 </span>         <span class="ID">self</span><span class="Operator">.</span><span class="ID">drawSquare</span><span class="Operator">(</span><span class="ID">painter</span><span class="Operator">,</span> <span class="ID">rect</span><span class="Operator">.</span><span class="ID">left</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">+</span> <span class="ID">x</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span
class="ID">squareWidth</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   6 </span>             <span class="ID">boardTop</span> <span class="Operator">+</span> <span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span> <span class="Operator">-</span> <span class="ID">y</span> <span class="Operator">-</span> <span class="Number">1</span><span class="Operator">)</span> <span class="Operator">*</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">squareHeight</span><span class="Operator">(</span><span
class="Operator">)</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   7 </span>             <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">shape</span><span class="Operator">(</span><span class="Operator">)</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-381" class="anchor"/><p class="line867"><em>The next step is drawing of the actual piece, that is falling down.</em> <span id="line-382" class="anchor"/><span id="line-383" class="anchor"/></p><ul><li style="list-style-type: none;">下一步是绘制正在掉落的当前块。 <span id="line-384" class="anchor"/></li></ul><p class="line867"><span id="line-385" class="anchor"/><span id="line-386" class="anchor"/><span id="line-387" class="anchor"/><span id="line-388" class="anchor"/><span id="line-389" class="anchor"/><span id="line-390"
class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-a5a2937a93839610d2bfa274f5ef18ff8ee985ef_003\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-a5a2937a93839610d2bfa274f5ef18ff8ee985ef_003', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-a5a2937a93839610d2bfa274f5ef18ff8ee985ef_003" dir="ltr"><span class="line"><span class="LineNumber">   1 </span> <span class="ResWord">elif</span> <span class="ID">key</span> <span class="Operator">==</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">Qt</span><span class="Operator">.</span><span class="ID">Key_Left</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>     <span class="ID">self</span><span class="Operator">.</span><span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">-</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span
class="ID">curY</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   3 </span> <span class="ResWord">elif</span> <span class="ID">key</span> <span class="Operator">==</span> <span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">Qt</span><span class="Operator">.</span><span class="ID">Key_Right</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   4 </span>     <span class="ID">self</span><span class="Operator">.</span><span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">+</span> <span class="Number">1</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span
class="ID">curY</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-391" class="anchor"/><p class="line867"><em>In the keyPressEvent we check for pressed keys. If we press the right arrow key, we try to move the piece to the right. We say try, because the piece might not be able to move.</em> <span id="line-392" class="anchor"/><span id="line-393" class="anchor"/></p><ul><li style="list-style-type: none;">在keyPressEvent我们检查按下的按键。如果我们按下了右方向键，我们就试着向右移动块。试着是因为块可能无法移动。 <span id="line-394" class="anchor"/></li></ul><p class="line867"><span
id="line-395" class="anchor"/><span id="line-396" class="anchor"/><span id="line-397" class="anchor"/><span id="line-398" class="anchor"/><span id="line-399" class="anchor"/><span id="line-400" class="anchor"/><span id="line-401" class="anchor"/><span id="line-402" class="anchor"/><span id="line-403" class="anchor"/><span id="line-404" class="anchor"/><span id="line-405" class="anchor"/><span id="line-406" class="anchor"/><span id="line-407" class="anchor"/><span id="line-408" class="anchor"/><span id="line-409" class="anchor"/></p><div lang="en"
dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-d3588aa27a9e2dd37d8b2bb5fb4b9323af25a905_004\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-d3588aa27a9e2dd37d8b2bb5fb4b9323af25a905_004', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-d3588aa27a9e2dd37d8b2bb5fb4b9323af25a905_004" dir="ltr"><span class="line"><span class="LineNumber">   1 </span> <span class="ResWord">def</span> <span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">newPiece</span><span class="Operator">,</span> <span class="ID">newX</span><span class="Operator">,</span> <span class="ID">newY</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>     <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="Number">4</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   3 </span>         <span class="ID">x</span> <span class="Operator">=</span> <span class="ID">newX</span> <span class="Operator">+</span> <span class="ID">newPiece</span><span class="Operator">.</span><span class="ID">x</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span>         <span class="ID">y</span> <span class="Operator">=</span> <span class="ID">newY</span> <span class="Operator">-</span> <span class="ID">newPiece</span><span class="Operator">.</span><span class="ID">y</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   5 </span>         <span class="ResWord">if</span> <span class="ID">x</span> <span class="Operator"><</span> <span class="Number">0</span> <span class="ResWord">or</span> <span class="ID">x</span> <span class="Operator">>=</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span> <span class="ResWord">or</span> <span class="ID">y</span> <span class="Operator"><</span> <span class="Number">0</span> <span class="ResWord">or</span> <span
class="ID">y</span> <span class="Operator">>=</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   6 </span>             <span class="ResWord">return</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber">   7 </span>         <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">shapeAt</span><span class="Operator">(</span><span class="ID">x</span><span class="Operator">,</span> <span class="ID">y</span><span class="Operator">)</span> <span class="Operator">!=</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   8 </span>             <span class="ResWord">return</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber">   9 </span>     <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span> <span class="Operator">=</span> <span class="ID">newPiece</span></span>
<span class="line"><span class="LineNumber">  10 </span>     <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">=</span> <span class="ID">newX</span></span>
<span class="line"><span class="LineNumber">  11 </span>     <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span> <span class="Operator">=</span> <span class="ID">newY</span></span>
<span class="line"><span class="LineNumber">  12 </span>     <span class="ID">self</span><span class="Operator">.</span><span class="ID">update</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  13 </span>     <span class="ResWord">return</span> <span class="ID">True</span><span class="Text"/></span>
</pre></div><span id="line-410" class="anchor"/><p class="line867"><em>In the tryMove() method we try to move our shapes. If the shape is at the edge of the board or is adjacent to some other piece, we return false. Otherwise we place the current falling piece to a new position.</em> <span id="line-411" class="anchor"/><span id="line-412" class="anchor"/></p><ul><li style="list-style-type: none;">在tryMove()方法中，我们尽力来移动我们的块，如果块在背板的边缘或者靠在其他的块上，我们返回假，否则我们将当前块放置在新的位置。 <span
id="line-413" class="anchor"/></li></ul><p class="line867"><span id="line-414" class="anchor"/><span id="line-415" class="anchor"/><span id="line-416" class="anchor"/><span id="line-417" class="anchor"/><span id="line-418" class="anchor"/><span id="line-419" class="anchor"/><span id="line-420" class="anchor"/><span id="line-421" class="anchor"/><span id="line-422" class="anchor"/><span id="line-423" class="anchor"/><span id="line-424" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-5890f7b46d0e98d28d59e4d538f74d588722ad38_005\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-5890f7b46d0e98d28d59e4d538f74d588722ad38_005', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-5890f7b46d0e98d28d59e4d538f74d588722ad38_005" dir="ltr"><span class="line"><span class="LineNumber">   1 </span> <span class="ResWord">def</span> <span class="ID">timerEvent</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>     <span class="ResWord">if</span> <span class="ID">event</span><span class="Operator">.</span><span class="ID">timerId</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">==</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">timer</span><span class="Operator">.</span><span class="ID">timerId</span><span class="Operator">(</span><span class="Operator">)</span><span
class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   3 </span>         <span class="ResWord">if</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">isWaitingAfterLine</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   4 </span>             <span class="ID">self</span><span class="Operator">.</span><span class="ID">isWaitingAfterLine</span> <span class="Operator">=</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber">   5 </span>             <span class="ID">self</span><span class="Operator">.</span><span class="ID">newPiece</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   6 </span>         <span class="ResWord">else</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   7 </span>             <span class="ID">self</span><span class="Operator">.</span><span class="ID">oneLineDown</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span>     <span class="ResWord">else</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   9 </span>         <span class="ID">QtGui</span><span class="Operator">.</span><span class="ID">QFrame</span><span class="Operator">.</span><span class="ID">timerEvent</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">,</span> <span class="ID">event</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-425" class="anchor"/><p class="line867"><em>In the timer event, we either create a new piece, after the previous one was dropped to the bottom, or we move a falling piece one line down.</em> <span id="line-426" class="anchor"/><span id="line-427" class="anchor"/></p><ul><li style="list-style-type: none;">时间事件中，我们或者在上一个方块到达底部后创建一个新方块，或者将下落的方块向下移动一行。 <span id="line-428" class="anchor"/></li></ul><p class="line867"><span id="line-429"
class="anchor"/><span id="line-430" class="anchor"/><span id="line-431" class="anchor"/><span id="line-432" class="anchor"/><span id="line-433" class="anchor"/><span id="line-434" class="anchor"/><span id="line-435" class="anchor"/><span id="line-436" class="anchor"/><span id="line-437" class="anchor"/><span id="line-438" class="anchor"/><span id="line-439" class="anchor"/><span id="line-440" class="anchor"/><span id="line-441" class="anchor"/><span id="line-442" class="anchor"/><span id="line-443" class="anchor"/><span
id="line-444" class="anchor"/><span id="line-445" class="anchor"/><span id="line-446" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-bd0b8ac33f4bfcd34f5a27588a2c02b52ca9373e_006\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-bd0b8ac33f4bfcd34f5a27588a2c02b52ca9373e_006', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-bd0b8ac33f4bfcd34f5a27588a2c02b52ca9373e_006" dir="ltr"><span class="line"><span class="LineNumber">   1 </span> <span class="ResWord">def</span> <span class="ID">removeFullLines</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>     <span class="ID">numFullLines</span> <span class="Operator">=</span> <span class="Number">0</span></span>
<span class="line"><span class="LineNumber">   3 </span>     <span class="ID">rowsToRemove</span> <span class="Operator">=</span> <span class="Operator">[</span><span class="Operator">]</span></span>
<span class="line"><span class="LineNumber">   4 </span>     <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   5 </span>         <span class="ID">n</span> <span class="Operator">=</span> <span class="Number">0</span></span>
<span class="line"><span class="LineNumber">   6 </span>         <span class="ResWord">for</span> <span class="ID">j</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   7 </span>             <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">shapeAt</span><span class="Operator">(</span><span class="ID">j</span><span class="Operator">,</span> <span class="ID">i</span><span class="Operator">)</span> <span class="Operator">==</span> <span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span
class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   8 </span>                 <span class="ID">n</span> <span class="Operator">=</span> <span class="ID">n</span> <span class="Operator">+</span> <span class="Number">1</span></span>
<span class="line"><span class="LineNumber">   9 </span>         <span class="ResWord">if</span> <span class="ID">n</span> <span class="Operator">==</span> <span class="Number">10</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  10 </span>             <span class="ID">rowsToRemove</span><span class="Operator">.</span><span class="ID">append</span><span class="Operator">(</span><span class="ID">i</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span>             <span class="ID">rowsToRemove</span><span class="Operator">.</span><span class="ID">reverse</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  12 </span>         <span class="ResWord">for</span> <span class="ID">m</span> <span class="ResWord">in</span> <span class="ID">rowsToRemove</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  13 </span>             <span class="ResWord">for</span> <span class="ID">k</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">m</span><span class="Operator">,</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  14 </span>                 <span class="ResWord">for</span> <span class="ID">l</span> <span class="ResWord">in</span> <span class="ID">range</span><span class="Operator">(</span><span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  15 </span>                     <span class="ID">self</span><span class="Operator">.</span><span class="ID">setShapeAt</span><span class="Operator">(</span><span class="ID">l</span><span class="Operator">,</span> <span class="ID">k</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">shapeAt</span><span class="Operator">(</span><span class="ID">l</span><span class="Operator">,</span> <span
class="ID">k</span> <span class="Operator">+</span> <span class="Number">1</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  16 </span> <span class="Operator">.</span><span class="Operator">.</span><span class="Operator">.</span><span class="Text"/></span>
</pre></div><span id="line-447" class="anchor"/><p class="line867"><em>If the piece hits the bottom, we call the removeFullLines() method. First we find out all full lines. And we remove them. We do it by moving all lines above the current full line to be removed one line down. Notice, that we reverse the order of the lines to be removed. Otherwise, it would not work correctly. In our case we use a naive gravity. This means, that the pieces may be floating above empty gaps.</em> <span id="line-448"
class="anchor"/><span id="line-449" class="anchor"/></p><ul><li style="list-style-type: none;">如果方块到达了底部，我们调用removeFullLines()方法。首先我们找出所有的满行，然后我们移去他们，通过向下移动当前添满的行上的所有行来完成。注意，我们反转将要消去的行的顺序，否则它会工作不正常。这种情况我们使用简单的引力，这意味着块会浮动在缺口上面。 <span id="line-450" class="anchor"/></li></ul><p class="line867"><span id="line-451" class="anchor"/><span id="line-452" class="anchor"/><span id="line-453"
class="anchor"/><span id="line-454" class="anchor"/><span id="line-455" class="anchor"/><span id="line-456" class="anchor"/><span id="line-457" class="anchor"/><span id="line-458" class="anchor"/><span id="line-459" class="anchor"/><span id="line-460" class="anchor"/><span id="line-461" class="anchor"/><span id="line-462" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-748f0b18fa1bfdef1620796fa3ad80fc52cbabef_007\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-748f0b18fa1bfdef1620796fa3ad80fc52cbabef_007', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-748f0b18fa1bfdef1620796fa3ad80fc52cbabef_007" dir="ltr"><span class="line"><span class="LineNumber">   1 </span> <span class="ResWord">def</span> <span class="ID">newPiece</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>     <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span> <span class="Operator">=</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">nextPiece</span></span>
<span class="line"><span class="LineNumber">   3 </span>     <span class="ID">self</span><span class="Operator">.</span><span class="ID">nextPiece</span><span class="Operator">.</span><span class="ID">setRandomShape</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span>     <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span> <span class="Operator">=</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardWidth</span> <span class="Operator">/</span> <span class="Number">2</span> <span class="Operator">+</span> <span class="Number">1</span></span>
<span class="line"><span class="LineNumber">   5 </span>     <span class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span> <span class="Operator">=</span> <span class="ID">Board</span><span class="Operator">.</span><span class="ID">BoardHeight</span> <span class="Operator">-</span> <span class="Number">1</span> <span class="Operator">+</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span
class="Operator">.</span><span class="ID">minY</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   6 </span>     <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">tryMove</span><span class="Operator">(</span><span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">,</span> <span class="ID">self</span><span class="Operator">.</span><span class="ID">curX</span><span class="Operator">,</span> <span
class="ID">self</span><span class="Operator">.</span><span class="ID">curY</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   7 </span>         <span class="ID">self</span><span class="Operator">.</span><span class="ID">curPiece</span><span class="Operator">.</span><span class="ID">setShape</span><span class="Operator">(</span><span class="ID">Tetrominoes</span><span class="Operator">.</span><span class="ID">NoShape</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span>         <span class="ID">self</span><span class="Operator">.</span><span class="ID">timer</span><span class="Operator">.</span><span class="ID">stop</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   9 </span>         <span class="ID">self</span><span class="Operator">.</span><span class="ID">isStarted</span> <span class="Operator">=</span> <span class="ID">False</span></span>
<span class="line"><span class="LineNumber">  10 </span>         <span class="ID">self</span><span class="Operator">.</span><span class="ID">emit</span><span class="Operator">(</span><span class="ID">QtCore</span><span class="Operator">.</span><span class="ID">SIGNAL</span><span class="Operator">(</span><span class="String">"messageToStatusbar(QString)"</span><span class="Operator">)</span><span class="Operator">,</span> <span class="String">"Game over"</span><span
class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-463" class="anchor"/><p class="line867"><em>The newPiece() method creates randomly a new tetris piece. If the piece cannot go into it's initial position, the game is over.</em> <span id="line-464" class="anchor"/><span id="line-465" class="anchor"/></p><ul><li style="list-style-type: none;">newPiece()方法随机生成一个新的俄罗斯方块。如果方块无法进入它的初始位置，游戏结束。 <span id="line-466" class="anchor"/></li></ul><p class="line867"><em>The Shape class saves
information about the tetris piece.</em> <span id="line-467" class="anchor"/><span id="line-468" class="anchor"/></p><ul><li style="list-style-type: none;">Shape类保存方块的信息。 <span id="line-469" class="anchor"/></li></ul><p class="line867"><span id="line-470" class="anchor"/></p><pre> self.coords = [[0,0] for i in range(4)]
<span id="line-471" class="anchor"/></pre><span id="line-472" class="anchor"/><p class="line867"><em>Upon creation we create an empty coordinates list. The list will save the coordinates of the tetris piece. For example, these tuples (0, -1), (0, 0), (1, 0), (1, 1) represent a rotated S-shape. The following diagram illustrates the shape.</em> <span id="line-473" class="anchor"/><span id="line-474" class="anchor"/></p><ul><li style="list-style-type:
none;">在生成之前，我们创建一个空的坐标列表，这个列表将会保存俄罗斯方块的坐标，例如这些元组(0, -1), (0, 0), (1, 0), (1, 1)表示一个S形，以下的图形说明了形状。 <span id="line-475" class="anchor"/></li></ul><p class="line874">Coordinates Figure: Coordinates <span id="line-476" class="anchor"/><span id="line-477" class="anchor"/></p><p class="line867"><em>When we draw the current falling piece, we draw it at self.curX, self.curY position. Then we look at the coordinates table and draw all the
four squares.</em> <span id="line-478" class="anchor"/><span id="line-479" class="anchor"/></p><ul><li style="list-style-type: none;">当我们绘制当前掉落的块时，我们在self.curX，self.curY位置绘制。然后我们查找坐标表并绘制所有的四个方块。 <span id="line-480" class="anchor"/></li></ul><p class="line874">Tetris Figure: Tetris <span id="line-481" class="anchor"/><span id="line-482" class="anchor"/></p><p class="line867">
</p><h1 id="head-3c1c5519b68c10f73e762529e30ab6f7aba16e26">2. 交流</h1>
<span id="line-483" class="anchor"/><p class="line867"/><div id="pagecomment">
<a name="pagecomment1"/>
<table border="0" class="pagecomment">
<tbody><tr><td colspan="5" style="border-width: 1px; margin: 10px 0pt;">

<script language="javascript">
<!--
function setCookie(name, value) {
var today = new Date();
var expire = new Date(today.getTime() + 60*60*24*365*1000);
document.cookie = name + "=" + encodeURIComponent(value) + "; expires=" + expire.toGMTString() + "; path=/moin";
}
//-->
</script>
<form onsubmit="setCookie('PG2AUTHOR', this.comauthor.value);" method="post" name="comment" action="TheTetrisGame#pagecomment1">
<table class="addcommentform">
<tbody><tr>
<td style="border-width: 0px; vertical-align: middle; font-size: 0.9em;"><textarea onblur="if (this.value=='') {this.value='Add your comment';};" onfocus="if (this.value=='Add your comment') {this.value='';};" style="font-size: 9pt;" cols="60" rows="4" name="comtext">Add your comment</textarea></td>
<td style="border-width: 0px; font-size: 0.9em; vertical-align: bottom;"><input type="submit" style="font-size: 9pt; width: 6em; height: 3em;" value="保存" name="button_save"/></td>
</tr>
<tr><td style="border-width: 0px; vertical-align: middle; font-size: 0.9em;">
Name<input type="text" onblur="if (this.value=='') {this.value='58';};" onfocus="if (this.value=='58') {this.value='';};" value="58" name="comauthor" maxlength="20" size="6" style="font-size: 9pt;"/>
Password4deL<input type="password" onblur="if (this.value=='') {this.value='nom4';};" onfocus="if (this.value=='nom4') {this.value='';};" value="nom4" name="compasswd" maxlength="10" size="4" style="font-size: 9pt;"/>
<input type="hidden" name="autopasswd" value="nom4"/>
<input type="radio" value=";)" name="comicon"/><img width="15" height="15" title=";)" src="/htdocs/woodpecker/img/smile4.png" alt=";)"/>
<input type="radio" value="=D" name="comicon"/>
<input type="radio" value="=)" name="comicon"/>
<input type="radio" value=":P" name="comicon"/>
<input type="radio" value=":(|)" name="comicon"/>
<input type="radio" value=":-|" name="comicon"/>
<input type="radio" value=":(" name="comicon"/><img width="15" height="15" title=":(" src="/htdocs/woodpecker/img/sad.png" alt=":("/>
<input type="radio" value="X-(" name="comicon"/><img width="15" height="15" title="X-(" src="/htdocs/woodpecker/img/angry.png" alt="X-("/>
<input type="radio" value="B-)" name="comicon"/><img width="15" height="15" title="B-)" src="/htdocs/woodpecker/img/smile2.png" alt="B-)"/>

</td>
<td style="border-width: 0px; vertical-align: middle; text-align: right; font-size: 9pt;"/>
</tr>
</tbody></table>
<input type="hidden" value="show" name="action"/>
<input type="hidden" value="0" name="comrev"/>
<input type="hidden" value="addcomment1" name="commentaction"/>
</form>
</td></tr>
<tr><td style="border-width: 0px; height: 20px;" class="commentblankline" colspan="5"/></tr>
<script language="javascript">
<!--
function requesttodeleteadmin1(delform, comkey) {
if (confirm("Really delete this comment?")) {;
delform.delkey.value = comkey;
delform.delpasswd.value = "****";
delform.submit();
}
}
function requesttodelete1(delform, comkey) {
var passwd = prompt("请输入一个密码!:", "");
if(!(passwd == "" || passwd == null)) {
delform.delkey.value = comkey;
delform.delpasswd.value = passwd;
delform.submit();
}
}
//-->
</script>
<form method="post" action="TheTetrisGame#pagecomment1" name="delform1"/>
<input type="hidden" name="action" value="show"/>
<input type="hidden" value="****" name="delpasswd"/>
<input type="hidden" value="" name="delkey"/>
<input type="hidden" value="delcomment1" name="commentaction"/>


</tbody></table>
</div> <span id="line-484" class="anchor"/><span id="line-485" class="anchor"/><p class="line862">::-- <a href="/moin/zhuyj">zhuyj</a> [2008-12-22 08:32:52] </p><div class="table-of-contents"><p class="table-of-contents-heading">目录</p><ol><li><a href="#head-7f69455b61b48a37519b8515f922c729023762a4">The Tetris game in PyQt4</a><ol><li><a
href="#head-9781a97e2bba46e25e6cf3579843823ae78604c3">Tetris</a></li></ol></li><li><a href="#head-3c1c5519b68c10f73e762529e30ab6f7aba16e26">交流</a></li></ol></div> <span id="line-486" class="anchor"/><span id="bottom_Include_TheTetrisGame" class="anchor"/></div><div id="subpageQuickIn">{<a href="/moin/TheTetrisGame">TheTetrisGame</a><a
href="/moin/TheTetrisGame?action=edit">}<sup>e</sup></a></div><div id="subpageLineSpace"/> <span id="line-4" class="anchor"/><span id="bottom" class="anchor"/></div>
