<p>来自： <a href="http://wiki.woodpecker.org.cn/moin/PyCurl">http://wiki.woodpecker.org.cn/moin/PyCurl</a></p>
<div lang="en" id="content" dir="ltr"><span id="top" class="anchor"/>
<span id="line-3" class="anchor"/><p class="line867"><strong> <span id="line-4" class="anchor"/>cURL lib py 实现 <span id="line-5" class="anchor"/></strong> <span id="line-6" class="anchor"/>::-- <a href="/moin/ZoomQuiet">ZoomQuiet</a> [2008-03-04 05:21:36] <span id="line-7" class="anchor"/></p><div class="table-of-contents"><p class="table-of-contents-heading">目录</p><ol><li><a href="#head-1eaba5df7acfe6054d2de39cc402107b458971d2">PycURL</a><ol><li><a href="#head-1dcabd958d9b3e99603fc4977b329d3657eab80f">反馈</a></li></ol></li></ol></div> <span id="line-8" class="anchor"/><span id="line-9" class="anchor"/><p class="line867"/><div lang="en" id="Include_CPUGnav" dir="ltr"><span id="top_Include_CPUGnav" class="anchor"/>
<span id="line-1" class="anchor"/><div><table><tbody><tr>  <td><p class="line891"><strong>CPUG</strong>联盟::</p></td>
<td><p class="line891"><strong><a title="self" href="http://wiki.woodpecker.org.cn/moin/CPUG" class="interwiki">CPUG</a></strong>::<a href="http://python.cn" class="http">门户</a><sup>plone</sup></p></td>
<td><p class="line891"><strong><a title="self" href="http://wiki.woodpecker.org.cn/moin/BPUG" class="interwiki">BPUG</a></strong></p></td>
<td><p class="line891"><strong><a title="self" href="http://wiki.woodpecker.org.cn/moin/SPUG" class="interwiki">SPUG</a></strong></p></td>
<td><p class="line891"><strong><a title="self" href="http://wiki.woodpecker.org.cn/moin/ZPUG" class="interwiki">ZPUG</a></strong></p></td>
<td><p class="line862">  <a href="/moin/SpreadPython">SpreadPython</a> <sup>Python宣传</sup><em> </em></p></td>
</tr>
</tbody></table></div><span id="line-2" class="anchor"/><span id="bottom_Include_CPUGnav" class="anchor"/></div><div id="subpageQuickIn">{<a href="/moin/CPUGnav">CPUGnav</a><a href="/moin/CPUGnav?action=edit">}<sup>e</sup></a></div><div id="subpageLineSpace"/> <span id="line-10" class="anchor"/><span id="line-11" class="anchor"/><span id="line-12" class="anchor"/><p class="line867">
</p><h1 id="head-1eaba5df7acfe6054d2de39cc402107b458971d2">1. PycURL</h1>
<span id="line-13" class="anchor"/><span id="line-14" class="anchor"/><p class="line874">pycurl — A Python interface to the cURL library <span id="line-15" class="anchor"/><span id="line-16" class="anchor"/></p><p class="line874">Pycurl包是一个libcurl的Python接口.pycurl已经成功的在Python2.2到Python2.5版编译测试过了. <span id="line-17" class="anchor"/><span id="line-18" class="anchor"/></p><p class="line874">Libcurl 是一个支持FTP, FTPS, HTTP, HTTPS, GOPHER, TELNET, DICT, FILE 和 LDAP的客户端URL传输库.libcurl也支持HTTPS认证,HTTP POST,HTTP PUT,FTP上传,代理,Cookies,基本身份验证,FTP文件断点继传,HTTP代理通道等等. <span id="line-19" class="anchor"/><span id="line-20" class="anchor"/></p><p class="line862">Libcurl提供的所有功能都可以通过pycurl接口来使用.接下来的子章节概述怎么使用pycurl接口,并且假定已经知道了libcurl如何工作的.libcurl如何工作的更多信息,请参考curl库的web页面(<a href="http://curl.haxx.se/libcurl/c/" class="http">http://curl.haxx.se/libcurl/c/</a>). <span id="line-21" class="anchor"/>Module Functionality <span id="line-22" class="anchor"/><span id="line-23" class="anchor"/></p><p class="line862">pycurl.global_init(option) ->None <span id="line-24" class="anchor"/>选项是以下常量之一:pycurl.GLOBAL_SSL, pycurl.GLOBAL_WIN32, pycurl.GLOBAL_ALL, pycurl.GLOBAL_NOTHING, pycurl.GLOBAL_DEFAULT. 相应的是libcurl的 curl_global_init() 方法. <span id="line-25" class="anchor"/><span id="line-26" class="anchor"/></p><p class="line862">pycurl.global_cleanup() -> None <span id="line-27" class="anchor"/>相应的是libcurl的curl_global_cleanup()方法. <span id="line-28" class="anchor"/><span id="line-29" class="anchor"/></p><p class="line874">pycurl.version <span id="line-30" class="anchor"/>这是liburl当前版本的信息,相应的是liburl的curl_version()方法. <span id="line-31" class="anchor"/>用法举例: <span id="line-32" class="anchor"/><span id="line-33" class="anchor"/><span id="line-34" class="anchor"/><span id="line-35" class="anchor"/><span id="line-36" class="anchor"/><span id="line-37" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
function isnumbered(obj) {
return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
var nlen = Math.max(0,chrs-(''+num).length), res = '';
while (nlen>0) { res += ' '; nlen-- }
return res+num+add;
}
function addnumber(did, nstart, nstep) {
var c = document.getElementById(did), l = c.firstChild, n = 1;
if (!isnumbered(c))
if (typeof nstart == 'undefined') nstart = 1;
if (typeof nstep  == 'undefined') nstep = 1;
n = nstart;
while (l != null) {
if (l.tagName == 'SPAN') {
var s = document.createElement('SPAN');
s.className = 'LineNumber'
s.appendChild(document.createTextNode(nformat(n,4,' ')));
n += nstep;
if (l.childNodes.length)
l.insertBefore(s, l.firstChild)
else
l.appendChild(s)
}
l = l.nextSibling;
}
return false;
}
function remnumber(did) {
var c = document.getElementById(did), l = c.firstChild;
if (isnumbered(c))
while (l != null) {
if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
l = l.nextSibling;
}
return false;
}
function togglenumber(did, nstart, nstep) {
var c = document.getElementById(did);
if (isnumbered(c)) {
remnumber(did);
} else {
addnumber(did,nstart,nstep);
}
return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-fd1e894c14838194855e3c469a900e2cec10699a_000\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-fd1e894c14838194855e3c469a900e2cec10699a_000', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-fd1e894c14838194855e3c469a900e2cec10699a_000" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="Operator">>></span><span class="Operator">></span> <span class="ResWord">import</span> <span class="ID">pycurl</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="Operator">>></span><span class="Operator">></span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">version</span></span>
<span class="line"><span class="LineNumber">   3 </span><span class="String">'libcurl/7.12.3 OpenSSL/0.9.7e zlib/1.2.2.1 libidn/0.5.12'</span><span class="Text"/></span>
</pre></div><span id="line-38" class="anchor"/><span id="line-39" class="anchor"/><p class="line862">pycurl.version_info() -> Tuple <span id="line-40" class="anchor"/><span id="line-41" class="anchor"/></p><p class="line874">相对应的是libcurl中的 curl_version_info() 方法. 返回一个序列信息就像liburl的curl_version_info()方法返回的 curl_version_info_data 结构化数据. <span id="line-42" class="anchor"/><span id="line-43" class="anchor"/></p><p class="line874">用法举例: <span id="line-44" class="anchor"/><span id="line-45" class="anchor"/><span id="line-46" class="anchor"/><span id="line-47" class="anchor"/><span id="line-48" class="anchor"/><span id="line-49" class="anchor"/><span id="line-50" class="anchor"/><span id="line-51" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-676337c3188984f95db700b539096091d05aace2_001\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-676337c3188984f95db700b539096091d05aace2_001', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-676337c3188984f95db700b539096091d05aace2_001" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="Operator">>></span><span class="Operator">></span> <span class="ResWord">import</span> <span class="ID">pycurl</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="Operator">>></span><span class="Operator">></span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">version_info</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   3 </span><span class="Operator">(</span><span class="Number">2</span><span class="Operator">,</span> <span class="String">'7.12.3'</span><span class="Operator">,</span> <span class="Number">461827</span><span class="Operator">,</span> <span class="String">'i586-pc-linux-gnu'</span><span class="Operator">,</span> <span class="Number">1565</span><span class="Operator">,</span> <span class="String">'OpenSSL/0.9.7e'</span><span class="Operator">,</span> <span class="Number">9465951</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   4 </span><span class="String">'1.2.2.1'</span><span class="Operator">,</span> <span class="Operator">(</span><span class="String">'ftp'</span><span class="Operator">,</span> <span class="String">'gopher'</span><span class="Operator">,</span> <span class="String">'telnet'</span><span class="Operator">,</span> <span class="String">'dict'</span><span class="Operator">,</span> <span class="String">'ldap'</span><span class="Operator">,</span> <span class="String">'http'</span><span class="Operator">,</span> <span class="String">'file'</span><span class="Operator">,</span></span>
<span class="line"><span class="LineNumber">   5 </span><span class="String">'https'</span><span class="Operator">,</span> <span class="String">'ftps'</span><span class="Operator">)</span><span class="Operator">,</span> <span class="ID">None</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">,</span> <span class="String">'0.5.12'</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-52" class="anchor"/><span id="line-53" class="anchor"/><p class="line862">pycurl.Curl() -> Curl object <span id="line-54" class="anchor"/><span id="line-55" class="anchor"/></p><p class="line874">这个函数创建一个同libcurl中的CURL处理器相对应的Curl对象.Curl对象自动的设置CURLOPT_VERBOSE为0, CURLOPT_NOPROGRESS为1,提供一个默认的CURLOPT_USERAGENT和设置CURLOPT_ERRORBUFFER指向一个私有的错误缓冲区. <span id="line-56" class="anchor"/><span id="line-57" class="anchor"/></p><p class="line862">pycurl.<a href="/moin/CurlMulti" class="nonexistent">CurlMulti</a>() -> <a href="/moin/CurlMulti" class="nonexistent">CurlMulti</a> object <span id="line-58" class="anchor"/><span id="line-59" class="anchor"/></p><p class="line862">这个函数创建一个新的与libcurl中的CURLM处理器相对应的<a href="/moin/CurlMulti" class="nonexistent">CurlMulti</a>对象. <span id="line-60" class="anchor"/><span id="line-61" class="anchor"/></p><p class="line862">pycurl.<a href="/moin/CurlShare" class="nonexistent">CurlShare</a>() -> <a href="/moin/CurlShare" class="nonexistent">CurlShare</a> object <span id="line-62" class="anchor"/><span id="line-63" class="anchor"/></p><p class="line862">这个函数创建一个新的与libcurl中的CURLSH处理器相对应的<a href="/moin/CurlShare" class="nonexistent">CurlShare</a>对象.<a href="/moin/CurlShare" class="nonexistent">CurlShare</a>对象可以在Curl对象上传递SHARE选项参数. [待续] <span id="line-64" class="anchor"/><span id="line-65" class="anchor"/><span id="line-66" class="anchor"/><span id="line-67" class="anchor"/><span id="line-68" class="anchor"/></p><ul><li style="list-style-type: none;"><p class="line862">PS：本文翻译自PycURL的官方网站：<a href="http://pycurl.sourceforge.net/doc/pycurl.html，如有转贴请注明ChumpKlutz原创翻译" class="http">http://pycurl.sourceforge.net/doc/pycurl.html，如有转贴请注明ChumpKlutz原创翻译</a> <span id="line-69" class="anchor"/><span id="line-70" class="anchor"/><span id="line-71" class="anchor"/></p></li></ul><p class="line862">Trackback: <a href="http://tb.blog.csdn.net/TrackBack.aspx?PostId=2146079" class="http">http://tb.blog.csdn.net/TrackBack.aspx?PostId=2146079</a> <span id="line-72" class="anchor"/><span id="line-73" class="anchor"/></p><p class="line874">Subsections <span id="line-74" class="anchor"/># Curl objects <span id="line-75" class="anchor"/># <a href="/moin/CurlMulti" class="nonexistent">CurlMulti</a> objects <span id="line-76" class="anchor"/># <a href="/moin/CurlShare" class="nonexistent">CurlShare</a> objects <span id="line-77" class="anchor"/># Callbacks <span id="line-78" class="anchor"/>Curl Object  <span id="line-79" class="anchor"/><span id="line-80" class="anchor"/></p><p class="line874">Curl对象具有以下方法: <span id="line-81" class="anchor"/><span id="line-82" class="anchor"/></p><p class="line867"><strong>close() -> None</strong> <span id="line-83" class="anchor"/>对应的是libcurl中的curl_easy_cleanup方法.当Curl对象不再被引用时pycurl会自动调用这个方法,但也可直接地调用这个方法. <span id="line-84" class="anchor"/><span id="line-85" class="anchor"/></p><p class="line867"><strong>perform() -> None</strong> <span id="line-86" class="anchor"/>对应于libcurl中的curl_easy_perform方法. <span id="line-87" class="anchor"/><span id="line-88" class="anchor"/></p><p class="line867"><strong>setopt(option, value) -> None</strong> <span id="line-89" class="anchor"/>对应于libcurl中的curl_easy_setopt方法, option使用libcurl中的CURLOPT_*常量来指定,只可惜CURLOPT_前缀现在已经被去掉了.value的数据类型依赖于 option,它可以是一个字符串,整型,长整型,文件对象,列表或是函数. <span id="line-90" class="anchor"/><span id="line-91" class="anchor"/></p><p class="line874">用法举例: <span id="line-92" class="anchor"/><span id="line-93" class="anchor"/><span id="line-94" class="anchor"/><span id="line-95" class="anchor"/><span id="line-96" class="anchor"/><span id="line-97" class="anchor"/><span id="line-98" class="anchor"/><span id="line-99" class="anchor"/><span id="line-100" class="anchor"/><span id="line-101" class="anchor"/><span id="line-102" class="anchor"/><span id="line-103" class="anchor"/><span id="line-104" class="anchor"/><span id="line-105" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-cdf26823d5089aa649daf39dcc32aabfbc868687_002\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-cdf26823d5089aa649daf39dcc32aabfbc868687_002', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-cdf26823d5089aa649daf39dcc32aabfbc868687_002" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">import</span> <span class="ID">pycurl</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="ID">c</span> <span class="Operator">=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">Curl</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   3 </span><span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">URL</span><span class="Operator">,</span> <span class="String">"http://www.python.org/"</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span><span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">HTTPHEADER</span><span class="Operator">,</span> <span class="Operator">[</span><span class="String">"Accept:"</span><span class="Operator">]</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   5 </span><span class="ResWord">import</span> <span class="ID">StringIO</span></span>
<span class="line"><span class="LineNumber">   6 </span><span class="ID">b</span> <span class="Operator">=</span> <span class="ID">StringIO</span><span class="Operator">.</span><span class="ID">StringIO</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   7 </span><span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">WRITEFUNCTION</span><span class="Operator">,</span> <span class="ID">b</span><span class="Operator">.</span><span class="ID">write</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span><span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">FOLLOWLOCATION</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   9 </span><span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">MAXREDIRS</span><span class="Operator">,</span> <span class="Number">5</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  10 </span><span class="ID">c</span><span class="Operator">.</span><span class="ID">perform</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span><span class="ResWord">print</span> <span class="ID">b</span><span class="Operator">.</span><span class="ID">getvalue</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-106" class="anchor"/><span id="line-107" class="anchor"/><p class="line867"><strong>getinfo(option) -> Result</strong> <span id="line-108" class="anchor"/>对应于libcurl中的curl_easy_getinfo方法, option同样使用libcurl中的CURLOPT_*常量来指定,只可惜CURLOPT_前缀现在已经被去掉了. Result包含一个整数,浮点数或字符串,这都信赖于给定的option.getinfo方法不能在perform方法未调用或完成之前进行调用. <span id="line-109" class="anchor"/><span id="line-110" class="anchor"/></p><p class="line874">用法举例: <span id="line-111" class="anchor"/><span id="line-112" class="anchor"/></p><p class="line867"><strong>errstr() -> String</strong> <span id="line-113" class="anchor"/>返回这个处理器中内部libcurl错误缓冲区的字符串表示. <span id="line-114" class="anchor"/><a href="/moin/CurlMulti" class="nonexistent">CurlMulti</a> Object <span id="line-115" class="anchor"/><span id="line-116" class="anchor"/><span id="line-117" class="anchor"/></p><p class="line867"><a href="/moin/CurlMulti" class="nonexistent">CurlMulti</a>对象具有以下方法: <span id="line-118" class="anchor"/><span id="line-119" class="anchor"/></p><p class="line862">close() -> None <span id="line-120" class="anchor"/>对应于libcurl中的curl_multi_cleanup()方法.当<a href="/moin/CurlMulti" class="nonexistent">CurlMulti</a>对象不再被引用时pycurl会自动调用该方法,也可显示调用该方法. <span id="line-121" class="anchor"/><span id="line-122" class="anchor"/></p><p class="line862">perform() -> tuple of status and the number of active Curl objects <span id="line-123" class="anchor"/>对应于libcurl中的curl_multi_perform()方法. <span id="line-124" class="anchor"/><span id="line-125" class="anchor"/></p><p class="line862">add_handle(Curl object) -> None <span id="line-126" class="anchor"/>对应于libcurl中的curl_multi_add_handle()方法.这个方法添加一个有效的Curl对象到<a href="/moin/CurlMulti" class="nonexistent">CurlMulti</a>对象. <span id="line-127" class="anchor"/>重要提示:add_handle没有隐式的增加对Curl对象的引用(因而也没有增加Curl对象的引用次数) <span id="line-128" class="anchor"/><span id="line-129" class="anchor"/></p><p class="line862">remove_handle(Curl object) -> None <span id="line-130" class="anchor"/>对应于libcurl中的curl_multi_remove_handle()方法.这个方法从<a href="/moin/CurlMulti" class="nonexistent">CurlMulti</a>对象中移除一个现有的Curl对象. <span id="line-131" class="anchor"/>重要提示:remove_handle不会隐式的移除Curl对象的引用(因而不会减少Curl对象的引用次数). <span id="line-132" class="anchor"/><span id="line-133" class="anchor"/></p><p class="line862">fdset() -> triple of lists with active file descriptors, readable, writeable, exceptions. <span id="line-134" class="anchor"/>对应于libcurl中的curl_multi_fdset()方法.这个方法从<a href="/moin/CurlMulti" class="nonexistent">CurlMulti</a>对象中提取文件描述信息.返回的列表可以被用于select模块to poll for events. <span id="line-135" class="anchor"/><span id="line-136" class="anchor"/></p><p class="line874">用法举例: <span id="line-137" class="anchor"/><span id="line-138" class="anchor"/><span id="line-139" class="anchor"/><span id="line-140" class="anchor"/><span id="line-141" class="anchor"/><span id="line-142" class="anchor"/><span id="line-143" class="anchor"/><span id="line-144" class="anchor"/><span id="line-145" class="anchor"/><span id="line-146" class="anchor"/><span id="line-147" class="anchor"/><span id="line-148" class="anchor"/><span id="line-149" class="anchor"/><span id="line-150" class="anchor"/><span id="line-151" class="anchor"/><span id="line-152" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-1b384a2948e27cdcc57e64100ba620fdb2fc3933_003\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-1b384a2948e27cdcc57e64100ba620fdb2fc3933_003', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-1b384a2948e27cdcc57e64100ba620fdb2fc3933_003" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">import</span> <span class="ID">pycurl</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="ID">c</span> <span class="Operator">=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">Curl</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   3 </span><span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">URL</span><span class="Operator">,</span> <span class="String">"http://curl.haxx.se"</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span><span class="ID">m</span> <span class="Operator">=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">CurlMulti</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   5 </span><span class="ID">m</span><span class="Operator">.</span><span class="ID">add_handle</span><span class="Operator">(</span><span class="ID">c</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   6 </span><span class="ResWord">while</span> <span class="Number">1</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   7 </span>    <span class="ID">ret</span><span class="Operator">,</span> <span class="ID">num_handles</span> <span class="Operator">=</span> <span class="ID">m</span><span class="Operator">.</span><span class="ID">perform</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span>    <span class="ResWord">if</span> <span class="ID">ret</span> <span class="Operator">!=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">E_CALL_MULTI_PERFORM</span><span class="Operator">:</span> <span class="ResWord">break</span></span>
<span class="line"><span class="LineNumber">   9 </span><span class="ResWord">while</span> <span class="ID">num_handles</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  10 </span>    <span class="ID">apply</span><span class="Operator">(</span><span class="ID">select</span><span class="Operator">.</span><span class="ID">select</span><span class="Operator">,</span> <span class="ID">m</span><span class="Operator">.</span><span class="ID">fdset</span><span class="Operator">(</span><span class="Operator">)</span> <span class="Operator">+</span> <span class="Operator">(</span><span class="Number">1</span><span class="Operator">,</span><span class="Operator">)</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span>    <span class="ResWord">while</span> <span class="Number">1</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  12 </span>        <span class="ID">ret</span><span class="Operator">,</span> <span class="ID">num_handles</span> <span class="Operator">=</span> <span class="ID">m</span><span class="Operator">.</span><span class="ID">perform</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  13 </span>        <span class="ResWord">if</span> <span class="ID">ret</span> <span class="Operator">!=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">E_CALL_MULTI_PERFORM</span><span class="Operator">:</span> <span class="ResWord">break</span><span class="Text"/></span>
</pre></div><span id="line-153" class="anchor"/><span id="line-154" class="anchor"/><p class="line867"><strong>select(timeout) -> number of ready file descriptors or -1 on timeout</strong> <span id="line-155" class="anchor"/>这是一个有用的函数,它简化了fdest()和select模块的组合使用. <span id="line-156" class="anchor"/><span id="line-157" class="anchor"/></p><p class="line874">用法举例: <span id="line-158" class="anchor"/><span id="line-159" class="anchor"/><span id="line-160" class="anchor"/><span id="line-161" class="anchor"/><span id="line-162" class="anchor"/><span id="line-163" class="anchor"/><span id="line-164" class="anchor"/><span id="line-165" class="anchor"/><span id="line-166" class="anchor"/><span id="line-167" class="anchor"/><span id="line-168" class="anchor"/><span id="line-169" class="anchor"/><span id="line-170" class="anchor"/><span id="line-171" class="anchor"/><span id="line-172" class="anchor"/><span id="line-173" class="anchor"/><span id="line-174" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-cb3eb01888a9496a1a9bcb7012eb5e28ac10ef57_004\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-cb3eb01888a9496a1a9bcb7012eb5e28ac10ef57_004', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-cb3eb01888a9496a1a9bcb7012eb5e28ac10ef57_004" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">import</span> <span class="ID">pycurl</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="ID">c</span> <span class="Operator">=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">Curl</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   3 </span><span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">URL</span><span class="Operator">,</span> <span class="String">"http://curl.haxx.se"</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span><span class="ID">m</span> <span class="Operator">=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">CurlMulti</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   5 </span><span class="ID">m</span><span class="Operator">.</span><span class="ID">add_handle</span><span class="Operator">(</span><span class="ID">c</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   6 </span><span class="ResWord">while</span> <span class="Number">1</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   7 </span>    <span class="ID">ret</span><span class="Operator">,</span> <span class="ID">num_handles</span> <span class="Operator">=</span> <span class="ID">m</span><span class="Operator">.</span><span class="ID">perform</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span>    <span class="ResWord">if</span> <span class="ID">ret</span> <span class="Operator">!=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">E_CALL_MULTI_PERFORM</span><span class="Operator">:</span> <span class="ResWord">break</span></span>
<span class="line"><span class="LineNumber">   9 </span><span class="ResWord">while</span> <span class="ID">num_handles</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  10 </span>    <span class="ID">ret</span> <span class="Operator">=</span> <span class="ID">m</span><span class="Operator">.</span><span class="ID">select</span><span class="Operator">(</span><span class="Number">1.0</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span>    <span class="ResWord">if</span> <span class="ID">ret</span> <span class="Operator">==</span> <span class="Operator">-</span><span class="Number">1</span><span class="Operator">:</span>  <span class="ResWord">continue</span></span>
<span class="line"><span class="LineNumber">  12 </span>    <span class="ResWord">while</span> <span class="Number">1</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  13 </span>        <span class="ID">ret</span><span class="Operator">,</span> <span class="ID">num_handles</span> <span class="Operator">=</span> <span class="ID">m</span><span class="Operator">.</span><span class="ID">perform</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  14 </span>        <span class="ResWord">if</span> <span class="ID">ret</span> <span class="Operator">!=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">E_CALL_MULTI_PERFORM</span><span class="Operator">:</span> <span class="ResWord">break</span><span class="Text"/></span>
</pre></div><span id="line-175" class="anchor"/><span id="line-176" class="anchor"/><p class="line862">info_read([max]) -> numberof queued messages, a list of successful objects, a list of failed objects <span id="line-177" class="anchor"/>对应于libcurl中的curl_multi_info_read()方法.这个方法从多重栈中提取至多max个信息然后返回两个列表.第一个列表包含成功完成的操作第二个列表包含每一个失败的curl对象的<curl对象,curl错误代码,curl错误信息>序列. [待续] <span id="line-178" class="anchor"/><span id="line-179" class="anchor"/><span id="line-180" class="anchor"/><span id="line-181" class="anchor"/><span id="line-182" class="anchor"/><span id="line-183" class="anchor"/></p><p class="line862">PS：本文翻译自PycURL的官方网站：<a href="http://pycurl.sourceforge.net/doc/pycurl.html，如有转贴请注明ChumpKlutz原创翻译" class="http">http://pycurl.sourceforge.net/doc/pycurl.html，如有转贴请注明ChumpKlutz原创翻译</a> <span id="line-184" class="anchor"/><span id="line-185" class="anchor"/><span id="line-186" class="anchor"/></p><p class="line862">Trackback: <a href="http://tb.blog.csdn.net/TrackBack.aspx?PostId=2146140" class="http">http://tb.blog.csdn.net/TrackBack.aspx?PostId=2146140</a> <span id="line-187" class="anchor"/><span id="line-188" class="anchor"/><span id="line-189" class="anchor"/></p><p class="line867"><a href="/moin/CurlShare" class="nonexistent">CurlShare</a> Object <span id="line-190" class="anchor"/><span id="line-191" class="anchor"/></p><p class="line867"><a href="/moin/CurlShare" class="nonexistent">CurlShare</a>对象具有以下方法: <span id="line-192" class="anchor"/><span id="line-193" class="anchor"/></p><p class="line862">setopt(option, value) -> None <span id="line-194" class="anchor"/>对应于libcurl中的curl_share_setopt方法, option使用libcurl中的CURLOPT_*常量来指定,只可惜CURLOPT_前缀现在改成SH_了.通常value必须是 LOCK_DATA_COOKIE 或者说LOCK_DATA_DNS. <span id="line-195" class="anchor"/><span id="line-196" class="anchor"/></p><p class="line874">用法举例: <span id="line-197" class="anchor"/><span id="line-198" class="anchor"/><span id="line-199" class="anchor"/><span id="line-200" class="anchor"/><span id="line-201" class="anchor"/><span id="line-202" class="anchor"/><span id="line-203" class="anchor"/><span id="line-204" class="anchor"/><span id="line-205" class="anchor"/><span id="line-206" class="anchor"/><span id="line-207" class="anchor"/><span id="line-208" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-6a0c8df4903ed47d6c217d3e418aa972fb6a096e_005\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-6a0c8df4903ed47d6c217d3e418aa972fb6a096e_005', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-6a0c8df4903ed47d6c217d3e418aa972fb6a096e_005" dir="ltr"><span class="line"><span class="LineNumber">   1 </span><span class="ResWord">import</span> <span class="ID">pycurl</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="ID">curl</span> <span class="Operator">=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">Curl</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   3 </span><span class="ID">s</span> <span class="Operator">=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">CurlShare</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   4 </span><span class="ID">s</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">SH_SHARE</span><span class="Operator">,</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">LOCK_DATA_COOKIE</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   5 </span><span class="ID">s</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">SH_SHARE</span><span class="Operator">,</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">LOCK_DATA_DNS</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   6 </span><span class="ID">curl</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">URL</span><span class="Operator">,</span> <span class="String">'http://curl.haxx.se'</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   7 </span><span class="ID">curl</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">SHARE</span><span class="Operator">,</span> <span class="ID">s</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span><span class="ID">curl</span><span class="Operator">.</span><span class="ID">perform</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   9 </span><span class="ID">curl</span><span class="Operator">.</span><span class="ID">close</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-209" class="anchor"/><span id="line-210" class="anchor"/><p class="line874">Callbacks <span id="line-211" class="anchor"/><span id="line-212" class="anchor"/></p><p class="line874">为了更好的控制,libcurl允许把一些回调函数关联到每个连接中.在pycurl中,回调函数通过Curl对象调用setopt为s WRITEFUNCTION, READFUNCTION, HEADERFUNCTION, PROGRESSFUNCTION, IOCTLFUNCTION, 或DEBUGFUNCTION这些选项设置.这些选项对应着libcurl中CURLOPT_*前缀被移除的选项.在pycurl中回调函数必须是一个正规的Python函数,或者一个类的方法或是一个扩展的函数类型. <span id="line-213" class="anchor"/><span id="line-214" class="anchor"/></p><p class="line874">这儿有些局限性就是这些选项的回调函数有可能同时发生.它允许不同的回调函数对应到不同的Curl对象.更多明确的是,WRITEDATA的回调函数不能用于WRITEFUNCTION,READDATA的回调函数不能用于 READFUNCTION,WRITEHEADER的回调函数不能用于HEADERFUNCTION,PROGRESSDATA回调函数不能用于 PROGRESSFUNCTION,IOCTLDATA回调函数不能用于IOCTLFUNCTION,DEBUGDATA回调函数不能用于 DEBUGFUNCTION.实际上,可以通过把一个类的实例方法来当作回调函数并且使用类实例属性像文件对象那样存储每个对象的数据来克服这种局限性. <span id="line-215" class="anchor"/><span id="line-216" class="anchor"/></p><p class="line874">Pycurl中的每个回调函数的签名如下: <span id="line-217" class="anchor"/><span id="line-218" class="anchor"/></p><p class="line867"><span id="line-219" class="anchor"/></p><pre>WRITEFUNCTION(string) -> number of characters written
<span id="line-220" class="anchor"/>
<span id="line-221" class="anchor"/>READFUNCTION(number of characters to read)-> string
<span id="line-222" class="anchor"/>
<span id="line-223" class="anchor"/>HEADERFUNCTION(string) -> number of characters written
<span id="line-224" class="anchor"/>
<span id="line-225" class="anchor"/>PROGRESSFUNCTION(download total, downloaded, upload total, uploaded) -> status
<span id="line-226" class="anchor"/>
<span id="line-227" class="anchor"/>DEBUGFUNCTION(debug message type, debug message string) -> None
<span id="line-228" class="anchor"/></pre><span id="line-229" class="anchor"/><span id="line-230" class="anchor"/><p class="line862">IOCTLFUNCTION(ioctl cmd) -> status <span id="line-231" class="anchor"/>Example: Callbacks for document header and body <span id="line-232" class="anchor"/><span id="line-233" class="anchor"/></p><p class="line874">这个例子打印头数据到stderr打印内容数据到stdout.同样注意它们都不返回写入的字节数. WRITEFUNCTION和HEADERFUNCTION回调,写入所有字节时返回None. <span id="line-234" class="anchor"/><span id="line-235" class="anchor"/><span id="line-236" class="anchor"/><span id="line-237" class="anchor"/><span id="line-238" class="anchor"/><span id="line-239" class="anchor"/><span id="line-240" class="anchor"/><span id="line-241" class="anchor"/><span id="line-242" class="anchor"/><span id="line-243" class="anchor"/><span id="line-244" class="anchor"/><span id="line-245" class="anchor"/><span id="line-246" class="anchor"/><span id="line-247" class="anchor"/><span id="line-248" class="anchor"/><span id="line-249" class="anchor"/><span id="line-250" class="anchor"/><span id="line-251" class="anchor"/><span id="line-252" class="anchor"/><span id="line-253" class="anchor"/><span id="line-254" class="anchor"/><span id="line-255" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-86d3ae9c7c065eee0325fbc791e973148f08b80c_006\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-86d3ae9c7c065eee0325fbc791e973148f08b80c_006', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-86d3ae9c7c065eee0325fbc791e973148f08b80c_006" dir="ltr"><span class="line"><span class="LineNumber">   1 </span>    <span class="Comment">## Callback function invoked when body data is ready</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="Comment"/>    <span class="ResWord">def</span> <span class="ID">body</span><span class="Operator">(</span><span class="ID">buf</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   3 </span>        <span class="Comment"># Print body data to stdout</span></span>
<span class="line"><span class="LineNumber">   4 </span><span class="Comment"/>        <span class="ResWord">import</span> <span class="ID">sys</span></span>
<span class="line"><span class="LineNumber">   5 </span>        <span class="ID">sys</span><span class="Operator">.</span><span class="ID">stdout</span><span class="Operator">.</span><span class="ID">write</span><span class="Operator">(</span><span class="ID">buf</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   6 </span>        <span class="Comment"># Returning None implies that all bytes were written</span></span>
<span class="line"><span class="LineNumber">   7 </span><span class="Comment"/></span>
<span class="line"><span class="LineNumber">   8 </span>    <span class="Comment">## Callback function invoked when header data is ready</span></span>
<span class="line"><span class="LineNumber">   9 </span><span class="Comment"/>    <span class="ResWord">def</span> <span class="ID">header</span><span class="Operator">(</span><span class="ID">buf</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">  10 </span>        <span class="Comment"># Print header data to stderr</span></span>
<span class="line"><span class="LineNumber">  11 </span><span class="Comment"/>        <span class="ResWord">import</span> <span class="ID">sys</span></span>
<span class="line"><span class="LineNumber">  12 </span>        <span class="ID">sys</span><span class="Operator">.</span><span class="ID">stderr</span><span class="Operator">.</span><span class="ID">write</span><span class="Operator">(</span><span class="ID">buf</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  13 </span>        <span class="Comment"># Returning None implies that all bytes were written</span></span>
<span class="line"><span class="LineNumber">  14 </span><span class="Comment"/></span>
<span class="line"><span class="LineNumber">  15 </span>    <span class="ID">c</span> <span class="Operator">=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">Curl</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  16 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">URL</span><span class="Operator">,</span> <span class="String">"http://www.python.org/"</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  17 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">WRITEFUNCTION</span><span class="Operator">,</span> <span class="ID">body</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  18 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">HEADERFUNCTION</span><span class="Operator">,</span> <span class="ID">header</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  19 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">perform</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-256" class="anchor"/><span id="line-257" class="anchor"/><p class="line874">Example: Download/upload progress callback <span id="line-258" class="anchor"/><span id="line-259" class="anchor"/></p><p class="line874">这个例子演示如何使用进度回调.当下载一个文档时,uploads参数都将是0,反之亦然. <span id="line-260" class="anchor"/><span id="line-261" class="anchor"/><span id="line-262" class="anchor"/><span id="line-263" class="anchor"/><span id="line-264" class="anchor"/><span id="line-265" class="anchor"/><span id="line-266" class="anchor"/><span id="line-267" class="anchor"/><span id="line-268" class="anchor"/><span id="line-269" class="anchor"/><span id="line-270" class="anchor"/><span id="line-271" class="anchor"/><span id="line-272" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-347e8c6761f11388abdd071203df5c2b4369526a_007\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-347e8c6761f11388abdd071203df5c2b4369526a_007', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-347e8c6761f11388abdd071203df5c2b4369526a_007" dir="ltr"><span class="line"><span class="LineNumber">   1 </span>    <span class="Comment">## Callback function invoked when download/upload has progress</span></span>
<span class="line"><span class="LineNumber">   2 </span><span class="Comment"/>    <span class="ResWord">def</span> <span class="ID">progress</span><span class="Operator">(</span><span class="ID">download_t</span><span class="Operator">,</span> <span class="ID">download_d</span><span class="Operator">,</span> <span class="ID">upload_t</span><span class="Operator">,</span> <span class="ID">upload_d</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   3 </span>        <span class="ResWord">print</span> <span class="String">"Total to download"</span><span class="Operator">,</span> <span class="ID">download_t</span></span>
<span class="line"><span class="LineNumber">   4 </span>        <span class="ResWord">print</span> <span class="String">"Total downloaded"</span><span class="Operator">,</span> <span class="ID">download_d</span></span>
<span class="line"><span class="LineNumber">   5 </span>        <span class="ResWord">print</span> <span class="String">"Total to upload"</span><span class="Operator">,</span> <span class="ID">upload_t</span></span>
<span class="line"><span class="LineNumber">   6 </span>        <span class="ResWord">print</span> <span class="String">"Total uploaded"</span><span class="Operator">,</span> <span class="ID">upload_d</span></span>
<span class="line"><span class="LineNumber">   7 </span></span>
<span class="line"><span class="LineNumber">   8 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">c</span><span class="Operator">.</span><span class="ID">URL</span><span class="Operator">,</span> <span class="String">"http://slashdot.org/"</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   9 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">c</span><span class="Operator">.</span><span class="ID">NOPROGRESS</span><span class="Operator">,</span> <span class="Number">0</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  10 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">c</span><span class="Operator">.</span><span class="ID">PROGRESSFUNCTION</span><span class="Operator">,</span> <span class="ID">progress</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">  11 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">perform</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-273" class="anchor"/><span id="line-274" class="anchor"/><p class="line874">Example: Debug callbacks <span id="line-275" class="anchor"/><span id="line-276" class="anchor"/></p><p class="line874">这个例子演示如何使用调试回调.调试信息类型是一个调试信息的整数标示类型.在这个回调被调用时VERBOSE选项必须可用. <span id="line-277" class="anchor"/><span id="line-278" class="anchor"/><span id="line-279" class="anchor"/><span id="line-280" class="anchor"/><span id="line-281" class="anchor"/><span id="line-282" class="anchor"/><span id="line-283" class="anchor"/><span id="line-284" class="anchor"/><span id="line-285" class="anchor"/><span id="line-286" class="anchor"/></p><div lang="en" dir="ltr" class="codearea">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-94ac8f95b45fe60e50631190002ded439d80e26e_008\', 1, 1);" \
class="codenumbers">切换行号显示<\/a>');
</script><a class="codenumbers" onclick="return togglenumber('CA-94ac8f95b45fe60e50631190002ded439d80e26e_008', 1, 1);" href="#">切换行号显示</a>
<pre lang="en" id="CA-94ac8f95b45fe60e50631190002ded439d80e26e_008" dir="ltr"><span class="line"><span class="LineNumber">   1 </span>    <span class="ResWord">def</span> <span class="ID">test</span><span class="Operator">(</span><span class="ID">debug_type</span><span class="Operator">,</span> <span class="ID">debug_msg</span><span class="Operator">)</span><span class="Operator">:</span></span>
<span class="line"><span class="LineNumber">   2 </span>        <span class="ResWord">print</span> <span class="String">"debug(%d): %s"</span> <span class="Operator">%</span> <span class="Operator">(</span><span class="ID">debug_type</span><span class="Operator">,</span> <span class="ID">debug_msg</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   3 </span></span>
<span class="line"><span class="LineNumber">   4 </span>    <span class="ID">c</span> <span class="Operator">=</span> <span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">Curl</span><span class="Operator">(</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   5 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">URL</span><span class="Operator">,</span> <span class="String">"http://curl.haxx.se/"</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   6 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">VERBOSE</span><span class="Operator">,</span> <span class="Number">1</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   7 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">setopt</span><span class="Operator">(</span><span class="ID">pycurl</span><span class="Operator">.</span><span class="ID">DEBUGFUNCTION</span><span class="Operator">,</span> <span class="ID">test</span><span class="Operator">)</span></span>
<span class="line"><span class="LineNumber">   8 </span>    <span class="ID">c</span><span class="Operator">.</span><span class="ID">perform</span><span class="Operator">(</span><span class="Operator">)</span><span class="Text"/></span>
</pre></div><span id="line-287" class="anchor"/><span id="line-288" class="anchor"/><p class="line874">Other examples <span id="line-289" class="anchor"/><span id="line-290" class="anchor"/></p><p class="line874">Pycrul 也包含一些用于演示如何在libcurl中使用不同的回调的测试脚本和事例.例如,文件examples/file_upload.py包含如何使用 READFUNCTION的事例代码, 'tests/test_cb.py'演示WRITEFUNCTION和HEADERFUNCTION, 'tests/test_debug.py'演示DEBUGFUNCTION, 'tests/test_getinfo.py'演示PROGRESSFUNCTION. [全结束] <span id="line-291" class="anchor"/><span id="line-292" class="anchor"/><span id="line-293" class="anchor"/><span id="line-294" class="anchor"/><span id="line-295" class="anchor"/><span id="line-296" class="anchor"/></p><p class="line862">PS：本文翻译自PycURL的官方网站：<a href="http://pycurl.sourceforge.net/doc/pycurl.html，如有转贴请注明ChumpKlutz原创翻译" class="http">http://pycurl.sourceforge.net/doc/pycurl.html，如有转贴请注明ChumpKlutz原创翻译</a> <span id="line-297" class="anchor"/><span id="line-298" class="anchor"/><span id="line-299" class="anchor"/></p><p class="line862">Trackback: <a href="http://tb.blog.csdn.net/TrackBack.aspx?PostId=2146192" class="http">http://tb.blog.csdn.net/TrackBack.aspx?PostId=2146192</a> <span id="line-300" class="anchor"/><span id="line-301" class="anchor"/><span id="line-302" class="anchor"/></p><p class="line867">
</p><h2 id="head-1dcabd958d9b3e99603fc4977b329d3657eab80f">1.1. 反馈</h2>
<span id="line-303" class="anchor"/><p class="line867"><span id="line-304" class="anchor"/></p><p class="line867"> <span id="line-305" class="anchor"/><span id="bottom" class="anchor"/></p></div>
