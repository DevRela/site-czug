---
created: 2005-08-24 16:42:25
creator: panjy
description: 通过Python可以很方便的操作Word
title: 使用Python来操作Word
---
<pre class="python">
<span style="color: #C00000;">import</span> <span style="color: #000000;">win32com</span>
<span style="color: #C00000;">from</span> <span style="color: #000000;">win32com</span><span style="color: #0000C0;">.</span><span style="color: #000000;">client</span> <span style="color: #C00000;">import</span> <span style="color: #000000;">Dispatch</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">constants</span>

<span style="color: #000000;">w</span> <span style="color: #0000C0;">=</span> <span style="color: #000000;">win32com</span><span style="color: #0000C0;">.</span><span style="color: #000000;">client</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Dispatch</span><span style="color: #0000C0;">(</span><span style="color: #004080;">'Word.Application'</span><span style="color: #0000C0;">)</span>
<span style="color: #008000;"># 或者使用下面的方法，使用启动独立的进程：
</span><span style="color: #008000;"># w = win32com.client.DispatchEx('Word.Application')
</span>
<span style="color: #008000;"># 后台运行，不显示，不警告
</span><span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Visible</span> <span style="color: #0000C0;">=</span> <span style="color: #0080C0;">0</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">DisplayAlerts</span> <span style="color: #0000C0;">=</span> <span style="color: #0080C0;">0</span>

<span style="color: #008000;"># 打开新的文件
</span><span style="color: #000000;">doc</span> <span style="color: #0000C0;">=</span> <span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Documents</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Open</span><span style="color: #0000C0;">(</span> <span style="color: #000000;">FileName</span> <span style="color: #0000C0;">=</span> <span style="color: #000000;">filenamein</span> <span style="color: #0000C0;">)</span>
<span style="color: #008000;"># worddoc = w.Documents.Add() # 创建新的文档
</span>
<span style="color: #008000;"># 插入文字
</span><span style="color: #000000;">myRange</span> <span style="color: #0000C0;">=</span> <span style="color: #000000;">doc</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Range</span><span style="color: #0000C0;">(</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">,</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">)</span>
<span style="color: #000000;">myRange</span><span style="color: #0000C0;">.</span><span style="color: #000000;">InsertBefore</span><span style="color: #0000C0;">(</span><span style="color: #004080;">'Hello from Python!'</span><span style="color: #0000C0;">)</span>

<span style="color: #008000;"># 使用样式
</span><span style="color: #000000;">wordSel</span> <span style="color: #0000C0;">=</span> <span style="color: #000000;">myRange</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Select</span><span style="color: #0000C0;">(</span><span style="color: #0000C0;">)</span>
<span style="color: #000000;">wordSel</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Style</span> <span style="color: #0000C0;">=</span> <span style="color: #000000;">constants</span><span style="color: #0000C0;">.</span><span style="color: #000000;">wdStyleHeading1</span>

<span style="color: #008000;"># 正文文字替换
</span><span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Selection</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Find</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ClearFormatting</span><span style="color: #0000C0;">(</span><span style="color: #0000C0;">)</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Selection</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Find</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Replacement</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ClearFormatting</span><span style="color: #0000C0;">(</span><span style="color: #0000C0;">)</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Selection</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Find</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Execute</span><span style="color: #0000C0;">(</span><span style="color: #000000;">OldStr</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">True</span><span style="color: #0000C0;">,</span> <span style="color: #0080C0;">1</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">True</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">NewStr</span><span style="color: #0000C0;">,</span> <span style="color: #0080C0;">2</span><span style="color: #0000C0;">)</span>

<span style="color: #008000;"># 页眉文字替换
</span><span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Sections</span><span style="color: #0000C0;">[</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">]</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Headers</span><span style="color: #0000C0;">[</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">]</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Range</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Find</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ClearFormatting</span><span style="color: #0000C0;">(</span><span style="color: #0000C0;">)</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Sections</span><span style="color: #0000C0;">[</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">]</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Headers</span><span style="color: #0000C0;">[</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">]</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Range</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Find</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Replacement</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ClearFormatting</span><span style="color: #0000C0;">(</span><span style="color: #0000C0;">)</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Sections</span><span style="color: #0000C0;">[</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">]</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Headers</span><span style="color: #0000C0;">[</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">]</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Range</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Find</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Execute</span><span style="color: #0000C0;">(</span><span style="color: #000000;">OldStr</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">True</span><span style="color: #0000C0;">,</span> <span style="color: #0080C0;">1</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">False</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">NewStr</span><span style="color: #0000C0;">,</span> <span style="color: #0080C0;">2</span><span style="color: #0000C0;">)</span>

<span style="color: #008000;"># 表格操作
</span><span style="color: #000000;">doc</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Tables</span><span style="color: #0000C0;">[</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">]</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Rows</span><span style="color: #0000C0;">[</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">]</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Cells</span><span style="color: #0000C0;">[</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">]</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Range</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Text</span> <span style="color: #0000C0;">=</span><span style="color: #004080;">'123123'</span>
<span style="color: #000000;">worddoc</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Tables</span><span style="color: #0000C0;">[</span><span style="color: #0080C0;">0</span><span style="color: #0000C0;">]</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Rows</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Add</span><span style="color: #0000C0;">(</span><span style="color: #0000C0;">)</span> <span style="color: #008000;"># 增加一行</span>

<span style="color: #008000;"># 转换为html
</span><span style="color: #000000;">wc</span> <span style="color: #0000C0;">=</span> <span style="color: #000000;">win32com</span><span style="color: #0000C0;">.</span><span style="color: #000000;">client</span><span style="color: #0000C0;">.</span><span style="color: #000000;">constants</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">WebOptions</span><span style="color: #0000C0;">.</span><span style="color: #000000;">RelyOnCSS</span> <span style="color: #0000C0;">=</span> <span style="color: #0080C0;">1</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">WebOptions</span><span style="color: #0000C0;">.</span><span style="color: #000000;">OptimizeForBrowser</span> <span style="color: #0000C0;">=</span> <span style="color: #0080C0;">1</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">WebOptions</span><span style="color: #0000C0;">.</span><span style="color: #000000;">BrowserLevel</span> <span style="color: #0000C0;">=</span> <span style="color: #0080C0;">0</span> <span style="color: #008000;"># constants.wdBrowserLevelV4</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">WebOptions</span><span style="color: #0000C0;">.</span><span style="color: #000000;">OrganizeInFolder</span> <span style="color: #0000C0;">=</span> <span style="color: #0080C0;">0</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">WebOptions</span><span style="color: #0000C0;">.</span><span style="color: #000000;">UseLongFileNames</span> <span style="color: #0000C0;">=</span> <span style="color: #0080C0;">1</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">WebOptions</span><span style="color: #0000C0;">.</span><span style="color: #000000;">RelyOnVML</span> <span style="color: #0000C0;">=</span> <span style="color: #0080C0;">0</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">WebOptions</span><span style="color: #0000C0;">.</span><span style="color: #000000;">AllowPNG</span> <span style="color: #0000C0;">=</span> <span style="color: #0080C0;">1</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">ActiveDocument</span><span style="color: #0000C0;">.</span><span style="color: #000000;">SaveAs</span><span style="color: #0000C0;">(</span> <span style="color: #000000;">FileName</span> <span style="color: #0000C0;">=</span> <span style="color: #000000;">filenameout</span><span style="color: #0000C0;">,</span> <span style="color: #000000;">FileFormat</span> <span style="color: #0000C0;">=</span> <span style="color: #000000;">wc</span><span style="color: #0000C0;">.</span><span style="color: #000000;">wdFormatHTML</span> <span style="color: #0000C0;">)</span>

<span style="color: #008000;"># 打印
</span><span style="color: #000000;">doc</span><span style="color: #0000C0;">.</span><span style="color: #000000;">PrintOut</span><span style="color: #0000C0;">(</span><span style="color: #0000C0;">)</span>

<span style="color: #008000;"># 关闭
</span><span style="color: #008000;"># doc.Close()
</span><span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Documents</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Close</span><span style="color: #0000C0;">(</span><span style="color: #000000;">wc</span><span style="color: #0000C0;">.</span><span style="color: #000000;">wdDoNotSaveChanges</span><span style="color: #0000C0;">)</span>
<span style="color: #000000;">w</span><span style="color: #0000C0;">.</span><span style="color: #000000;">Quit</span><span style="color: #0000C0;">(</span><span style="color: #0000C0;">)</span>
</pre>
